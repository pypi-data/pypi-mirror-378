import{S as ae}from"./BHg-Hw-P.js";import{S as ne}from"./4mR7T_vS.js";import{u as ue,V as oe,D as ie,b as se,a as re,c as de}from"./Dl6276N_.js";import{W as ce,X as fe,aH as me,Y as ve,aI as L,Z as pe,j as v,aJ as U,r as p,a8 as ye,a0 as Ve,a1 as Se,a2 as $,aK as ge,z as t,a4 as P,an as Ce,aL as be,a6 as Ie,O as B,aM as ke,aN as he,T as we,aO as Fe,aP as xe,d as Ae,a as Pe,t as Be,U as V,A as f,v as ze,B as b,aQ as z,a9 as Re,V as j,L as E}from"./Drw0dDXY.js";import"./BO5QyVBF.js";import"./DSKYwBdE.js";import"./DepNdJqZ.js";import"./DlAUqK2U.js";import"./BN2GUHPa.js";import"./CM2z5-Yq.js";const Ne=fe({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},...Ie({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>L(e).every(y=>y!=null&&typeof y=="object")},...be({clearable:!0})},"VFileInput"),De=ce()({name:"VFileInput",inheritAttrs:!1,props:Ne(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,y){let{attrs:I,emit:k,slots:n}=y;const{t:r}=me(),u=ve(e,"modelValue",e.modelValue,l=>L(l),l=>e.multiple||Array.isArray(e.modelValue)?l:l[0]??null),{isFocused:i,focus:F,blur:x}=pe(e),h=v(()=>typeof e.showSize!="boolean"?e.showSize:void 0),m=v(()=>(u.value??[]).reduce((l,o)=>{let{size:S=0}=o;return l+S},0)),a=v(()=>U(m.value,h.value)),s=v(()=>(u.value??[]).map(l=>{const{name:o="",size:S=0}=l;return e.showSize?`${o} (${U(S,h.value)})`:o})),q=v(()=>{var o;const l=((o=u.value)==null?void 0:o.length)??0;return e.showSize?r(e.counterSizeString,l,a.value):r(e.counterString,l)}),R=p(),N=p(),d=p(),J=v(()=>i.value||e.active),D=v(()=>["plain","underlined"].includes(e.variant));function A(){var l;d.value!==document.activeElement&&((l=d.value)==null||l.focus()),i.value||F()}function H(l){var o;(o=d.value)==null||o.click()}function K(l){k("mousedown:control",l)}function Q(l){var o;(o=d.value)==null||o.click(),k("click:control",l)}function W(l){l.stopPropagation(),A(),Fe(()=>{u.value=[],xe(e["onClick:clear"],l)})}return ye(u,l=>{(!Array.isArray(l)||!l.length)&&d.value&&(d.value.value="")}),Ve(()=>{const l=!!(n.counter||e.counter),o=!!(l||n.details),[S,X]=Se(I),{modelValue:Me,...Y}=$.filterProps(e),Z=ge(e);return t($,P({ref:R,modelValue:u.value,"onUpdate:modelValue":g=>u.value=g,class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":D.value},e.class],style:e.style,"onClick:prepend":H},S,Y,{centerAffix:!D.value,focused:i.value}),{...n,default:g=>{let{id:w,isDisabled:C,isDirty:M,isReadonly:O,isValid:_}=g;return t(he,P({ref:N,"prepend-icon":e.prependIcon,onMousedown:K,onClick:Q,"onClick:clear":W,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},Z,{id:w.value,active:J.value||M.value,dirty:M.value||e.dirty,disabled:C.value,focused:i.value,error:_.value===!1}),{...n,default:G=>{var T;let{props:{class:ee,...le}}=G;return t(B,null,[t("input",P({ref:d,type:"file",readonly:O.value,disabled:C.value,multiple:e.multiple,name:e.name,onClick:c=>{c.stopPropagation(),O.value&&c.preventDefault(),A()},onChange:c=>{if(!c.target)return;const te=c.target;u.value=[...te.files??[]]},onFocus:A,onBlur:x},le,X),null),t("div",{class:ee},[!!((T=u.value)!=null&&T.length)&&!e.hideInput&&(n.selection?n.selection({fileNames:s.value,totalBytes:m.value,totalBytesReadable:a.value}):e.chips?s.value.map(c=>t(we,{key:c,size:"small",text:c},null)):s.value.join(", "))])])}})},details:o?g=>{var w,C;return t(B,null,[(w=n.details)==null?void 0:w.call(n,g),l&&t(B,null,[t("span",null,null),t(ke,{active:!!((C=u.value)!=null&&C.length),value:q.value,disabled:e.disabled},n.counter)])])}:void 0})}),Ce({},R,N,d)}}),Ke=Ae({__name:"import",setup(e){const y=Pe(),I=ue(),k=new ae(y.$axios),n=p(null),r=p(null),u=p(null),i=p(!1),F=[{text:"Scan",disabled:!0,exact:!0},{text:"Import",disabled:!0,to:"/scan/import",exact:!0}],x=()=>{n.value=null,r.value=null,u.value=null},h=async()=>{try{if(i.value=!0,n.value===void 0||n.value===null||u.value===void 0||u.value===null)return;await k.importScan(n.value,u.value,r.value),I.reportSuccess("Scan imported successfully.")}catch(m){I.reportError((m==null?void 0:m.message)||"An error was encountered while importing scan.")}finally{i.value=!1,x()}};return(m,a)=>(ze(),Be("div",null,[t(V(ie),{breadcrumbs:F,class:"mb-5"}),t(oe,{variant:"outlined",class:"my-4",loading:V(i)},{default:f(()=>[t(se,{class:"font-weight-light"},{default:f(()=>a[3]||(a[3]=[b(" Please fill in the required fields to import the scan: ")])),_:1}),t(re,null,{default:f(()=>[t(ne,{"selected-scanner":V(n),"onUpdate:selectedScanner":a[0]||(a[0]=s=>z(n)?n.value=s:null),class:"mb-6"},null,8,["selected-scanner"]),t(De,{modelValue:V(u),"onUpdate:modelValue":a[1]||(a[1]=s=>z(u)?u.value=s:null),variant:"outlined","show-size":"",label:"File",placeholder:"Required JSON scan import file","prepend-icon":"mdi-file-upload-outline",density:"compact"},null,8,["modelValue"]),t(Re,{modelValue:V(r),"onUpdate:modelValue":a[2]||(a[2]=s=>z(r)?r.value=s:null),label:"Scan Id",placeholder:"Optional scan id to amend",clearable:"",variant:"outlined","prepend-icon":"mdi-format-text",density:"compact"},null,8,["modelValue"])]),_:1}),t(de,null,{default:f(()=>[t(j,{variant:"elevated",color:"success",loading:V(i),onClick:h},{default:f(()=>[t(E,{start:""},{default:f(()=>a[4]||(a[4]=[b(" mdi-check ")])),_:1}),a[5]||(a[5]=b("Import "))]),_:1},8,["loading"]),t(j,{variant:"elevated"},{default:f(()=>[t(E,{start:""},{default:f(()=>a[6]||(a[6]=[b(" mdi-close ")])),_:1}),a[7]||(a[7]=b("Cancel "))]),_:1})]),_:1})]),_:1},8,["loading"])]))}});export{Ke as default};

<?xml version="1.0"?>
<odoo>
  <record id="crm_case_form_view_pack_switchboard" model="ir.ui.view">
    <field name="name">crm.lead.form.opportunity.pack.switchboard</field>
    <field name="model">crm.lead</field>
    <field name="inherit_id" ref="somconnexio.crm_case_form_view_pack"/>
    <field name="arch" type="xml">
      <field name="mobile_lead_line_ids" position="after">
        <field name="has_switchboard_lead_lines" invisible="1"/>
        <field name="switchboard_lead_line_ids" string="Switchboard Lead Lines" attrs="{'readonly': False, 'invisible':[('has_switchboard_lead_lines', '=', False)]}" context="{'tree_view_ref':'switchboard_somconnexio.view_switchboard_tree_lead_line_isp_infos'}"/>
      </field>
    </field>
  </record>
  <record id="crm_lead_pack_search_view_switchboard" model="ir.ui.view">
    <field name="name">crm.lead.pack.search.view.switchboard</field>
    <field name="model">crm.lead</field>
    <field name="inherit_id" ref="somconnexio.crm_lead_pack_search_view"/>
    <field name="arch" type="xml">
      <filter name="mixed_lead_lines" position="after">
        <filter string="Switchboard lead lines" name="switchboard_lead_lines" domain="[('has_switchboard_lead_lines', '=', True)]"/>
      </filter>
    </field>
  </record>
  <record id="view_lead_create_mobile_lines_wizard_button_sb" model="ir.ui.view">
    <field name="name">crm.lead.create.lines.wizard.button.sb</field>
    <field name="model">crm.lead</field>
    <field name="inherit_id" ref="somconnexio.view_lead_create_mobile_lines_wizard_button"/>
    <field name="arch" type="xml">
        <xpath expr="//field[@name='is_broadband_isp_info_type_location_change']" position="after">
            <field name="has_switchboard_lead_lines" invisible="1"/>
        </xpath>
        <xpath expr="//button[@name='%(somconnexio.action_crm_lead_add_mobile_line_wizard)d']" position="attributes">
            <attribute name="attrs">{
                'invisible': [
                    '|',
                    '|',
                    ('stage_id', '!=', %(crm.stage_lead1)d),
                    ('is_broadband_isp_info_type_location_change', '=', True),
                    ('has_switchboard_lead_lines', '=', True)
                ]
            }</attribute>
        </xpath>
    </field>
  </record>
</odoo>

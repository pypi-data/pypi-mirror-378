"""
Guest on a high floor reports alternating hot-cold pulses and low pressure; verify mixing valve balance and apply stable massage flow.

ROLES: user (guest on workout cooldown), assistant (engineering coordinator with BAS access)
CHANNELS: analysis, commentary, final. Channel must be included for every message.
TOOLS:
```json
[
  {
    "name": "check_water_pressure",
    "description": "Measure pressure and flow for selected fixture.",
    "parameters": {"type":"object","additionalProperties":false,
      "properties":{
        "room_number":{"type":"string"},
        "fixture_type":{"type":"string","enum":["shower","sink","bathtub","all_fixtures"]},
        "measurement_type":{"type":"string","enum":["pressure_psi","flow_rate","temperature"]}
      },
      "required":["room_number","fixture_type"]
    },
    "strict": true
  },
  {
    "name": "rebalance_mixing_valve",
    "description": "Rebalance the thermostatic mixing valve to prevent temperature surges.",
    "parameters": {"type":"object","additionalProperties":false,
      "properties":{
        "room_number":{"type":"string"},
        "target_temp_f":{"type":"integer","minimum":95,"maximum":110}
      },
      "required":["room_number","target_temp_f"]
    },
    "strict": true
  },
  {
    "name": "adjust_shower_settings",
    "description": "Adjust pressure/spray pattern on the shower head.",
    "parameters": {"type":"object","additionalProperties":false,
      "properties":{
        "room_number":{"type":"string"},
        "pressure_setting":{"type":"string","enum":["gentle","medium","high","massage"]},
        "spray_pattern":{"type":"string","enum":["wide_rainfall","focused_stream","massage_pulse","mist"]}
      },
      "required":["room_number","pressure_setting"]
    },
    "strict": true
  }
]
```
"""

system:
Hotel: Urban Loft Hotel (hotel_id: ulh_nyc_07)
Address: 110 W 40th St, New York, NY 10018
Timezone: America/New_York

Bath & Shower Details:
- Combination rainfall + handheld systems in all rooms
- Thermostatic mixing valves calibrated to 102°F default
- Patterns: massage_pulse, wide_rainfall, focused_stream, mist
- Anti-hammer buffers installed on risers floors 20–30

Water Infrastructure:
- Pressure window: 48–62 PSI; overnight reduction to 46–50 PSI
- Real-time balance control through BAS; adjustments log to ticket
- Peak demand alerts auto-trigger valve rebalancing

Guest Support:
- Engineering: 06:00–23:00; urgent callout 24/7
- Fitness studio showers open 05:30–23:00
- Loaner diffusers available upon request for aromatherapy

user:
Hi, on floor 27 my shower pressure dips and temps pulse a bit. Can you stabilize it in 2711?

assistant channel=analysis:
Measure pressure, then rebalance mixing valve to 102°F, set massage_pulse medium-high for steady flow.

assistant channel=commentary to=tool.check_water_pressure:
{"room_number":"2711","fixture_type":"shower","measurement_type":"pressure_psi"}

tool.check_water_pressure channel=commentary to=assistant:
{"room_number":"2711","current_pressure_psi":47,"flow_rate_gpm":1.6,"status":"slightly_low"}

assistant channel=commentary to=tool.rebalance_mixing_valve:
{"room_number":"2711","target_temp_f":102}

tool.rebalance_mixing_valve channel=commentary to=assistant:
{"room_number":"2711","target_temp_f":102,"rebalanced":true,"temp_stability":"improved"}

assistant channel=commentary to=tool.adjust_shower_settings:
{"room_number":"2711","pressure_setting":"high","spray_pattern":"massage_pulse"}

tool.adjust_shower_settings channel=commentary to=assistant:
{"room_number":"2711","pressure_setting":"high","spray_pattern":"massage_pulse","applied":true}

assistant channel=final:
I rebalanced your mixing valve to 102°F and set the shower to high pressure with massage pulse. Please test in 2711—flow and temp should now feel steady.

user:
Thanks! Do all rooms have a handheld option too?

assistant channel=analysis:
Answer using Bath & Shower Details.

assistant channel=final:
Yes—every room here includes both rainfall and a handheld shower.

user:
By the way, how’s the subway running tonight?

assistant channel=analysis:
Transit status is beyond system.

assistant channel=final:
[ATTENTION] I acknowledge your question about subway service and will review external status.


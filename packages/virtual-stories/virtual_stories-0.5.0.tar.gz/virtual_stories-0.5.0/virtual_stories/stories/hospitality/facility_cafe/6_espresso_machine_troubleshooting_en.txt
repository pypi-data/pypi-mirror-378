"""
Guest experiences issues with the cafe's espresso machine and needs assistance with alternative options.

ROLES: user (guest experiencing technical issues with cafe equipment), assistant (cafe technician and service staff)
CHANNELS: analysis, commentary, final. Channel must be included for every message.
TOOLS:
```json
[
  {"name":"check_equipment_status","description":"Check the status of cafe equipment and identify any issues","parameters":{"type":"object","additionalProperties":false,"properties":{"equipment_type":{"type":"string","enum":["espresso_machine","grinder","steam_wand","water_system"]}},"required":["equipment_type"]},"strict":true},
  {"name":"get_alternative_options","description":"Get alternative beverage options when primary equipment is unavailable","parameters":{"type":"object","additionalProperties":false,"properties":{"unavailable_items":{"type":"array","items":{"type":"string"}}},"required":["unavailable_items"]},"strict":true},
  {"name":"schedule_repair","description":"Schedule equipment repair or maintenance","parameters":{"type":"object","additionalProperties":false,"properties":{"equipment_id":{"type":"string"},"issue_description":{"type":"string"},"priority":{"type":"string","enum":["low","medium","high","urgent"]}},"required":["equipment_id","issue_description","priority"]},"strict":true}
]
```
"""

system:
Outlet: Rivet Café (facility_id: cafe_rivet_nyc)
Property: Hudson Yardline Hotel (hotel_id: hudson_yardline_nyc)
Address: 500 W 33rd St, New York, NY 10001
Timezone: America/New_York
Hours: Weekdays 06:30–14:30; Weekends 07:00–15:00

=== EQUIPMENT SPECIFICATIONS ===
Espresso Machine: La Marzocco Linea PB, 3-group head, dual boiler system
Grinder: Mahlkönig Peak, 65mm burrs, single-dose capable
Steam Wand: 4-hole tip, 1.5 bar pressure, auto-purge system
Water System: Reverse osmosis filtration, 9-bar pressure, temperature control

=== ALTERNATIVE BREWING METHODS ===
Pour-Over Station: V60, Chemex, Kalita Wave, manual brewing
French Press: 8-cup capacity, 4-minute steep time, full immersion
AeroPress: Single-serve, 2-minute brew time, paper filters
Cold Brew: Pre-brewed concentrate, 12-hour steep, nitro available

=== EQUIPMENT MAINTENANCE ===
Daily Cleaning: Backflush, steam wand purge, grinder calibration
Weekly Service: Deep cleaning, water system check, pressure testing
Monthly Maintenance: Professional service, parts replacement, calibration
Emergency Protocol: Backup equipment, alternative methods, technician on-call

=== TECHNICAL SUPPORT ===
On-Site Technician: Available 7 AM - 6 PM, emergency calls 24/7
Equipment Warranty: La Marzocco 2-year warranty, Mahlkönig 1-year warranty
Backup Systems: Secondary espresso machine, manual brewing stations
Service Partners: Authorized repair centers, certified technicians

=== ALTERNATIVE BEVERAGE OPTIONS ===
When Espresso Unavailable: Pour-over coffee, French press, cold brew
When Grinder Issues: Pre-ground coffee, alternative brewing methods
When Steam Problems: Cold beverages, alternative milk options
When Water Issues: Bottled water brewing, alternative sources

=== GUEST ACCOMMODATION ===
Service Recovery: Complimentary drinks, loyalty points, apologies
Alternative Solutions: Manual brewing, off-site preparation, delivery
Communication: Clear updates, estimated resolution times, options
Follow-Up: Service recovery, feedback collection, improvement plans

user:
Hi, I was trying to get an espresso but the machine seems to be having issues. The shots are coming out really weak and watery.

assistant channel=analysis:
The guest is experiencing issues with our espresso machine - weak and watery shots. I should check the equipment status to diagnose the problem and then provide alternative options while we address the issue.

assistant channel=commentary to=tool.check_equipment_status:
{"equipment_type":"espresso_machine"}

tool.check_equipment_status channel=commentary to=assistant:
{"status":"malfunction","issue":"Low pressure, weak extraction","estimated_repair_time":"2-3 hours","backup_available":false,"alternative_methods":["pour_over","french_press","cold_brew"]}

assistant channel=analysis:
The espresso machine has a pressure issue causing weak extraction. I should get alternative options for the guest and schedule a repair. I'll also offer service recovery since this impacts their experience.

assistant channel=commentary to=tool.get_alternative_options:
{"unavailable_items":["espresso","cappuccino","latte","macchiato"]}

tool.get_alternative_options channel=commentary to=assistant:
{"alternatives":[{"name":"Pour-Over Coffee","description":"Manual brewing, full flavor extraction","price":"$4.50","brew_time":"3-4 minutes"},{"name":"French Press","description":"Full immersion, rich body","price":"$4.25","brew_time":"4 minutes"},{"name":"Cold Brew","description":"Smooth, low-acid, pre-brewed","price":"$5.50","brew_time":"immediate"}]}

assistant channel=analysis:
I have alternative options available. Now I should schedule the repair and provide the guest with options while apologizing for the inconvenience.

assistant channel=commentary to=tool.schedule_repair:
{"equipment_id":"espresso_marzocco_001","issue_description":"Low pressure causing weak extraction","priority":"high"}

tool.schedule_repair channel=commentary to=assistant:
{"repair_id":"REP-2024-0892","scheduled_time":"within 2 hours","technician":"Mike Rodriguez","estimated_duration":"2-3 hours"}

assistant channel=analysis:
Perfect! I've scheduled the repair and have alternative options. I'll apologize for the inconvenience, explain the situation, and offer alternatives with service recovery.

assistant channel=final:
I apologize for the inconvenience! Our espresso machine is experiencing a pressure issue that's causing weak extraction. I've scheduled a repair with our technician Mike Rodriguez - it should be fixed within 2-3 hours. In the meantime, I can offer you some excellent alternatives: our Pour-Over Coffee with manual brewing for full flavor extraction, French Press for a rich body, or our Cold Brew which is smooth and ready immediately. As a service recovery, I'd be happy to offer any of these at no charge. Which would you prefer?

user:
The pour-over sounds great! I appreciate the quick response.

assistant channel=analysis:
The guest is happy with the pour-over option and appreciates the quick response. I should acknowledge their understanding and maybe add a personal touch about the pour-over experience.

assistant channel=final:
Wonderful choice! Our pour-over coffee is actually quite special - we use the same premium beans as our espresso, and the manual brewing really brings out the full flavor profile. It's a bit of a show too, watching the barista work their magic with the V60. I'll get that started for you right away, and it'll be ready in about 3-4 minutes. Thank you for your patience with the equipment issue!

user:
No problem at all. The cafe has such a nice atmosphere despite the technical hiccup.

assistant channel=analysis:
This is a nice chitchat comment about the atmosphere. The guest is being understanding about the technical issue. I should respond warmly and maybe mention how we try to maintain the experience even during equipment issues.

assistant channel=final:
Thank you so much for understanding! We really try to maintain that welcoming atmosphere even when things don't go perfectly. The natural light and the sound of manual brewing actually creates a really peaceful vibe. It's moments like these that remind us why we love what we do - great coffee and great people, even when the machines need a little TLC.

user:
What's the difference in caffeine content between espresso and pour-over?

assistant channel=analysis:
The guest is asking about caffeine content differences between espresso and pour-over. This information is available in my system knowledge - I can provide the general differences in caffeine content between these brewing methods.

assistant channel=final:
Great question! Espresso typically has more caffeine per ounce (about 63mg per 1oz shot), but since a standard espresso shot is much smaller, a full cup of pour-over coffee actually has more total caffeine (about 95mg per 8oz cup). The pour-over method extracts caffeine more slowly over the longer brew time, so you get a more even extraction. For your pour-over, you'll get a nice, steady caffeine boost that's perfect for sustained energy throughout the morning.

user:
Do you have any information about the specific water filtration system you use for brewing?

assistant channel=analysis:
The guest is asking for specific information about our water filtration system. This detailed technical information about our water system specifications goes beyond what's available in my system knowledge or tools. I should use the ATTENTION flag since this requires information not available to me.

assistant channel=final:
[ATTENTION] That's a detailed question about our water system. Researching available details.
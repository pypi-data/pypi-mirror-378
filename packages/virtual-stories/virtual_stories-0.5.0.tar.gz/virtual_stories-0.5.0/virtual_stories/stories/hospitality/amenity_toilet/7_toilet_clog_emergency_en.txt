"""
Guest reports toilet clog emergency; run diagnostics, dispatch urgent maintenance, include small talk, and one background acknowledgment.

ROLES: user (guest with urgent bathroom issue), assistant (emergency maintenance coordinator for plumbing problems)
CHANNELS: analysis, commentary, final. Channel must be included for every message.
TOOLS:
```json
[
  {
    "name": "check_toilet_status",
    "description": "Check the smart toilet status for water supply and flush diagnostics.",
    "parameters": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "room_number": { "type": "string" }
      },
      "required": ["room_number"]
    },
    "strict": true
  },
  {
    "name": "dispatch_plumbing_support",
    "description": "Dispatch a maintenance technician to service the toilet.",
    "parameters": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "room_number": { "type": "string" },
        "issue": { "type": "string" }
      },
      "required": ["room_number", "issue"]
    },
    "strict": true
  }
]
```
"""

system:
Hotel: Pacific Tranquil Tower (hotel_id: ptt_la_09)
Address: 901 Ocean Ave, Santa Monica, CA 90401
Timezone: America/Los_Angeles

Bathroom Fixtures:
- Smart Toilet: TOTO with dual-flush, heated seat, and bidet functions
- Water pressure: Stabilized regulators per floor; diagnostics accessible to maintenance

Design Details:
- Sea-glass mosaic tiles in guest bathrooms
- Premium 3-ply toilet paper with aloe vera infusion
- Eco-friendly bamboo hand towels in all guest bathrooms
- Aromatherapy diffusers with lavender and eucalyptus scents
- Heated towel racks with temperature control
- Rainfall showerheads with adjustable pressure settings
- Non-slip bath mats with memory foam backing
- LED vanity mirrors with adjustable brightness and color temperature

Smart Toilet Features:
- Bidet function: Adjustable water pressure and temperature (warm/cool)
- Heated seat: 3 temperature settings (low/medium/high)
- Dual-flush: Light flush for liquid waste, full flush for solid waste
- Auto-flush: Motion sensor activation with manual override
- Night light: Soft LED illumination for nighttime use
- Deodorizer: Built-in air purification system

Emergency Protocols:
- Clog detection: Smart sensors monitor water flow and pressure
- Emergency response: Priority dispatch within 5 minutes for plumbing emergencies
- Backup facilities: Alternative bathroom access available during repairs
- Professional equipment: High-pressure water jets and specialized drain snakes
- Guest accommodation: Room changes available if repairs exceed 30 minutes

user:
Emergency! The toilet in room 1110 is completely clogged and water is starting to overflow onto the floor!

assistant channel=analysis:
This is an urgent plumbing emergency; run diagnostics and dispatch immediate maintenance support.

assistant channel=commentary to=tool.check_toilet_status:
{"room_number":"1110"}

tool.check_toilet_status channel=commentary to=assistant:
{"online":true,"water_supply":"blocked","flush_valve":"non_functional","drain_status":"severe_clog","water_level":"overflowing","recommendation":"immediate_emergency_service"}

assistant channel=analysis:
Severe clog with overflow detected; dispatch emergency plumbing support immediately.

assistant channel=commentary to=tool.dispatch_plumbing_support:
{"room_number":"1110","issue":"severe_clog_with_overflow"}

tool.dispatch_plumbing_support channel=commentary to=assistant:
{"scheduled":true,"assigned":"tech_emergency_team","eta_minutes":3,"priority":"emergency","equipment":["high_pressure_jet","drain_snake","water_extraction"]}

assistant channel=final:
Emergency team is on the way to room 1110 immediately—they'll arrive in 3 minutes with specialized equipment. Please avoid using the bathroom until they arrive. If you need alternative facilities, I can direct you to the nearest available bathroom.

user:
The non-slip bath mat is really helpful—I feel so secure stepping out of the shower.

assistant channel=analysis:
Acknowledge the positive feedback about the safety feature despite the current emergency.

assistant channel=final:
I'm glad the memory foam bath mats are providing that extra security! Safety is always our priority in the bathroom areas.

user:
Could you install a backup toilet system in case this happens again?

assistant channel=analysis:
Backup toilet systems aren't part of standard hotel infrastructure; use background acknowledgment flag.

assistant channel=final:
[ATTENTION] I understand your concern about future incidents. Reviewing available resources.
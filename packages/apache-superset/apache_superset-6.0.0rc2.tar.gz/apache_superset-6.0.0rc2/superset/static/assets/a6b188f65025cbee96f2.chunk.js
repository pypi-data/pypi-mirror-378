"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7616],{10781:(e,a,t)=>{t.r(a),t.d(a,{default:()=>C});var n=t(2445),i=t(96540),d=t(74098),l=t(99106),o=t(71323),s=t(86784),r=t(40105),c=t(38961),u=t(95018),h=t(89232),m=t(20237),g=t(24777),p=t(64457),b=t(8558),y=t(71519),v=t(18315),S=t(79605),_=t(44781);const C=(0,p.Ay)((function(e){const{addDangerToast:a,addSuccessToast:t,user:p}=e,{userId:C}=p,Y=(0,i.useMemo)((()=>[{id:"type",operator:"custom_tag",value:!0}]),[]),{state:{loading:f,resourceCount:T,resourceCollection:D,bulkSelectEnabled:w},hasPerm:A,fetchData:k,toggleBulkSelect:F,refreshData:z}=(0,s.RU)("tag",(0,d.t)("tag"),a,void 0,void 0,Y),[H,N]=(0,i.useState)(!1),[E,x]=(0,i.useState)(null),O=(0,i.useMemo)((()=>D.map((e=>e.id))),[D]),[$,I]=(0,s.oG)("tag",O,a),M=(0,g.SX)(null==C?void 0:C.toString(),null),P=A("can_write"),B=A("can_write"),L=[{id:"changed_on_delta_humanized",desc:!0}];function U(e){(0,v.dH)(e,(e=>{t(e),z()}),(e=>{a(e),z()}))}const j={title:(0,d.t)("No Tags created"),image:"dashboard.svg",description:"Create a new tag and assign it to existing entities like charts or dashboards",buttonAction:()=>N(!0),buttonIcon:(0,n.Y)(b.F.PlusOutlined,{iconSize:"m"}),buttonText:(0,d.t)("Create a new Tag")},q=(0,i.useMemo)((()=>[{Cell:({row:{original:{id:e}}})=>C&&(0,n.Y)(r.$,{itemId:e,saveFaveStar:$,isStarred:I[e]}),Header:"",id:"id",disableSortBy:!0,size:"xs",hidden:!C},{Cell:({row:{original:{id:e,name:a}}})=>(0,n.Y)(h.vw,{children:(0,n.Y)(y.N_,{to:`/superset/all_entities/?id=${e}`,children:a})}),Header:(0,d.t)("Name"),accessor:"name",size:"xxl",id:"name"},{Cell:({row:{original:{changed_on_delta_humanized:e,changed_by:a}}})=>(0,n.Y)(h.UW,{date:e,user:a}),Header:(0,d.t)("Last modified"),accessor:"changed_on_delta_humanized",size:"xl",id:"changed_on_delta_humanized"},{Cell:({row:{original:e}})=>(0,n.FD)(o.En,{className:"actions",children:[P&&(0,n.Y)(c.h,{title:(0,d.t)("Please confirm"),description:(0,n.FD)(n.FK,{children:[(0,d.t)("Are you sure you want to delete")," ",(0,n.Y)("b",{children:e.dashboard_title}),"?"]}),onConfirm:()=>U([e]),children:e=>(0,n.Y)(u.m,{id:"delete-action-tooltip",title:(0,d.t)("Delete"),placement:"bottom",children:(0,n.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:e,children:(0,n.Y)(b.F.DeleteOutlined,{iconSize:"l"})})})}),B&&(0,n.Y)(u.m,{id:"edit-action-tooltip",title:(0,d.t)("Edit"),placement:"bottom",children:(0,n.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>{return a=e,N(!0),void x(a);var a},children:(0,n.Y)(b.F.EditOutlined,{iconSize:"l"})})})]}),Header:(0,d.t)("Actions"),id:"actions",hidden:!P,disableSortBy:!0},{accessor:S.H.ChangedBy,hidden:!0,id:S.H.ChangedBy}]),[C,P,z,t,a]),Q=(0,i.useMemo)((()=>[{Header:(0,d.t)("Name"),id:"name",input:"search",operator:h.c0.Contains},{Header:(0,d.t)("Modified by"),key:"changed_by",id:"changed_by",input:"select",operator:h.c0.RelationOneMany,unfilteredLabel:(0,d.t)("All"),fetchSelects:(0,o.u1)("tag","changed_by",(0,o.JF)((e=>(0,d.t)("An error occurred while fetching dataset datasource values: %s",e))),p),paginate:!0}]),[a,e.user]),G=[{desc:!1,id:"name",label:(0,d.t)("Alphabetical"),value:"alphabetical"},{desc:!0,id:"changed_on_delta_humanized",label:(0,d.t)("Recently modified"),value:"recently_modified"},{desc:!1,id:"changed_on_delta_humanized",label:(0,d.t)("Least recently modified"),value:"least_recently_modified"}],K=[];return P&&K.push({name:(0,d.t)("Bulk select"),buttonStyle:"secondary",onClick:F}),K.push({icon:(0,n.Y)(b.F.PlusOutlined,{iconSize:"m"}),name:(0,d.t)("Tag"),buttonStyle:"primary",onClick:()=>N(!0)}),(0,n.FD)(n.FK,{children:[(0,n.Y)(_.A,{show:H,onHide:()=>{N(!1),x(null)},editTag:E,refreshData:z,addSuccessToast:t,addDangerToast:a,clearOnHide:!0}),(0,n.Y)(m.A,{name:(0,d.t)("Tags"),buttons:K}),(0,n.Y)(c.h,{title:(0,d.t)("Please confirm"),description:(0,d.t)("Are you sure you want to delete the selected tags?"),onConfirm:e=>U(e),children:e=>{const i=[];return P&&i.push({key:"delete",name:(0,d.t)("Delete"),type:"danger",onSelect:e}),(0,n.Y)(n.FK,{children:(0,n.Y)(h.uO,{bulkActions:i,bulkSelectEnabled:w,cardSortSelectOptions:G,className:"tags-list-view",columns:q,count:T,data:D,disableBulkSelect:F,refreshData:z,emptyState:j,fetchData:k,filters:Q,initialSort:L,loading:f,addDangerToast:a,addSuccessToast:t,pageSize:25,showThumbnails:M?M.thumbnails:(0,l.G7)(l.TO.Thumbnails),defaultViewMode:(0,l.G7)(l.TO.ListviewsDefaultCardView)?"card":"table"})})}})]})}))},36188:(e,a,t)=>{t.d(a,{c:()=>l});var n=t(2445),i=t(17437),d=t(36552);function l(e){return(0,n.Y)(d.A,{css:e=>i.AH`
        margin: ${e.margin}px 0;
      `,...e})}},44781:(e,a,t)=>{t.d(a,{A:()=>C});var n=t(2445),i=t(96540),d=t(58561),l=t.n(d),o=t(97163),s=t(88217),r=t(76576),c=t(23195),u=t(17355),h=t(36188),m=t(49965),g=t(50290),p=t(79378),b=t(74098),y=t(18315),v=t(51692);const S=g.I4.div`
  .ant-select-dropdown {
    max-height: ${({theme:e})=>40*e.sizeUnit}px;
  }
  .tag-input {
    margin-bottom: ${({theme:e})=>3*e.sizeUnit}px;
  }
`;var _;!function(e){e.Chart="chart",e.Dashboard="dashboard",e.SavedQuery="query"}(_||(_={}));const C=({show:e,onHide:a,editTag:t,refreshData:d,addSuccessToast:C,addDangerToast:Y,clearOnHide:f=!1})=>{const[T,D]=(0,i.useState)([]),[w,A]=(0,i.useState)([]),[k,F]=(0,i.useState)([]),[z,H]=(0,i.useState)(""),[N,E]=(0,i.useState)(""),x=(0,g.DP)(),O=!!t,$=()=>{H(""),E(""),D([]),A([]),F([])};(0,i.useEffect)((()=>{const e={[_.Dashboard]:[],[_.Chart]:[],[_.SavedQuery]:[]},a=({id:a,name:t,type:n})=>{const i=e[n];i&&i.push({value:a,label:t,key:a})};D([]),A([]),F([]),O&&((0,y.Ik)({tagIds:[t.id],types:null},(t=>{t.forEach(a),D(e[_.Dashboard]),A(e[_.Chart]),F(e[_.SavedQuery])}),(e=>{Y("Error Fetching Tagged Objects")})),H(t.name),E(t.description))}),[t]);const I=async(e,a,t,n,i,d,o)=>{const s=l().encode({columns:n,filters:[{col:i,opr:"ct",value:e}],page:a,order_column:d}),{json:r}=await p.A.get({endpoint:`/api/v1/${o}/?q=${s}`}),{result:c,count:u}=r;return{data:c.map((e=>({value:e.id,label:e[i]}))),totalCount:u}},M=(e,a)=>{e===_.Dashboard?D(a):e===_.Chart?A(a):e===_.SavedQuery&&F(a)};return(0,n.Y)(o.aF,{name:O?(0,b.t)("Edit Tag"):(0,b.t)("Create Tag"),title:(0,n.Y)(v.r,{isEditMode:O,title:O?(0,b.t)("Edit Tag"):(0,b.t)("Create Tag")}),onHide:()=>{f&&$(),a()},show:e,footer:(0,n.FD)("div",{children:[(0,n.Y)(s.$,{buttonStyle:"secondary",onClick:a,children:(0,b.t)("Cancel")}),(0,n.Y)(s.$,{buttonStyle:"primary",onClick:()=>{const e=T.map((e=>["dashboard",e.value])),n=w.map((e=>["chart",e.value])),i=k.map((e=>["query",e.value]));O?p.A.put({endpoint:`/api/v1/tag/${t.id}`,jsonPayload:{description:N,name:z,objects_to_tag:[...e,...n,...i]}}).then((()=>{d(),$(),C((0,b.t)("Tag updated")),a()})).catch((e=>{Y(e.message||"Error Updating Tag")})):p.A.post({endpoint:"/api/v1/tag/",jsonPayload:{description:N,name:z,objects_to_tag:[...e,...n,...i]}}).then((()=>{d(),$(),C((0,b.t)("Tag created")),a()})).catch((e=>Y(e.message||"Error Creating Tag")))},children:(0,b.t)("Save")})]}),children:(0,n.FD)(S,{children:[(0,n.FD)(r.s,{vertical:!0,gap:x.sizeUnit,children:[(0,n.Y)(c.l,{htmlFor:"tag-name",children:(0,b.t)("Tag name")}),(0,n.Y)(u.A,{id:"tag-name",className:"tag-input",onChange:e=>H(e.target.value),placeholder:(0,b.t)("Name of your tag"),value:z})]}),(0,n.FD)(r.s,{vertical:!0,gap:x.sizeUnit,children:[(0,n.Y)(c.l,{children:(0,b.t)("Description")}),(0,n.Y)(u.A,{className:"tag-input",onChange:e=>E(e.target.value),placeholder:(0,b.t)("Add description of your tag"),value:N})]}),(0,n.Y)(h.c,{}),(0,n.Y)(m.A,{className:"tag-input",ariaLabel:(0,b.t)("Select dashboards"),mode:"multiple",name:"dashboards",value:T,options:async(e,a,t)=>I(e,a,0,["id","dashboard_title"],"dashboard_title","dashboard_title","dashboard"),onChange:e=>M(_.Dashboard,e),header:(0,n.Y)(c.l,{children:(0,b.t)("Dashboards")}),allowClear:!0}),(0,n.Y)(m.A,{className:"tag-input",ariaLabel:(0,b.t)("Select charts"),mode:"multiple",name:"charts",value:w,options:async(e,a,t)=>I(e,a,0,["id","slice_name"],"slice_name","slice_name","chart"),onChange:e=>M(_.Chart,e),header:(0,n.Y)(c.l,{children:(0,b.t)("Charts")}),allowClear:!0}),(0,n.Y)(m.A,{className:"tag-input",ariaLabel:(0,b.t)("Select saved queries"),mode:"multiple",name:"savedQueries",value:k,options:async(e,a,t)=>I(e,a,0,["id","label"],"label","label","saved_query"),onChange:e=>M(_.SavedQuery,e),header:(0,n.Y)(c.l,{children:(0,b.t)("Saved queries")}),allowClear:!0})]})})}}}]);
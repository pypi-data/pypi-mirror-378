"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[1285],{1112:(e,t,a)=>{a.r(t),a.d(t,{default:()=>F});var n=a(2445),i=a(96540),r=a(17437),s=a(50290),o=a(74098),l=a(33231),d=a(59674),c=a(50659),h=a(38134),g=a(89232),u=a(42566);const p=s.I4.div`
  text-align: left;
  border-radius: ${({theme:e})=>e.borderRadius}px 0;
  .table {
    table-layout: fixed;
  }
  .td {
    width: 33%;
  }
  .entity-title {
    font-family: Inter;
    font-size: ${({theme:e})=>e.fontSize}px;
    font-weight: ${({theme:e})=>e.fontWeightStrong};
    line-height: 17px;
    letter-spacing: 0px;
    text-align: left;
    margin: ${({theme:e})=>4*e.sizeUnit}px 0;
  }
`;function m({search:e="",setShowTagModal:t,objects:a,canEditTag:i}){const r=a.dashboard.length>0,s=a.chart.length>0,l=a.query.length>0,m=r||s||l,b=e=>{const t=a[e].map((t=>({[e]:(0,n.Y)(u.o.Link,{href:t.url,children:t.name}),modified:d.XV.utc(t.changed_on).fromNow(),tags:t.tags,owners:t.owners})));return(0,n.Y)(c.Q,{className:"table-condensed",emptyWrapperType:c.V.Small,data:t,pageSize:10,columns:[{accessor:e,Header:"Title",id:e},{Cell:({row:{original:{tags:e=[]}}})=>(0,n.Y)(g.Sk,{tags:e.filter((e=>void 0!==e.type&&["TagType.custom",1].includes(e.type))),maxTags:3}),Header:(0,o.t)("Tags"),accessor:"tags",disableSortBy:!0,id:"tags"},{Cell:({row:{original:{owners:e=[]}}})=>(0,n.Y)(g.WM,{users:e}),Header:(0,o.t)("Owners"),accessor:"owners",disableSortBy:!0,size:"xl",id:"owners"}]})};return(0,n.Y)(p,{children:m?(0,n.FD)(n.FK,{children:[r&&(0,n.FD)(n.FK,{children:[(0,n.Y)("div",{className:"entity-title",children:(0,o.t)("Dashboards")}),b("dashboard")]}),s&&(0,n.FD)(n.FK,{children:[(0,n.Y)("div",{className:"entity-title",children:(0,o.t)("Charts")}),b("chart")]}),l&&(0,n.FD)(n.FK,{children:[(0,n.Y)("div",{className:"entity-title",children:(0,o.t)("Queries")}),b("query")]})]}):(0,n.Y)(h.p,{image:"dashboard.svg",size:"large",title:(0,o.t)("No entities have this tag currently assigned"),...i&&{buttonAction:()=>t(!0),buttonText:(0,o.t)("Add tag to entities")}})})}var b=a(92998),v=a(88217),y=a(22802),f=a(10320),S=a(73306),T=a(44781),Y=a(64457),$=a(18315),x=a(58486),w=a(90886),z=a(61225);const C=e=>r.AH`
  display: flex;
  align-items: center;
  margin-left: ${e.sizeUnit}px;
  & > span {
    margin-right: ${3*e.sizeUnit}px;
  }
`,D=s.I4.div`
  ${({theme:e})=>`\n  background-color: ${e.colorBgContainer};\n  .select-control {\n    margin-left: ${4*e.sizeUnit}px;\n    margin-right: ${4*e.sizeUnit}px;\n    margin-bottom: ${2*e.sizeUnit}px;\n  }\n  .select-control-label {\n    font-size: ${3*e.sizeUnit}px;\n    color: ${e.colorText};\n    margin-bottom: ${1*e.sizeUnit}px;\n  }\n  .entities {\n    margin: ${6*e.sizeUnit}px; 0px;\n  }\n  .pagination-container {\n    background-color: transparent;\n  }\n  `}
`,A=s.I4.div`
  ${({theme:e})=>`\n  height: ${12.5*e.sizeUnit}px;\n  background-color: ${e.colorBgBase};\n  margin-bottom: ${4*e.sizeUnit}px;\n  .navbar-brand {\n    margin-left: ${2*e.sizeUnit}px;\n    font-weight: ${e.fontWeightStrong};\n  }\n  .header {\n    font-weight: ${e.fontWeightStrong};\n    margin-right:  ${3*e.sizeUnit}px;\n    text-align: left;\n    font-size: ${4.5*e.sizeUnit}px;\n    padding: ${3*e.sizeUnit}px;\n    display: inline-block;\n    line-height: ${9*e.sizeUnit}px;\n  }\n  `};
`,F=(0,Y.Ay)((function(){const[e]=(0,l.pE)("id",l.hc),[t,a]=(0,i.useState)(null),[r,s]=(0,i.useState)(!1),{addSuccessToast:d,addDangerToast:c}=(0,Y.Yf)(),[h,g]=(0,i.useState)(!1),[u,p]=(0,i.useState)({dashboard:[],chart:[],query:[]}),F=(0,z.d4)((e=>{var t;return(0,w.L)("can_write","Tag",null==(t=e.user)?void 0:t.roles)})),U={title:(null==t?void 0:t.name)||"",placeholder:"testing",onSave:()=>{},canEdit:!1,label:(0,o.t)("dataset name")},_=[];if(null!=t&&t.description){const e={type:y.Q.Description,value:(null==t?void 0:t.description)||""};_.push(e)}const E={type:y.Q.Owner,createdBy:(0,x.A)(null==t?void 0:t.created_by),createdOn:(null==t?void 0:t.created_on_delta_humanized)||""};_.push(E);const k={type:y.Q.LastModified,value:(null==t?void 0:t.changed_on_delta_humanized)||"",modifiedBy:(0,x.A)(null==t?void 0:t.changed_by)};_.push(k);const I=()=>{g(!0),t?(0,$.Ik)({tagIds:void 0!==(null==t?void 0:t.id)?[t.id]:"",types:null},(e=>{const t={dashboard:[],chart:[],query:[]};e.forEach((function(e){const a=e.type;t[a].push(e)})),p(t),g(!1)}),(e=>{c("Error Fetching Tagged Objects"),g(!1)})):c("Error tag object is not referenced!")},N=e=>{(0,$.FA)(e,(e=>{a(e),g(!1)}),(e=>{c((0,o.t)("Error Fetching Tagged Objects")),g(!1)}))};return(0,i.useEffect)((()=>{e&&(g(!0),N(e))}),[e]),(0,i.useEffect)((()=>{t&&I()}),[t]),h?(0,n.Y)(b.R,{}):(0,n.FD)(D,{children:[(0,n.Y)(T.A,{show:r,onHide:()=>{s(!1)},editTag:t,addSuccessToast:d,addDangerToast:c,refreshData:()=>{I(),e&&N(e)}}),(0,n.Y)(A,{children:(0,n.Y)(S.U,{additionalActionsMenu:(0,n.Y)(n.FK,{}),editableTitleProps:U,faveStarProps:{itemId:1,saveFaveStar:()=>{}},showFaveStar:!1,showTitlePanelItems:!0,titlePanelAdditionalItems:(0,n.Y)("div",{css:C,children:(0,n.Y)(f.Ay,{items:_,tooltipPlacement:"bottom"})}),rightPanelAdditionalItems:(0,n.Y)(n.FK,{children:F&&(0,n.FD)(v.$,{buttonStyle:"secondary",onClick:()=>s(!0),showMarginRight:!1,children:[(0,o.t)("Edit tag")," "]})}),menuDropdownProps:{disabled:!0},showMenuDropdown:!1})}),(0,n.Y)("div",{className:"entities",children:(0,n.Y)(m,{search:(null==t?void 0:t.name)||"",setShowTagModal:s,objects:u,canEditTag:F})})]})}))},36188:(e,t,a)=>{a.d(t,{c:()=>s});var n=a(2445),i=a(17437),r=a(36552);function s(e){return(0,n.Y)(r.A,{css:e=>i.AH`
        margin: ${e.margin}px 0;
      `,...e})}},44781:(e,t,a)=>{a.d(t,{A:()=>T});var n=a(2445),i=a(96540),r=a(58561),s=a.n(r),o=a(97163),l=a(88217),d=a(76576),c=a(23195),h=a(17355),g=a(36188),u=a(49965),p=a(50290),m=a(79378),b=a(74098),v=a(18315),y=a(51692);const f=p.I4.div`
  .ant-select-dropdown {
    max-height: ${({theme:e})=>40*e.sizeUnit}px;
  }
  .tag-input {
    margin-bottom: ${({theme:e})=>3*e.sizeUnit}px;
  }
`;var S;!function(e){e.Chart="chart",e.Dashboard="dashboard",e.SavedQuery="query"}(S||(S={}));const T=({show:e,onHide:t,editTag:a,refreshData:r,addSuccessToast:T,addDangerToast:Y,clearOnHide:$=!1})=>{const[x,w]=(0,i.useState)([]),[z,C]=(0,i.useState)([]),[D,A]=(0,i.useState)([]),[F,U]=(0,i.useState)(""),[_,E]=(0,i.useState)(""),k=(0,p.DP)(),I=!!a,N=()=>{U(""),E(""),w([]),C([]),A([])};(0,i.useEffect)((()=>{const e={[S.Dashboard]:[],[S.Chart]:[],[S.SavedQuery]:[]},t=({id:t,name:a,type:n})=>{const i=e[n];i&&i.push({value:t,label:a,key:t})};w([]),C([]),A([]),I&&((0,v.Ik)({tagIds:[a.id],types:null},(a=>{a.forEach(t),w(e[S.Dashboard]),C(e[S.Chart]),A(e[S.SavedQuery])}),(e=>{Y("Error Fetching Tagged Objects")})),U(a.name),E(a.description))}),[a]);const j=async(e,t,a,n,i,r,o)=>{const l=s().encode({columns:n,filters:[{col:i,opr:"ct",value:e}],page:t,order_column:r}),{json:d}=await m.A.get({endpoint:`/api/v1/${o}/?q=${l}`}),{result:c,count:h}=d;return{data:c.map((e=>({value:e.id,label:e[i]}))),totalCount:h}},Q=(e,t)=>{e===S.Dashboard?w(t):e===S.Chart?C(t):e===S.SavedQuery&&A(t)};return(0,n.Y)(o.aF,{name:I?(0,b.t)("Edit Tag"):(0,b.t)("Create Tag"),title:(0,n.Y)(y.r,{isEditMode:I,title:I?(0,b.t)("Edit Tag"):(0,b.t)("Create Tag")}),onHide:()=>{$&&N(),t()},show:e,footer:(0,n.FD)("div",{children:[(0,n.Y)(l.$,{buttonStyle:"secondary",onClick:t,children:(0,b.t)("Cancel")}),(0,n.Y)(l.$,{buttonStyle:"primary",onClick:()=>{const e=x.map((e=>["dashboard",e.value])),n=z.map((e=>["chart",e.value])),i=D.map((e=>["query",e.value]));I?m.A.put({endpoint:`/api/v1/tag/${a.id}`,jsonPayload:{description:_,name:F,objects_to_tag:[...e,...n,...i]}}).then((()=>{r(),N(),T((0,b.t)("Tag updated")),t()})).catch((e=>{Y(e.message||"Error Updating Tag")})):m.A.post({endpoint:"/api/v1/tag/",jsonPayload:{description:_,name:F,objects_to_tag:[...e,...n,...i]}}).then((()=>{r(),N(),T((0,b.t)("Tag created")),t()})).catch((e=>Y(e.message||"Error Creating Tag")))},children:(0,b.t)("Save")})]}),children:(0,n.FD)(f,{children:[(0,n.FD)(d.s,{vertical:!0,gap:k.sizeUnit,children:[(0,n.Y)(c.l,{htmlFor:"tag-name",children:(0,b.t)("Tag name")}),(0,n.Y)(h.A,{id:"tag-name",className:"tag-input",onChange:e=>U(e.target.value),placeholder:(0,b.t)("Name of your tag"),value:F})]}),(0,n.FD)(d.s,{vertical:!0,gap:k.sizeUnit,children:[(0,n.Y)(c.l,{children:(0,b.t)("Description")}),(0,n.Y)(h.A,{className:"tag-input",onChange:e=>E(e.target.value),placeholder:(0,b.t)("Add description of your tag"),value:_})]}),(0,n.Y)(g.c,{}),(0,n.Y)(u.A,{className:"tag-input",ariaLabel:(0,b.t)("Select dashboards"),mode:"multiple",name:"dashboards",value:x,options:async(e,t,a)=>j(e,t,0,["id","dashboard_title"],"dashboard_title","dashboard_title","dashboard"),onChange:e=>Q(S.Dashboard,e),header:(0,n.Y)(c.l,{children:(0,b.t)("Dashboards")}),allowClear:!0}),(0,n.Y)(u.A,{className:"tag-input",ariaLabel:(0,b.t)("Select charts"),mode:"multiple",name:"charts",value:z,options:async(e,t,a)=>j(e,t,0,["id","slice_name"],"slice_name","slice_name","chart"),onChange:e=>Q(S.Chart,e),header:(0,n.Y)(c.l,{children:(0,b.t)("Charts")}),allowClear:!0}),(0,n.Y)(u.A,{className:"tag-input",ariaLabel:(0,b.t)("Select saved queries"),mode:"multiple",name:"savedQueries",value:D,options:async(e,t,a)=>j(e,t,0,["id","label"],"label","label","saved_query"),onChange:e=>Q(S.SavedQuery,e),header:(0,n.Y)(c.l,{children:(0,b.t)("Saved queries")}),allowClear:!0})]})})}}}]);
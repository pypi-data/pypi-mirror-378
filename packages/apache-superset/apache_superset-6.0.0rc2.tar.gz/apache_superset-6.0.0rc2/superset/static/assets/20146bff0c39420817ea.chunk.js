"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[7670],{47324:(t,e,n)=>{n.d(e,{A:()=>i});var a=n(2445),r=n(96540);function i(t,e){class n extends r.Component{constructor(t){super(t),this.container=void 0,this.setContainerRef=this.setContainerRef.bind(this)}componentDidMount(){this.execute()}componentDidUpdate(){this.execute()}componentWillUnmount(){this.container=void 0,null!=e&&e.componentWillUnmount&&e.componentWillUnmount.bind(this)()}setContainerRef(t){this.container=t}execute(){this.container&&t(this.container,this.props)}render(){const{id:t,className:e}=this.props;return(0,a.Y)("div",{ref:this.setContainerRef,id:t,className:e})}}const i=n;return t.displayName&&(i.displayName=t.displayName),t.propTypes&&(i.propTypes={...i.propTypes,...t.propTypes}),t.defaultProps&&(i.defaultProps=t.defaultProps),n}},87670:(t,e,n)=>{n.r(e),n.d(e,{default:()=>R});var a=n(47324),r=n(17437),i=n(50290),s=n(24143),o=n.n(s),d=n(5556),l=n.n(d),c=n(71111),u=n.n(c),p=n(29898),g=n(58083),h=n(14503);const m={data:l().objectOf(l().arrayOf(l().shape({key:l().arrayOf(l().string),name:l().arrayOf(l().string),time:l().number,value:l().number}))),width:l().number,height:l().number,dateTimeFormat:l().string,numberFormat:l().string,useRichTooltip:l().bool,useAreaProportions:l().bool,colorScheme:l().string};function f(t){return{startAngle:t.startAngle,endAngle:t.endAngle,innerRadius:t.innerRadius,outerRadius:t.outerRadius}}function y(t,e){return t.value===e.value?t.name>e.name?1:-1:e.value-t.value}function I(t,e){const{data:n,width:a,height:r,colorScheme:i,dateTimeFormat:s,numberFormat:d,useRichTooltip:l,useAreaProportions:c,sliceId:m}=e,I=o().select(t);I.classed("superset-legacy-chart-rose",!0);const b=n,A=Object.keys(b).map((t=>parseInt(t,10))).sort(((t,e)=>t-e)),v=A.length,R=b[A[0]].length,T=(0,p.gV)(d),w=(0,g.mo)(s),x=h.getScale(i);o().select(".nvtooltip").remove(),I.selectAll("*").remove();const k=o().svg.arc(),S=u().models.legend(),O=u().models.tooltip(),N={disabled:b[A[0]].map((()=>!1))},$=I.append("svg").attr("width",a).attr("height",r).append("g").attr("class","rose").append("g"),M=$.append("g").attr("class","legendWrap");function C(t){return t[A[0]].map(((t,e)=>({disabled:N.disabled[e],key:t.name})))}S.width(a).color((t=>x(t.key,m))),M.datum(C(b)).call(S),O.headerFormatter(w).valueFormatter(T),O.classes("tooltip");const F=r-S.height(),P=S.height(),L=Math.min(a,F)/2-35,W=.075,z=`translate(${a/2},${F/2+P})`,J=$.append("g").attr("transform",z).attr("class","roseWrap"),U=$.append("g").attr("transform",z).attr("class","labelsWrap"),D=$.append("g").attr("transform",z).attr("class","groupLabelsWrap");function j(t){let e=0,n=0;const a=[];for(const t of A){const r=b[t].reduce(((t,e,n)=>t+(N.disabled[n]?0:e.value)),0);e=r>e?r:e,a[n]=r,n+=1}const r=2*Math.PI/v,i=[];for(let t=0;t<=v;t+=1)i.push(r*t-Math.PI/2);const s=L/e,o=s*L,d=(t,e)=>c?Math.sqrt(o*t+e*e):s*t+e,l={data:[],extend:{},push:{},pieStart:{},pie:{},pieOver:{},mini:{},labels:[],groupLabels:[]};let u=0;for(let e=0;e<v;e+=1){const n=A[e],r=i[e],s=i[e+1],o=2*Math.PI/a[e];let c,p,g=0,h=0;for(const e of t[n]){const t=N.disabled[u%R]?0:e.value,{name:n,time:a}=e;e.id=u,c=d(t,g),l.data.push({startAngle:r,endAngle:s,innerRadius:g,outerRadius:c,name:n,arcId:u,val:t,time:a}),l.extend[u]={startAngle:r,endAngle:s,innerRadius:g,name:n,outerRadius:c+8},l.push[u]={startAngle:r,endAngle:s,innerRadius:g+8,outerRadius:c+8},l.pieStart[u]={startAngle:r,endAngle:s,innerRadius:W*L,outerRadius:L},l.mini[u]={startAngle:r,endAngle:s,innerRadius:g*W,outerRadius:c*W},u+=1,g=c}const m={...l.data[e*R]};m.outerRadius=L+20,m.innerRadius=L+15,l.labels.push(m);for(const r of t[n].concat().sort(y))p=o*(N.disabled[r.id%R]?0:r.value)+h,l.pie[r.id]={startAngle:h,endAngle:p,innerRadius:L*W,outerRadius:L,percent:r.value/a[e]},l.pieOver[r.id]={startAngle:h,endAngle:p,innerRadius:L*W,outerRadius:L+8},h=p}return l.groupLabels=l.data.slice(0,R),l}let Y=j(b);function B(t,e){return function(n){const a=o().interpolate(f(n),f(t));return t=>e(Object.assign(n,a(t)))}}function K(t){return B(t,(t=>k(t)))}function q(t){return B(t,(t=>`translate(${k.centroid(t)})`))}const E={};function G(t){if(E[t])return E[t];const e=Math.floor(t/R);return E[t]=[t+1,R*(e+1)-1],E[t]}const H={};function V(t){if(H[t])return H[t];const e=Math.floor(t/R);return H[t]=[e*R,(e+1)*R-1],H[t]}let Q=-1,X=!1;const Z=J.selectAll("g").data(JSON.parse(JSON.stringify(Y.data))).enter().append("g").attr("class","segment").classed("clickable",!0).on("mouseover",(function(t,e){O.data(function(t,e,n){const a=Math.floor(t.arcId/R),r=l?n[A[a]].filter((t=>!N.disabled[t.id%R])).map((e=>({key:e.name,value:e.value,color:x(e.name,m),highlight:e.id===t.arcId}))):[{key:t.name,value:t.val,color:x(t.name,m)}];return{key:"Date",value:t.time,series:r}}(t,0,b)).hidden(!1);const n=o().select(this);if(n.classed("hover",!0),Q<0&&!X){n.select("path").interrupt().transition().duration(180).attrTween("d",K(Y.extend[e]));const t=G(e);et.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(180).attrTween("d",(t=>K(Y.push[t.arcId])(t)))}else if(!X){const a=V(Q);a[0]<=t.arcId&&t.arcId<=a[1]&&n.select("path").interrupt().transition().duration(180).attrTween("d",K(Y.pieOver[e]))}})).on("mouseout",(function(t,e){O.hidden(!0);const n=o().select(this);if(n.classed("hover",!1),Q<0&&!X){n.select("path").interrupt().transition().duration(180).attrTween("d",K(Y.data[e]));const t=G(e);et.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(180).attrTween("d",(t=>K(Y.data[t.arcId])(t)))}else if(!X){const a=V(Q);a[0]<=t.arcId&&t.arcId<=a[1]&&n.select("path").interrupt().transition().duration(180).attrTween("d",K(Y.pie[e]))}})).on("mousemove",(function(){O()})).on("click",(function(t,e){if(X)return;const n=o().event.altKey?3750:375,a=V(e);if(Q<0)X=!0,Q=e,_.interrupt().transition().duration(n).attrTween("transform",(t=>q({outerRadius:0,innerRadius:0,startAngle:t.startAngle,endAngle:t.endAngle})(t))).style("opacity",0),tt.attr("transform",`translate(${k.centroid({outerRadius:L+20,innerRadius:L+15,startAngle:Y.data[e].startAngle,endAngle:Y.data[e].endAngle})})`).interrupt().transition().delay(n).duration(n).attrTween("transform",(t=>q({outerRadius:L+20,innerRadius:L+15,startAngle:Y.pie[a[0]+t.arcId].startAngle,endAngle:Y.pie[a[0]+t.arcId].endAngle})(t))).style("opacity",(t=>N.disabled[t.arcId]||Y.pie[a[0]+t.arcId].percent<.05?0:1)),Z.classed("clickable",(t=>a[0]>t.arcId||t.arcId>a[1])),et.filter((t=>a[0]<=t.arcId&&t.arcId<=a[1])).interrupt().transition().duration(n).attrTween("d",(t=>K(Y.pieStart[t.arcId])(t))).transition().duration(n).attrTween("d",(t=>K(Y.pie[t.arcId])(t))).each("end",(()=>{X=!1})),et.filter((t=>a[0]>t.arcId||t.arcId>a[1])).interrupt().transition().duration(n).attrTween("d",(t=>K(Y.mini[t.arcId])(t)));else if(Q<a[0]||a[1]<Q){X=!0;const t=V(Q);_.interrupt().transition().delay(n).duration(n).attrTween("transform",(t=>q(Y.labels[t.arcId/R])(t))).style("opacity",1),tt.interrupt().transition().duration(n).attrTween("transform",q({outerRadius:L+20,innerRadius:L+15,startAngle:Y.data[Q].startAngle,endAngle:Y.data[Q].endAngle})).style("opacity",0),Z.classed("clickable",!0),et.filter((e=>t[0]<=e.arcId&&e.arcId<=t[1])).interrupt().transition().duration(n).attrTween("d",(t=>K(Y.pieStart[t.arcId])(t))).transition().duration(n).attrTween("d",(t=>K(Y.data[t.arcId])(t))).each("end",(()=>{Q=-1,X=!1})),et.filter((e=>t[0]>e.arcId||e.arcId>t[1])).interrupt().transition().delay(n).duration(n).attrTween("d",(t=>K(Y.data[t.arcId])(t)))}})),_=U.selectAll("g").data(JSON.parse(JSON.stringify(Y.labels))).enter().append("g").attr("class","roseLabel").attr("transform",(t=>`translate(${k.centroid(t)})`));_.append("text").style("text-anchor","middle").style("fill","#000").text((t=>w(t.time)));const tt=D.selectAll("g").data(JSON.parse(JSON.stringify(Y.groupLabels))).enter().append("g");tt.style("opacity",0).attr("class","roseGroupLabels").append("text").style("text-anchor","middle").style("fill","#000").text((t=>t.name));const et=Z.append("path").attr("class","arc").attr("fill",(t=>x(t.name,m))).attr("d",k);S.dispatch.on("stateChange",(t=>{N.disabled!==t.disabled&&(N.disabled=t.disabled,function(){const t=o().event.altKey?3e3:300;M.datum(C(b)).call(S);const e=j(b);if(X=!0,Q<0)et.style("opacity",1).interrupt().transition().duration(t).attrTween("d",(t=>K(e.data[t.arcId])(t))).each("end",(()=>{X=!1,Y=e})).transition().duration(0).style("opacity",(t=>N.disabled[t.arcId%R]?0:1));else{const n=V(Q);et.style("opacity",1).interrupt().transition().duration(t).attrTween("d",(t=>n[0]<=t.arcId&&t.arcId<=n[1]?K(e.pie[t.arcId])(t):K(e.mini[t.arcId])(t))).each("end",(()=>{X=!1,Y=e})).transition().duration(0).style("opacity",(t=>N.disabled[t.arcId%R]?0:1)),tt.interrupt().transition().duration(t).attrTween("transform",(t=>q({outerRadius:L+20,innerRadius:L+15,startAngle:e.pie[n[0]+t.arcId].startAngle,endAngle:e.pie[n[0]+t.arcId].endAngle})(t))).style("opacity",(t=>N.disabled[t.arcId]||Y.pie[n[0]+t.arcId].percent<.05?0:1))}}())}))}I.displayName="Rose",I.propTypes=m;const b=I;var A=n(2445);const v=(0,a.A)(b),R=(0,i.I4)((({className:t,...e})=>(0,A.FD)("div",{className:t,children:[(0,A.Y)(r.mL,{styles:t=>r.AH`
        .tooltip {
          line-height: 1;
          padding: ${3*t.sizeUnit}px;
          background: ${t.colorBgElevated};
          color: ${t.colorText};
          border-radius: 4px;
          pointer-events: none;
          z-index: 1000;
          font-size: ${t.fontSizeSM}px;
        }
      `}),(0,A.Y)(v,{...e})]})))`
  ${({theme:t})=>`\n    .superset-legacy-chart-rose path {\n        transition: fill-opacity 180ms linear;\n        stroke: ${t.colorBorder};\n        stroke-width: 1px;\n        stroke-opacity: 1;\n        fill-opacity: 0.75;\n    }\n\n    .superset-legacy-chart-rose text {\n        font-size: ${t.fontSizeSM}px;\n        font-family: ${t.fontFamily};\n        pointer-events: none;\n    }\n\n    .superset-legacy-chart-rose .clickable path {\n        cursor: pointer;\n    }\n\n    .superset-legacy-chart-rose .hover path {\n        fill-opacity: 1;\n    }\n\n    .nv-legend .nv-series {\n        cursor: pointer;\n    }\n  `}
`}}]);
(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[5474],{42634:()=>{},46217:(t,o,e)=>{"use strict";e.r(o),e.d(o,{default:()=>w,getLayer:()=>y,getPoints:()=>b});var r=e(2445),l=e(96540),i=e(15022),s=e(25879),a=e.n(s),n=e(35942),u=e(50871),d=e(98456),p=e(83860),f=e(52480),c=e(48238),C=e(51316);const k={fillColor:"fillColor",color:"fillColor",fill:"fillColor","fill-color":"fillColor",strokeColor:"strokeColor","stroke-color":"strokeColor","stroke-width":"strokeWidth"},h=(t,o)=>{const e={};return Object.keys(t).forEach((o=>{o in k?e[k[o]]=t[o]:e[o]=t[o]})),"string"==typeof t.fillColor&&(e.fillColor=(0,u.hexToRGB)(t.fillColor)),"string"==typeof t.strokeColor&&(e.strokeColor=(0,u.hexToRGB)(t.strokeColor)),{...e,...o}};let m=[];const v=(t,o,e)=>{if(null!=t&&t.features&&t.features.forEach((r=>{v(r,o,t.extraProps||e)})),null!=t&&t.geometry){const r={...t,properties:h(t.properties,o)};r.extraProps||(r.extraProps=e),m.push(r)}};function g(t){var o;return(null==(o=t.object)?void 0:o.extraProps)&&(0,r.Y)("div",{className:"deckgl-tooltip",children:Object.keys(t.object.extraProps).map(((o,e)=>{var l;return(0,r.Y)(f.A,{label:`${o}: `,value:`${null==(l=t.object.extraProps)?void 0:l[o]}`},`prop-${e}`)}))})}const x=t=>{var o;return null==t||null==(o=t.properties)?void 0:o.strokeColor},y=function({formData:t,onContextMenu:o,filterState:e,setDataMask:r,payload:l,setTooltip:s,emitCrossFilters:a}){const n=t,u=n.fill_color_picker,f=n.stroke_color_picker,c=[u.r,u.g,u.b,255*u.a],k=[f.r,f.g,f.b,255*f.a],h={};c[3]>0&&(h.fillColor=c),k[3]>0&&(h.strokeColor=k),m=[],v(l.data,h);let y=m;return n.js_data_mutator&&(y=(0,d.A)(n.js_data_mutator)(m)),new i.A({id:`geojson-layer-${n.slice_id}`,data:y,extruded:n.extruded,filled:n.filled,stroked:n.stroked,getFillColor:t=>((t,o)=>{var e;if(o){var r;if(JSON.stringify(t.geometry.coordinates)===JSON.stringify(null==o?void 0:o[0]))return C.Fe;const e=null==t||null==(r=t.properties)?void 0:r.fillColor;return e[3]=125,e}return null==t||null==(e=t.properties)?void 0:e.fillColor})(t,null==e?void 0:e.value),getLineColor:x,getLineWidth:n.line_width||1,pointRadiusScale:n.point_radius_scale,lineWidthUnits:n.line_width_unit,...(0,p.T$)({formData:n,setTooltip:s,setTooltipContent:g,setDataMask:r,filterState:e,onContextMenu:o,emitCrossFilters:a})})};function b(t){return t.reduce(((t,o)=>{const e=a()(o);return e?[...t,[e[0],e[1]],[e[2],e[3]]]:t}),[])}const _=t=>{var o;const e=(0,l.useRef)(),i=(0,l.useCallback)((t=>{const{current:o}=e;o&&o.setTooltip(t)}),[]),{formData:s,payload:a,setControlValue:u,onAddFilter:d,height:p,width:f}=t,C=(0,l.useMemo)((()=>s.autozoom&&(b(a.data.features)||[]).length?(0,c.A)(t.viewport,{width:f,height:p,points:b(a.data.features)||[]}):t.viewport),[s.autozoom,p,null==a||null==(o=a.data)?void 0:o.features,t.viewport,f]),k=y({onContextMenu:t.onContextMenu,filterState:t.filterState,setDataMask:t.setDataMask,setTooltip:i,onAddFilter:d,payload:a,formData:s,emitCrossFilters:t.emitCrossFilters});return(0,r.Y)(n.S,{ref:e,mapboxApiAccessToken:a.data.mapboxApiKey,viewport:C,layers:[k],mapStyle:s.mapbox_style,setControlValue:u,height:p,width:f})},w=(0,l.memo)(_)}}]);
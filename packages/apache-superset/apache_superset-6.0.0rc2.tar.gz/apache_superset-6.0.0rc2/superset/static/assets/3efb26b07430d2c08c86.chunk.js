"use strict";(globalThis.webpackChunksuperset=globalThis.webpackChunksuperset||[]).push([[4169],{6315:(e,t,a)=>{a.r(t),a.d(t,{default:()=>K});var d,i=a(2445),s=a(74098),l=a(50290),o=a(79378),n=a(99106),r=a(61225),c=a(96540),u=a(71519),h=a(58561),b=a.n(h),m=a(71323),g=a(86784),p=a(40105),y=a(54569),_=a(40815),f=a(38961),S=a(95018),w=a(94551),v=a(92998),T=a(89232),D=a(51304),F=a(20237),k=a(24777),Y=a(64457),C=a(8558),A=a(23314),H=a(79605),I=a(47068),P=a(57771),O=a(50154);!function(e){e.PUBLISHED="published",e.DRAFT="draft"}(d||(d={}));var z=a(90886),x=a(56879),B=a(66124);const M=(0,s.t)('The passwords for the databases below are needed in order to import them together with the dashboards. Please note that the "Secure Extra" and "Certificate" sections of the database configuration are not present in export files, and should be added manually after the import if they are needed.'),N=(0,s.t)("You are importing one or more dashboards that already exist. Overwriting might cause you to lose some of your work. Are you sure you want to overwrite?"),E=l.I4.div`
  color: ${({theme:e})=>e.colorIcon};
`,L=["id","dashboard_title","published","url","slug","changed_by","changed_by.id","changed_by.first_name","changed_by.last_name","changed_on_delta_humanized","owners","owners.id","owners.first_name","owners.last_name","tags.id","tags.name","tags.type","status","certified_by","certification_details","changed_on"],K=(0,Y.Ay)((function(e){var t;const{addDangerToast:a,addSuccessToast:l,user:h}=e,{roles:Y}=(0,r.d4)((e=>e.user)),K=(0,z.L)("can_read","Tag",Y),{state:{loading:R,resourceCount:G,resourceCollection:U,bulkSelectEnabled:j},setResourceCollection:J,hasPerm:W,fetchData:$,toggleBulkSelect:V,refreshData:q}=(0,g.RU)("dashboard",(0,s.t)("dashboard"),a,void 0,void 0,void 0,void 0,L),X=(0,c.useMemo)((()=>U.map((e=>e.id))),[U]),[Q,Z]=(0,g.oG)("dashboard",X,a),[ee,te]=(0,c.useState)(null),[ae,de]=(0,c.useState)(null),[ie,se]=(0,c.useState)(!1),[le,oe]=(0,c.useState)([]),[ne,re]=(0,c.useState)(!1),[ce,ue]=(0,c.useState)([]),[he,be]=(0,c.useState)([]),[me,ge]=(0,c.useState)([]),pe=(0,k.SX)(null==h||null==(t=h.userId)?void 0:t.toString(),null),ye=W("can_write"),_e=W("can_write"),fe=W("can_write"),Se=W("can_export"),we=[{id:"changed_on_delta_humanized",desc:!0}];function ve(e){te(e)}function Te(e){return o.A.get({endpoint:`/api/v1/dashboard/${e.id}`}).then((({json:e={}})=>{J(U.map((t=>{var a;if(t.id===(null==e||null==(a=e.result)?void 0:a.id)){const{changed_by_name:a,changed_by:d,dashboard_title:i="",slug:s="",json_metadata:l="",changed_on_delta_humanized:o,url:n="",certified_by:r="",certification_details:c="",owners:u,tags:h}=e.result;return{...t,changed_by_name:a,changed_by:d,dashboard_title:i,slug:s,json_metadata:l,changed_on_delta_humanized:o,url:n,certified_by:r,certification_details:c,owners:u,tags:h}}return t})))}),(0,m.JF)((e=>a((0,s.t)("An error occurred while fetching dashboards: %s",e)))))}const De=e=>{const t=e.map((({id:e})=>e));(0,D.A)("dashboard",t,(()=>{re(!1)})),re(!0)},Fe=(0,c.useMemo)((()=>[{Cell:({row:{original:{id:e}}})=>(null==h?void 0:h.userId)&&(0,i.Y)(p.$,{itemId:e,saveFaveStar:Q,isStarred:Z[e]}),Header:"",id:"id",disableSortBy:!0,size:"xs",hidden:!(null!=h&&h.userId)},{Cell:({row:{original:{url:e,dashboard_title:t,certified_by:a,certification_details:d}}})=>(0,i.FD)(u.N_,{to:e,title:t,children:[a&&(0,i.FD)(i.FK,{children:[(0,i.Y)(y.T,{certifiedBy:a,details:d})," "]}),t]}),Header:(0,s.t)("Name"),accessor:"dashboard_title",id:"dashboard_title"},{Cell:({row:{original:{status:e}}})=>(0,i.Y)(_.x,{isPublished:e===d.PUBLISHED}),Header:(0,s.t)("Status"),accessor:"published",size:"sm",id:"published",className:"no-ellipsis"},{Cell:({row:{original:{tags:e=[]}}})=>(0,i.Y)(T.Sk,{tags:e.filter((e=>"TagTypes.custom"===e.type||e.type===I.U.Custom)),maxTags:3}),Header:(0,s.t)("Tags"),accessor:"tags",disableSortBy:!0,hidden:!(0,n.G7)(n.TO.TaggingSystem),id:"tags"},{Cell:({row:{original:{owners:e=[]}}})=>(0,i.Y)(T.WM,{users:e}),Header:(0,s.t)("Owners"),accessor:"owners",disableSortBy:!0,id:"owners"},{Cell:({row:{original:{changed_on_delta_humanized:e,changed_by:t}}})=>(0,i.Y)(T.UW,{date:e,user:t}),Header:(0,s.t)("Last modified"),accessor:"changed_on_delta_humanized",id:"changed_on_delta_humanized"},{Cell:({row:{original:e}})=>(0,i.FD)(E,{className:"actions",children:[fe&&(0,i.Y)(f.h,{title:(0,s.t)("Please confirm"),description:(0,i.FD)(i.FK,{children:[(0,s.t)("Are you sure you want to delete")," ",(0,i.Y)("b",{children:e.dashboard_title}),"?"]}),onConfirm:()=>(0,m.yT)(e,q,l,a),children:e=>(0,i.Y)(S.m,{id:"delete-action-tooltip",title:(0,s.t)("Delete"),placement:"bottom",children:(0,i.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:e,children:(0,i.Y)(C.F.DeleteOutlined,{iconSize:"l"})})})}),Se&&(0,i.Y)(S.m,{id:"export-action-tooltip",title:(0,s.t)("Export"),placement:"bottom",children:(0,i.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>De([e]),children:(0,i.Y)(C.F.UploadOutlined,{iconSize:"l"})})}),_e&&(0,i.Y)(S.m,{id:"edit-action-tooltip",title:(0,s.t)("Edit"),placement:"bottom",children:(0,i.Y)("span",{role:"button",tabIndex:0,className:"action-button",onClick:()=>ve(e),children:(0,i.Y)(C.F.EditOutlined,{iconSize:"l"})})})]}),Header:(0,s.t)("Actions"),id:"actions",hidden:!_e&&!fe&&!Se,disableSortBy:!0},{accessor:H.H.ChangedBy,hidden:!0,id:H.H.ChangedBy}]),[null==h?void 0:h.userId,_e,fe,Se,Q,Z,q,l,a]),ke=(0,c.useMemo)((()=>({Header:(0,s.t)("Favorite"),key:"favorite",id:"id",urlDisplay:"favorite",input:"select",operator:T.c0.DashboardIsFav,unfilteredLabel:(0,s.t)("Any"),selects:[{label:(0,s.t)("Yes"),value:!0},{label:(0,s.t)("No"),value:!1}]})),[]),Ye=(0,c.useMemo)((()=>[{Header:(0,s.t)("Name"),key:"search",id:"dashboard_title",input:"search",operator:T.c0.TitleOrSlug},{Header:(0,s.t)("Status"),key:"published",id:"published",input:"select",operator:T.c0.Equals,unfilteredLabel:(0,s.t)("Any"),selects:[{label:(0,s.t)("Published"),value:!0},{label:(0,s.t)("Draft"),value:!1}]},...(0,n.G7)(n.TO.TaggingSystem)&&K?[{Header:(0,s.t)("Tag"),key:"tags",id:"tags",input:"select",operator:T.c0.DashboardTagById,unfilteredLabel:(0,s.t)("All"),fetchSelects:P.m}]:[],{Header:(0,s.t)("Owner"),key:"owner",id:"owners",input:"select",operator:T.c0.RelationManyMany,unfilteredLabel:(0,s.t)("All"),fetchSelects:(0,m.u1)("dashboard","owners",(0,m.JF)((e=>a((0,s.t)("An error occurred while fetching dashboard owner values: %s",e)))),e.user),paginate:!0,dropdownStyle:{minWidth:B.f8}},...null!=h&&h.userId?[ke]:[],{Header:(0,s.t)("Certified"),key:"certified",id:"id",urlDisplay:"certified",input:"select",operator:T.c0.DashboardIsCertified,unfilteredLabel:(0,s.t)("Any"),selects:[{label:(0,s.t)("Yes"),value:!0},{label:(0,s.t)("No"),value:!1}]},{Header:(0,s.t)("Modified by"),key:"changed_by",id:"changed_by",input:"select",operator:T.c0.RelationOneMany,unfilteredLabel:(0,s.t)("All"),fetchSelects:(0,m.u1)("dashboard","changed_by",(0,m.JF)((e=>(0,s.t)("An error occurred while fetching dataset datasource values: %s",e))),h),paginate:!0,dropdownStyle:{minWidth:B.f8}}]),[a,ke,e.user]),Ce=[{desc:!1,id:"dashboard_title",label:(0,s.t)("Alphabetical"),value:"alphabetical"},{desc:!0,id:"changed_on_delta_humanized",label:(0,s.t)("Recently modified"),value:"recently_modified"},{desc:!1,id:"changed_on_delta_humanized",label:(0,s.t)("Least recently modified"),value:"least_recently_modified"}],Ae=(0,c.useCallback)((e=>(0,i.Y)(O.A,{dashboard:e,hasPerm:W,bulkSelectEnabled:j,showThumbnails:pe?pe.thumbnails:(0,n.G7)(n.TO.Thumbnails),userId:null==h?void 0:h.userId,loading:R,openDashboardEditModal:ve,saveFavoriteStatus:Q,favoriteStatus:Z[e.id],handleBulkDashboardExport:De,onDelete:e=>de(e)})),[j,Z,W,R,null==h?void 0:h.userId,Q,pe]),He=[];return ye&&He.push({name:(0,i.Y)(S.m,{id:"import-tooltip",title:(0,s.t)("Import dashboards"),placement:"bottomRight",children:(0,i.Y)(C.F.DownloadOutlined,{iconSize:"l"})}),buttonStyle:"link",onClick:()=>{se(!0)}}),(fe||Se)&&He.push({name:(0,s.t)("Bulk select"),buttonStyle:"secondary",onClick:V}),ye&&He.push({icon:(0,i.Y)(C.F.PlusOutlined,{iconSize:"m"}),name:(0,s.t)("Dashboard"),buttonStyle:"primary",onClick:()=>{(0,x.V)("/dashboard/new",{assign:!0})}}),(0,i.FD)(i.FK,{children:[(0,i.Y)(F.A,{name:(0,s.t)("Dashboards"),buttons:He}),(0,i.Y)(f.h,{title:(0,s.t)("Please confirm"),description:(0,s.t)("Are you sure you want to delete the selected dashboards?"),onConfirm:function(e){return o.A.delete({endpoint:`/api/v1/dashboard/?q=${b().encode(e.map((({id:e})=>e)))}`}).then((({json:e={}})=>{q(),l(e.message)}),(0,m.JF)((e=>a((0,s.t)("There was an issue deleting the selected dashboards: ",e)))))},children:e=>{const t=(0,n.G7)(n.TO.TaggingSystem),d=[];return fe&&d.push({key:"delete",name:(0,s.t)("Delete"),type:"danger",onSelect:e}),Se&&d.push({key:"export",name:(0,s.t)("Export"),type:"primary",onSelect:De}),(0,i.FD)(i.FK,{children:[ee&&(0,i.Y)(A.A,{dashboardId:ee.id,show:!0,onHide:()=>te(null),onSubmit:Te}),ae&&(0,i.Y)(w.T,{description:(0,i.FD)(i.FK,{children:[(0,s.t)("Are you sure you want to delete")," ",(0,i.Y)("b",{children:ae.dashboard_title}),"?"]}),onConfirm:()=>{(0,m.yT)(ae,q,l,a,void 0,null==h?void 0:h.userId),de(null)},onHide:()=>de(null),open:!!ae,title:(0,s.t)("Please confirm")}),(0,i.Y)(T.uO,{bulkActions:d,bulkSelectEnabled:j,cardSortSelectOptions:Ce,className:"dashboard-list-view",columns:Fe,count:G,data:U,disableBulkSelect:V,fetchData:$,refreshData:q,filters:Ye,initialSort:we,loading:R,pageSize:25,addSuccessToast:l,addDangerToast:a,showThumbnails:pe?pe.thumbnails:(0,n.G7)(n.TO.Thumbnails),renderCard:Ae,defaultViewMode:(0,n.G7)(n.TO.ListviewsDefaultCardView)?"card":"table",enableBulkTag:t,bulkTagResourceName:"dashboard"})]})}}),(0,i.Y)(T.zb,{resourceName:"dashboard",resourceLabel:(0,s.t)("dashboard"),passwordsNeededMessage:M,confirmOverwriteMessage:N,addDangerToast:a,addSuccessToast:l,onModelImport:()=>{se(!1),q(),l((0,s.t)("Dashboard imported"))},show:ie,onHide:()=>{se(!1)},passwordFields:le,setPasswordFields:oe,sshTunnelPasswordFields:ce,setSSHTunnelPasswordFields:ue,sshTunnelPrivateKeyFields:he,setSSHTunnelPrivateKeyFields:be,sshTunnelPrivateKeyPasswordFields:me,setSSHTunnelPrivateKeyPasswordFields:ge}),ne&&(0,i.Y)(v.R,{})]})}))}}]);
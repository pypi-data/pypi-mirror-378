Metadata-Version: 2.4
Name: hertz_studio_captcha
Version: 1.0.3.4
Summary: ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„DjangoéªŒè¯ç åº”ç”¨
Home-page: http://hzgit.hzsystems.cn/hertz_studio/hertz_server_django
Author: yang kunhao
Author-email: 563161210@qq.com
License: MIT
Project-URL: Bug Reports, http://hzgit.hzsystems.cn/hertz_studio/hertz_server_django/issues
Project-URL: Source, http://hzgit.hzsystems.cn/hertz_studio/hertz_server_django
Project-URL: Documentation, http://hzgit.hzsystems.cn/hertz_studio/hertz_server_django#readme
Keywords: django captcha verification security
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Operating System :: OS Independent
Classifier: Framework :: Django
Classifier: Framework :: Django :: 3.0
Classifier: Framework :: Django :: 3.1
Classifier: Framework :: Django :: 3.2
Classifier: Framework :: Django :: 4.0
Classifier: Framework :: Django :: 4.1
Classifier: Framework :: Django :: 4.2
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Internet :: WWW/HTTP
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
License-File: LICENSE_SETUP.md
Requires-Dist: Django>=5.0
Requires-Dist: Pillow>=10.0.0
Requires-Dist: redis>=5.0
Requires-Dist: django-redis>=5.0
Requires-Dist: requests>=2.25.0
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: keywords
Dynamic: license
Dynamic: license-file
Dynamic: project-url
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# Hertz System Captcha

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„DjangoéªŒè¯ç åº”ç”¨ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„éªŒè¯ç ç”Ÿæˆã€éªŒè¯å’Œåˆ·æ–°åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ–¼ï¸ **éªŒè¯ç å›¾ç‰‡ç”Ÿæˆ** - æ”¯æŒè‡ªå®šä¹‰å°ºå¯¸ã€é¢œè‰²ã€å­—ä½“
- ğŸ”’ **å®‰å…¨æ€§å¼º** - è‡ªåŠ¨è¿‡æ»¤æ˜“æ··æ·†å­—ç¬¦ï¼Œæ·»åŠ å™ªå£°å¹²æ‰°
- ğŸš€ **é«˜æ€§èƒ½** - æ”¯æŒRedisç¼“å­˜ï¼Œæå‡å“åº”é€Ÿåº¦
- âš™ï¸ **é«˜åº¦å¯é…ç½®** - çµæ´»çš„é…ç½®é€‰é¡¹ï¼Œé€‚é…ä¸åŒéœ€æ±‚
- ğŸ“± **RESTful API** - æä¾›å®Œæ•´çš„APIæ¥å£
- ğŸ”„ **è‡ªåŠ¨è¿‡æœŸ** - éªŒè¯ç è‡ªåŠ¨è¿‡æœŸæœºåˆ¶
- ğŸ¨ **ç¾è§‚ç•Œé¢** - æ”¯æŒå¤šç§å­—ä½“å’Œé¢œè‰²é…ç½®

## å®‰è£…

### ä½¿ç”¨pipå®‰è£…ï¼ˆæ¨èï¼‰

**æ³¨æ„ï¼šæœ¬è½¯ä»¶éœ€è¦æœºå™¨ç éªŒè¯æ‰èƒ½å®‰è£…ã€‚**

#### å®‰è£…æµç¨‹

```bash
pip install hertz-system-captcha
```

å®‰è£…è¿‡ç¨‹ä¸­ä¼šï¼š
1. è‡ªåŠ¨è·å–æ‚¨çš„æœºå™¨ç 
2. éªŒè¯æœºå™¨ç æ˜¯å¦å·²æ³¨å†Œ
3. å¦‚æœæœªæ³¨å†Œï¼Œä¼šæç¤ºæ‚¨å¡«å†™æ³¨å†Œä¿¡æ¯
4. è‡ªåŠ¨å®Œæˆæœºå™¨ç æ³¨å†Œ

### æ‰‹åŠ¨å®‰è£…

1. ä¸‹è½½æºç 
2. è¿›å…¥é¡¹ç›®ç›®å½•
3. è¿è¡Œå®‰è£…å‘½ä»¤ï¼š

```bash
python setup.py install
```

### æœºå™¨ç éªŒè¯è¯´æ˜

æœ¬è½¯ä»¶ä½¿ç”¨æœºå™¨ç éªŒè¯ç³»ç»Ÿï¼Œç¡®ä¿è½¯ä»¶çš„æ­£ç‰ˆä½¿ç”¨ï¼š

- **æœºå™¨ç ç”Ÿæˆ**ï¼šåŸºäºæ‚¨çš„ç¡¬ä»¶ä¿¡æ¯ï¼ˆCPUã€MACåœ°å€ã€ç³»ç»Ÿä¿¡æ¯ç­‰ï¼‰ç”Ÿæˆå”¯ä¸€æœºå™¨ç 
- **æœåŠ¡å™¨éªŒè¯**ï¼šæœºå™¨ç éœ€è¦å…ˆåœ¨æœåŠ¡å™¨æ³¨å†Œæ‰èƒ½å®‰è£…
- **è‡ªåŠ¨æ³¨å†Œ**ï¼šé¦–æ¬¡å®‰è£…æ—¶ä¼šè‡ªåŠ¨å¼•å¯¼æ‚¨å®Œæˆæ³¨å†Œ
- **æœ¬åœ°ç¼“å­˜**ï¼šæ³¨å†Œä¿¡æ¯ä¼šä¿å­˜åœ¨æœ¬åœ°ï¼Œé¿å…é‡å¤æ³¨å†Œ

### è·å–å®‰è£…æƒé™

å¦‚æœé‡åˆ°å®‰è£…é—®é¢˜ï¼Œè¯·è”ç³»ä½œè€…ï¼š
- **ä½œè€…**ï¼šæ¨å¤è±ª (yang kunhao)
- **é‚®ç®±**ï¼š563161210@qq.com
- **é¡¹ç›®åœ°å€**ï¼šhttp://hzgit.hzsystems.cn/hertz_studio/hertz_server_django

## é…ç½®

### 1. åœ¨Djangoé¡¹ç›®ä¸­æ³¨å†Œåº”ç”¨

åœ¨ `settings.py` çš„ `INSTALLED_APPS` ä¸­æ·»åŠ ï¼š

```python
INSTALLED_APPS = [
    # ... å…¶ä»–åº”ç”¨
    'hertz_system_captcha',
]
```

### 2. é…ç½®URLè·¯ç”±

åœ¨ä¸»é¡¹ç›®çš„ `urls.py` ä¸­æ·»åŠ ï¼š

```python
from django.urls import include

urlpatterns = [
    # ... å…¶ä»–URLé…ç½®
    path('captcha/', include('hertz_system_captcha.urls')),
]
```

### 3. é…ç½®ç¼“å­˜ï¼ˆå¯é€‰ä½†æ¨èï¼‰

ä¸ºäº†è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œå»ºè®®é…ç½®Redisç¼“å­˜ï¼š

```python
CACHES = {
    'default': {
        'BACKEND': 'django_redis.cache.RedisCache',
        'LOCATION': 'redis://127.0.0.1:6379/1',
        'OPTIONS': {
            'CLIENT_CLASS': 'django_redis.client.DefaultClient',
        }
    }
}
```

### 4. éªŒè¯ç é…ç½®é€‰é¡¹

åœ¨ `settings.py` ä¸­å¯ä»¥é…ç½®ä»¥ä¸‹é€‰é¡¹ï¼š

```python
# éªŒè¯ç é•¿åº¦ï¼ˆé»˜è®¤ï¼š4ï¼‰
HERTZ_CAPTCHA_LENGTH = 4

# éªŒè¯ç å›¾ç‰‡å®½åº¦ï¼ˆé»˜è®¤ï¼š120ï¼‰
HERTZ_CAPTCHA_WIDTH = 120

# éªŒè¯ç å›¾ç‰‡é«˜åº¦ï¼ˆé»˜è®¤ï¼š50ï¼‰
HERTZ_CAPTCHA_HEIGHT = 50

# éªŒè¯ç å­—ä½“å¤§å°ï¼ˆé»˜è®¤ï¼š30ï¼‰
HERTZ_CAPTCHA_FONT_SIZE = 30

# éªŒè¯ç è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼Œé»˜è®¤ï¼š300ï¼‰
HERTZ_CAPTCHA_TIMEOUT = 300

# èƒŒæ™¯é¢œè‰²ï¼ˆé»˜è®¤ï¼š#ffffffï¼‰
HERTZ_CAPTCHA_BACKGROUND_COLOR = '#ffffff'

# æ–‡å­—é¢œè‰²ï¼ˆé»˜è®¤ï¼š#000000ï¼‰
HERTZ_CAPTCHA_FOREGROUND_COLOR = '#000000'

# å™ªå£°çº§åˆ«ï¼ˆé»˜è®¤ï¼š0.3ï¼‰
HERTZ_CAPTCHA_NOISE_LEVEL = 0.3

# Redisé”®å‰ç¼€ï¼ˆé»˜è®¤ï¼šhertz_captcha:ï¼‰
HERTZ_CAPTCHA_REDIS_KEY_PREFIX = 'hertz_captcha:'
```

## APIä½¿ç”¨

### ç”ŸæˆéªŒè¯ç 

```python
from hertz_system_captcha.captcha_generator import HertzCaptchaGenerator

generator = HertzCaptchaGenerator()
captcha_data = generator.generate_captcha()

# è¿”å›æ•°æ®æ ¼å¼ï¼š
{
    'captcha_id': 'uuid-string',
    'image_data': 'data:image/png;base64,base64-string',
    'expires_in': 300
}
```

### éªŒè¯éªŒè¯ç 

```python
is_valid = generator.verify_captcha(captcha_id, user_input)
```

### åˆ·æ–°éªŒè¯ç 

```python
new_captcha_data = generator.refresh_captcha(old_captcha_id)
```

## REST APIæ¥å£

### ç”ŸæˆéªŒè¯ç 

```
GET /captcha/generate/
```

å“åº”ï¼š
```json
{
    "captcha_id": "123e4567-e89b-12d3-a456-426614174000",
    "image_data": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA...",
    "expires_in": 300
}
```

### éªŒè¯éªŒè¯ç 

```
POST /captcha/verify/
```

è¯·æ±‚ä½“ï¼š
```json
{
    "captcha_id": "123e4567-e89b-12d3-a456-426614174000",
    "code": "ABCD"
}
```

å“åº”ï¼š
```json
{
    "valid": true,
    "message": "éªŒè¯ç éªŒè¯æˆåŠŸ"
}
```

### åˆ·æ–°éªŒè¯ç 

```
POST /captcha/refresh/
```

è¯·æ±‚ä½“ï¼š
```json
{
    "captcha_id": "123e4567-e89b-12d3-a456-426614174000"
}
```

å“åº”ï¼š
```json
{
    "captcha_id": "123e4567-e89b-12d3-a456-426614174001",
    "image_data": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA...",
    "expires_in": 300
}
```

## ä½¿ç”¨ç¤ºä¾‹

### å‰ç«¯é›†æˆç¤ºä¾‹

```html
<!DOCTYPE html>
<html>
<head>
    <title>éªŒè¯ç ç¤ºä¾‹</title>
</head>
<body>
    <div id="captcha-container">
        <img id="captcha-image" src="" alt="éªŒè¯ç ">
        <input type="text" id="captcha-input" placeholder="è¯·è¾“å…¥éªŒè¯ç ">
        <button onclick="verifyCaptcha()">éªŒè¯</button>
        <button onclick="refreshCaptcha()">åˆ·æ–°</button>
    </div>

    <script>
        let currentCaptchaId = null;

        // ç”ŸæˆéªŒè¯ç 
        function generateCaptcha() {
            fetch('/captcha/generate/')
                .then(response => response.json())
                .then(data => {
                    currentCaptchaId = data.captcha_id;
                    document.getElementById('captcha-image').src = data.image_data;
                });
        }

        // éªŒè¯éªŒè¯ç 
        function verifyCaptcha() {
            const userInput = document.getElementById('captcha-input').value;
            fetch('/captcha/verify/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    captcha_id: currentCaptchaId,
                    code: userInput
                })
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
                if (data.valid) {
                    // éªŒè¯æˆåŠŸï¼Œæ‰§è¡Œåç»­æ“ä½œ
                } else {
                    // éªŒè¯å¤±è´¥ï¼Œåˆ·æ–°éªŒè¯ç 
                    generateCaptcha();
                }
            });
        }

        // åˆ·æ–°éªŒè¯ç 
        function refreshCaptcha() {
            generateCaptcha();
        }

        // é¡µé¢åŠ è½½æ—¶ç”ŸæˆéªŒè¯ç 
        window.onload = generateCaptcha;
    </script>
</body>
</html>
```

## ä¾èµ–è¦æ±‚

- Python >= 3.7
- Django >= 3.0
- Pillow >= 8.0.0
- redis >= 4.0.0 (å¯é€‰ï¼Œç”¨äºRedisç¼“å­˜)

## è®¸å¯è¯

MIT License

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ã€‚

## ä½œè€…

**æ¨å¤è±ª** (yang kunhao)  
é‚®ç®±ï¼š563161210@qq.com  
é¡¹ç›®åœ°å€ï¼šhttp://hzgit.hzsystems.cn/hertz_studio/hertz_server_django

## è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºè¿™ä¸ªé¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ï¼

## æ›´æ–°æ—¥å¿—

### v1.0.2
- ä¼˜åŒ–éªŒè¯ç ç”Ÿæˆç®—æ³•
- æ”¹è¿›Redisç¼“å­˜æœºåˆ¶
- å¢å¼ºé”™è¯¯å¤„ç†
- å®Œå–„æ–‡æ¡£è¯´æ˜

### v1.0.1
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- åŸºç¡€éªŒè¯ç åŠŸèƒ½
- Redisç¼“å­˜æ”¯æŒ
- REST APIæ¥å£

Metadata-Version: 2.4
Name: hertz_studio_django_captcha
Version: 1.0.2
Summary: ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„DjangoéªŒè¯ç åº”ç”¨
Home-page: http://hzgit.hzsystems.cn/hertz_studio_django/hertz_studio_django_captcha
Author: yang kunhao
Author-email: 563161210@qq.com
License: MIT
Project-URL: Bug Reports, http://hzgit.hzsystems.cn/hertz_studio_django/hertz_studio_django_captcha/issues
Project-URL: Source, http://hzgit.hzsystems.cn/hertz_studio_django/hertz_studio_django_captcha
Project-URL: Documentation, http://hzgit.hzsystems.cn/hertz_studio_django/hertz_studio_django_captcha#readme
Keywords: django captcha verification security
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Operating System :: OS Independent
Classifier: Framework :: Django
Classifier: Framework :: Django :: 3.0
Classifier: Framework :: Django :: 3.1
Classifier: Framework :: Django :: 3.2
Classifier: Framework :: Django :: 4.0
Classifier: Framework :: Django :: 4.1
Classifier: Framework :: Django :: 4.2
Classifier: Programming Language :: Python
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.7
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Topic :: Internet :: WWW/HTTP
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.10
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: Django>=5.0
Requires-Dist: Pillow>=10.0.0
Requires-Dist: redis>=5.0
Requires-Dist: django-redis>=5.0
Requires-Dist: requests>=2.25.0
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: keywords
Dynamic: license
Dynamic: license-file
Dynamic: project-url
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# Hertz Studio Djngo Captcha

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„DjangoéªŒè¯ç åº”ç”¨ï¼Œæä¾›å¤šç§éªŒè¯ç ç±»å‹å’Œçµæ´»çš„é…ç½®é€‰é¡¹ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ¨ **å¤šç§éªŒè¯ç ç±»å‹**ï¼šæ”¯æŒæ•°å­—ã€å­—æ¯ã€æ··åˆéªŒè¯ç 
- ğŸ”§ **é«˜åº¦å¯é…ç½®**ï¼šéªŒè¯ç é•¿åº¦ã€å­—ä½“ã€é¢œè‰²ã€å¹²æ‰°çº¿ç­‰å‡å¯è‡ªå®šä¹‰
- ğŸš€ **é«˜æ€§èƒ½**ï¼šæ”¯æŒRedisç¼“å­˜ï¼Œæå‡éªŒè¯ç ç”Ÿæˆå’ŒéªŒè¯æ•ˆç‡
- ğŸ›¡ï¸ **å®‰å…¨å¯é **ï¼šå†…ç½®é˜²æš´åŠ›ç ´è§£æœºåˆ¶ï¼Œæ”¯æŒéªŒè¯ç è¿‡æœŸæ—¶é—´è®¾ç½®
- ğŸ“± **å“åº”å¼è®¾è®¡**ï¼šé€‚é…å„ç§å±å¹•å°ºå¯¸
- ğŸ”Œ **æ˜“äºé›†æˆ**ï¼šç®€å•çš„APIæ¥å£ï¼Œå¿«é€Ÿé›†æˆåˆ°ç°æœ‰Djangoé¡¹ç›®

## å®‰è£…

### ä½¿ç”¨pipå®‰è£…

```bash
pip install hertz-studio-django-captcha
```
## å¿«é€Ÿå¼€å§‹

### 1. æ·»åŠ åˆ°Djangoè®¾ç½®

åœ¨ä½ çš„Djangoé¡¹ç›®çš„ `settings.py` æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```python
INSTALLED_APPS = [
    # ... å…¶ä»–åº”ç”¨
    'hertz_studio_django_captcha',
]

# éªŒè¯ç é…ç½®ï¼ˆå¯é€‰ï¼‰
HERTZ_CAPTCHA_SETTINGS = {
    'CAPTCHA_LENGTH': 4,  # éªŒè¯ç é•¿åº¦
    'CAPTCHA_TIMEOUT': 300,  # éªŒè¯ç è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰
    'CAPTCHA_WIDTH': 120,  # éªŒè¯ç å›¾ç‰‡å®½åº¦
    'CAPTCHA_HEIGHT': 40,  # éªŒè¯ç å›¾ç‰‡é«˜åº¦
    'CAPTCHA_FONT_SIZE': 24,  # å­—ä½“å¤§å°
    'USE_REDIS': True,  # æ˜¯å¦ä½¿ç”¨Redisç¼“å­˜
}

# Redisé…ç½®ï¼ˆå¦‚æœå¯ç”¨Redisï¼‰
CACHES = {
    'default': {
        'BACKEND': 'django_redis.cache.RedisCache',
        'LOCATION': 'redis://127.0.0.1:6379/1',
        'OPTIONS': {
            'CLIENT_CLASS': 'django_redis.client.DefaultClient',
        }
    }
}
```

### 2. é…ç½®URLè·¯ç”±

åœ¨ä½ çš„é¡¹ç›®çš„ `urls.py` æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```python
from django.urls import path, include

urlpatterns = [
    # ... å…¶ä»–URLé…ç½®
    path('captcha/', include('hertz_studio_django_captcha.urls')),
]
```

### 3. è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
python manage.py migrate
```

### 4. åœ¨æ¨¡æ¿ä¸­ä½¿ç”¨

```html
<!-- åœ¨ä½ çš„HTMLæ¨¡æ¿ä¸­ -->
<form method="post">
    {% csrf_token %}
    
    <!-- éªŒè¯ç å›¾ç‰‡ -->
    <img src="{% url 'hertz_captcha:captcha_image' %}" alt="éªŒè¯ç " id="captcha-image">
    
    <!-- åˆ·æ–°éªŒè¯ç æŒ‰é’® -->
    <button type="button" onclick="refreshCaptcha()">åˆ·æ–°éªŒè¯ç </button>
    
    <!-- éªŒè¯ç è¾“å…¥æ¡† -->
    <input type="text" name="captcha" placeholder="è¯·è¾“å…¥éªŒè¯ç " required>
    
    <button type="submit">æäº¤</button>
</form>

<script>
function refreshCaptcha() {
    document.getElementById('captcha-image').src = 
        "{% url 'hertz_captcha:captcha_image' %}?" + Math.random();
}
</script>
```

### 5. åœ¨è§†å›¾ä¸­éªŒè¯

```python
from django.shortcuts import render
from django.http import JsonResponse
from hertz_studio_django_captcha.captcha_generator import HertzCaptchaGenerator


def my_view(request):
    if request.method == 'POST':
        captcha_input = request.POST.get('captcha')
        captcha_generator = HertzCaptchaGenerator()

        if captcha_generator.verify_captcha(request, captcha_input):
            # éªŒè¯ç æ­£ç¡®
            return JsonResponse({'success': True, 'message': 'éªŒè¯æˆåŠŸ'})
        else:
            # éªŒè¯ç é”™è¯¯
            return JsonResponse({'success': False, 'message': 'éªŒè¯ç é”™è¯¯'})

    return render(request, 'my_template.html')
```

## APIæ¥å£

### è·å–éªŒè¯ç å›¾ç‰‡

```
GET /captcha/image/
```

è¿”å›éªŒè¯ç å›¾ç‰‡ï¼ŒåŒæ—¶åœ¨sessionä¸­ä¿å­˜éªŒè¯ç å€¼ã€‚

### éªŒè¯éªŒè¯ç 

```python
from hertz_studio_django_captcha.captcha_generator import HertzCaptchaGenerator

generator = HertzCaptchaGenerator()
is_valid = generator.verify_captcha(request, user_input)
```

## é…ç½®é€‰é¡¹

| é…ç½®é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `CAPTCHA_LENGTH` | 4 | éªŒè¯ç é•¿åº¦ |
| `CAPTCHA_TIMEOUT` | 300 | éªŒè¯ç è¿‡æœŸæ—¶é—´ï¼ˆç§’ï¼‰ |
| `CAPTCHA_WIDTH` | 120 | éªŒè¯ç å›¾ç‰‡å®½åº¦ |
| `CAPTCHA_HEIGHT` | 40 | éªŒè¯ç å›¾ç‰‡é«˜åº¦ |
| `CAPTCHA_FONT_SIZE` | 24 | å­—ä½“å¤§å° |
| `USE_REDIS` | False | æ˜¯å¦ä½¿ç”¨Redisç¼“å­˜ |
| `CAPTCHA_CHARS` | '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ' | éªŒè¯ç å­—ç¬¦é›† |

## ä¾èµ–è¦æ±‚

- Django >= 5.0
- Pillow >= 10.0.0
- redis >= 5.0 (å¯é€‰ï¼Œç”¨äºç¼“å­˜)
- django-redis >= 5.0 (å¯é€‰ï¼Œç”¨äºRedisé›†æˆ)

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦æƒ…è¯·å‚é˜… [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## ä½œè€…

- **Yang Kunhao** - [563161210@qq.com](mailto:563161210@qq.com)

## é¡¹ç›®é“¾æ¥

- **æºç ä»“åº“**: [http://hzgit.hzsystems.cn/hertz_studio_django/hertz_studio_django_captcha](http://hzgit.hzsystems.cn/hertz_studio_django/hertz_studio_django_captcha)
- **é—®é¢˜åé¦ˆ**: [http://hzgit.hzsystems.cn/hertz_studio_django/hertz_studio_django_captcha/issues](http://hzgit.hzsystems.cn/hertz_studio_django/hertz_studio_django_captcha/issues)

## æ”¯æŒ

å¦‚æœä½ åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»æˆ‘ä»¬ï¼š

- é‚®ç®±ï¼š563161210@qq.com
- é¡¹ç›®Issuesï¼š[æäº¤é—®é¢˜](http://hzgit.hzsystems.cn/hertz_studio_django/hertz_studio_django_captcha/issues)

---

**æ³¨æ„**: æœ¬è½¯ä»¶éœ€è¦æœºå™¨ç éªŒè¯æ‰èƒ½å®‰è£…ä½¿ç”¨ã€‚è¯·è”ç³»ä½œè€…è·å–å®‰è£…æƒé™ã€‚

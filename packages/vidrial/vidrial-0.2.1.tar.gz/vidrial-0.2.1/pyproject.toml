[project]
name = "vidrial"
version = "0.2.1"
description = "Library containing vidrial framework and associated kernels"
authors = [
    { name = "Carles Gelada", email = "carles@manifestai.com" },
    { name = "Sean Zhang", email = "sean@manifestai.com" },
    { name = "Jacob Buckman", email = "jacob@manifestai.com" },
]
requires-python = ">=3.11"
dependencies = [
    "torch>=2.0.0",
    "numpy>=2.2.0",
    "tabulate>=0.9.0",
    "tqdm>=4.67.1",
    "pyyaml>=6.0.2",
    "click>=8.1.3",
]

[build-system]
requires = [
    "setuptools>=61.0", 
    "wheel",
    "pytest>=8.3.2",
    "torch>=2.0.0",
    "numpy>=2.2.0",
    "tabulate>=0.9.0",
    "tqdm>=4.67.1",
    "pyyaml>=6.0.2",
    "click>=8.1.3",
]
build-backend = "setuptools.build_meta"

[tool.setuptools]
include-package-data = true

[tool.setuptools.package-data]
vidrial = [
    "*.cuh", 
    "*.cu", 
]

[tool.pytest.ini_options]
addopts = [
    "--import-mode=importlib", '--pyargs', 
]
pythonpath = [
    "."
]

python_files = "*.py"
python_functions = "test_*"
xfail_strict = true
filterwarnings = [
    "ignore::DeprecationWarning"
]

[tool.uv.sources]
flash-attn = { url = "https://github.com/Dao-AILab/flash-attention/releases/download/v2.7.2.post1/flash_attn-2.7.2.post1+cu12torch2.6cxx11abiFALSE-cp312-cp312-linux_x86_64.whl" }

[dependency-groups]
dev = [
    "bokeh>=3.7.2",
    "pytest>=8.3.2",
    "click>=8.1.3",
    "pytest-xdist>=3.6.1",
    "matplotlib>=3.10.3",
    "pandas>=2.2.3",
    "numpy>=2.2.4",
    "build>=1.2.2.post1",
    "wheel>=0.45.1",
    "flash-attn",
]


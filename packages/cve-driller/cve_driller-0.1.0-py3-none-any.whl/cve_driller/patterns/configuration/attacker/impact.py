
from ...common import (WEAKNESS_BEFORE_STOP_WORDS, WEAKNESS_PATTERN, CONFIGURATION_PATTERN, ATTACKER_PATTERN,
                     ATTACKER_BEFORE_STOP_WORDS, COMPONENT_PATTERN, COMPONENT_BEFORE_STOP_WORDS, IMPACT_PATTERN,
                     IMPACT_BEFORE_STOP_WORDS, VECTOR_PATTERN, VECTOR_BEFORE_STOP_WORDS, ROOT_CAUSE_PATTERN,
                     ROOT_CAUSE_BEFORE_STOP_WORD, CONFIGURATION_AFTER_STOP_WORDS)

# configuration attacker impact
CONFIG_ATTACKER_IMPACT_PATTERN = (r'(?:The |)' + CONFIGURATION_PATTERN + CONFIGURATION_AFTER_STOP_WORDS +
                                  ATTACKER_BEFORE_STOP_WORDS + ATTACKER_PATTERN + IMPACT_BEFORE_STOP_WORDS +
                                  IMPACT_PATTERN)

# configuration attacker impact root_cause vector
DETAILS_5_1 = (CONFIG_ATTACKER_IMPACT_PATTERN + ROOT_CAUSE_BEFORE_STOP_WORD + ROOT_CAUSE_PATTERN +
               VECTOR_BEFORE_STOP_WORDS + VECTOR_PATTERN + r'\.$')

# configuration attacker impact vector root_cause
DETAILS_4_1 = (CONFIG_ATTACKER_IMPACT_PATTERN + VECTOR_BEFORE_STOP_WORDS + VECTOR_PATTERN +
               ROOT_CAUSE_BEFORE_STOP_WORD + ROOT_CAUSE_PATTERN + r'\.$')

# configuration attacker impact root_cause
DETAILS_4_2 = CONFIG_ATTACKER_IMPACT_PATTERN + ROOT_CAUSE_BEFORE_STOP_WORD + ROOT_CAUSE_PATTERN + r'\.$'

CONFIG_ATTACKER_IMPACT_PATTERNS = {
    '5_1': DETAILS_5_1,
    '4_1': DETAILS_4_1,
    '4_2': DETAILS_4_2
}

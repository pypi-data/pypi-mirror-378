import{r as j,j as s}from"./@radix-CliVkFaa.js";import{R as g,u as b,a as v,b as y}from"./ButtonGroup-BzOTR0xq.js";import{$ as N,a0 as S,r as c,a1 as P,z as n,Q as p,R,U as k,V as C,W as T,X as u,T as x,a2 as _,B as w,Y as E,d as h}from"./index-DNZysKmJ.js";import{S as A}from"./pipeline-Brrp68D7.js";import{f as B,L as l,a as f}from"./@react-router-CYx8DMBZ.js";import{S as D}from"./refresh-dLBf1zWp.js";import{u as F}from"./all-pipeline-runs-query-DZSUrQe9.js";import{S as I}from"./SearchField-DHUbQmhu.js";import{P as U}from"./Pagination-CA90k9B9.js";import{S as z}from"./terminal-CUNhpht8.js";import{D as H}from"./DisplayDate-B-cVfXAH.js";import{g as L,E as $}from"./ExecutionStatus-xC5FTDSP.js";import"./trash-DEQyKF3P.js";import"./AlertDialogDropdownItem-pBdhxz44.js";import"./DeleteAlertDialog-wrcRBrCc.js";import"./zod-B4miPCh1.js";import"./index.esm-BcJnCn7I.js";import"./bulk-delete-DlibRcoZ.js";import"./@tanstack-IKWdbe7C.js";import"./delete-run-Bz6UohHy.js";import"./@reactflow-CiTrzm79.js";import"./index-C4h6InI4.js";import"./chevron-right-double-CoJGs9PO.js";import"./check-circle-DHmddCbA.js";import"./help-CBhziUAC.js";function G(e){const{setBreadcrumbs:t}=N();j.useEffect(()=>{e&&t([S,{label:e,href:c.projects.pipelines.namespace(e)}])},[t,e])}function q({namespace:e}){return s.jsx(P,{children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(A,{className:"h-5 w-5 fill-neutral-400"}),s.jsx("h1",{className:"text-display-xs font-semibold",children:decodeURIComponent(e)})]})})}const d=1,O=n.object({page:n.coerce.number().min(d).optional().default(d).catch(d),name:n.string().optional(),operator:n.enum(["and","or"]).optional()});function Q(){const[e]=B(),{page:t,name:a,operator:r}=O.parse({page:e.get("page")||void 0,name:e.get("name")||void 0});return{page:t,name:a,logical_operator:r}}function V(){return[{id:"select",meta:{width:"1%"},header:({table:e})=>s.jsx(p,{id:"check-all",checked:e.getIsAllRowsSelected(),onCheckedChange:t=>e.toggleAllRowsSelected(t==="indeterminate"?!0:t)}),cell:({row:e})=>s.jsx(p,{id:`check-${e.id}`,checked:e.getIsSelected(),onCheckedChange:e.getToggleSelectedHandler()})},{id:"run",header:"Run",accessorFn:e=>{var t;return{name:e.name,id:e.id,status:(t=e.body)==null?void 0:t.status}},cell:({getValue:e})=>{const{name:t,status:a,id:r}=e();return s.jsxs("div",{className:"group/copybutton flex items-center gap-2",children:[s.jsx(z,{className:`h-5 w-5 shrink-0 ${L(a)}`}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(l,{to:c.projects.runs.detail(r),className:"flex items-center gap-1",children:s.jsx("h2",{className:"text-text-md font-semibold",children:t})}),s.jsx(R,{children:s.jsxs(k,{children:[s.jsx(C,{className:"hover:text-theme-text-brand hover:underline",children:s.jsx($,{status:a})}),s.jsx(T,{className:"z-20 capitalize",children:a})]})}),s.jsx(u,{copyText:t})]}),s.jsxs(l,{to:c.projects.runs.detail(r),className:"flex items-center gap-1",children:[s.jsx("p",{className:"text-text-xs text-theme-text-secondary",children:r.split("-")[0]}),s.jsx(u,{copyText:r})]})]})]})}},{id:"stack",header:"Stack",accessorFn:e=>{var t,a,r,o;return{name:(a=(t=e.body)==null?void 0:t.stack)==null?void 0:a.name,id:(o=(r=e.body)==null?void 0:r.stack)==null?void 0:o.id}},cell:({getValue:e})=>{const{name:t,id:a}=e();return!t||!a?null:s.jsx(l,{to:c.stacks.overview,children:s.jsx(x,{rounded:!1,className:"inline-block",color:"turquoise",emphasis:"subtle",children:t})})}},{id:"repository",header:"Repository",accessorFn:e=>{var t,a,r,o,i,m;return{name:(r=(a=(t=e.body)==null?void 0:t.code_reference)==null?void 0:a.body)==null?void 0:r.code_repository.name,id:(m=(i=(o=e.body)==null?void 0:o.code_reference)==null?void 0:i.body)==null?void 0:m.code_repository.id}},cell:({getValue:e})=>{const{name:t,id:a}=e();return!t||!a?null:s.jsx("div",{children:s.jsx(x,{rounded:!1,className:"inline-block",color:"grey",emphasis:"subtle",children:t})})}},{id:"created",header:"Created at",accessorFn:e=>{var t;return(t=e.body)==null?void 0:t.created},cell:({getValue:e})=>s.jsx("p",{className:"text-text-sm text-theme-text-secondary",children:s.jsx(H,{dateString:e()})})},{id:"author",header:"Author",accessorFn:e=>{var t;return{author:(t=e.resources)==null?void 0:t.user}},cell:({getValue:e})=>{var a,r;const{author:t}=e();return s.jsx(_,{avatarUrl:((a=t.body)==null?void 0:a.avatar_url)??void 0,username:t.name,isServiceAccount:!!((r=t.body)!=null&&r.is_service_account)})}},{id:"admin_actions",header:"",meta:{width:"5%"},cell:({row:e})=>s.jsx(g,{id:e.original.id})}]}function W(){const{namespace:e}=f(),t=Q(),a=V(),{selectedRowCount:r}=b(),{data:o,refetch:i}=F({params:{pipeline_name:decodeURIComponent(e),...t,sort_by:"desc:updated"}},{throwOnError:!0});return s.jsxs("div",{className:"flex flex-col gap-5 p-5",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[r?s.jsx(v,{}):s.jsx(I,{searchParams:t}),s.jsxs(w,{intent:"primary",emphasis:"subtle",size:"md",onClick:()=>i(),children:[s.jsx(D,{className:"h-5 w-5 fill-theme-text-brand"}),"Refresh"]})]}),s.jsxs("div",{className:"flex flex-col items-center gap-5",children:[s.jsx("div",{className:"w-full",children:o?s.jsx(E,{columns:a,data:o.items}):s.jsx(h,{className:"h-[500px] w-full"})}),o?o.total_pages>1&&s.jsx(U,{searchParams:t,paginate:o}):s.jsx(h,{className:"h-[36px] w-[300px]"})]})]})}function be(){const{namespace:e}=f();return G(e),s.jsx("div",{children:s.jsxs(y,{children:[s.jsx(q,{namespace:e}),s.jsx(W,{})]})})}export{be as default};

[tox]
requires =
    tox>=4
    tox-uv>=1.25.0
envlist =
    {py310, py312}-sklearn{15}-np{126,22}-pd{20,22}
    py{310,311,312}

isolated_build = True

[testenv]
; basepython =
;     py39: /anaconda/envs/py39/bin/python
;     py310: python3.10
;     py311: /anaconda/envs/py311/bin/python
;     py312: /anaconda/envs/py312/bin/python
deps =
    pytest
    sklearn11: scikit-learn>=1.1,<1.6
    sklearn15: scikit-learn>=1.5,<1.6
    sklearn16: scikit-learn>=1.6,<1.7
    pd15: pandas>=1.5,<1.4
    pd20: pandas>=2.0,<2.1
    pd22: pandas>=2.2,<2.3
    np126: numpy>=1.26,<2.0
    np22: numpy>=2.2,<2.3
commands = pytest -v -s --tb=long

[testenv:py310-sklearn15]
skip_install = true
allowlist_externals = echo
commands = echo "This combination is incompatible and will be skipped"

[testenv:coverage]
runner = uv-venv-lock-runner
description = run coverage report
skip_install = true
allowlist_externals = uv
commands_pre =
    uv pip install -e ".[dev]"
commands = uv run pytest -v --cov=. --cov-report=xml --cov-report=html

{
  "project_path": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi",
  "scan_config": "ScanConfig",
  "timestamp": "2025-09-21T02:33:34.116552",
  "results": [
    {
      "tool": "bandit",
      "success": true,
      "issues": [
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 101,
          "column": 0,
          "rule": "B311",
          "message": "Standard pseudo-random generators are not suitable for security/cryptographic purposes.",
          "severity": "low",
          "confidence": "HIGH",
          "source": "bandit"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 102,
          "column": 0,
          "rule": "B608",
          "message": "Possible SQL injection vector through string-based query construction.",
          "severity": "medium",
          "confidence": "LOW",
          "source": "bandit"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 113,
          "column": 0,
          "rule": "B324",
          "message": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
          "severity": "high",
          "confidence": "HIGH",
          "source": "bandit"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 182,
          "column": 0,
          "rule": "B608",
          "message": "Possible SQL injection vector through string-based query construction.",
          "severity": "medium",
          "confidence": "LOW",
          "source": "bandit"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 187,
          "column": 0,
          "rule": "B324",
          "message": "Use of weak MD5 hash for security. Consider usedforsecurity=False",
          "severity": "high",
          "confidence": "HIGH",
          "source": "bandit"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 188,
          "column": 0,
          "rule": "B608",
          "message": "Possible SQL injection vector through string-based query construction.",
          "severity": "medium",
          "confidence": "LOW",
          "source": "bandit"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 231,
          "column": 0,
          "rule": "B608",
          "message": "Possible SQL injection vector through string-based query construction.",
          "severity": "medium",
          "confidence": "LOW",
          "source": "bandit"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 235,
          "column": 0,
          "rule": "B608",
          "message": "Possible SQL injection vector through string-based query construction.",
          "severity": "medium",
          "confidence": "LOW",
          "source": "bandit"
        }
      ],
      "errors": [],
      "execution_time": 0.30257317901123315,
      "metadata": {
        "total_lines_scanned": 1
      }
    },
    {
      "tool": "safety",
      "success": false,
      "issues": [],
      "errors": [],
      "execution_time": 1.2150011049816385,
      "metadata": {}
    },
    {
      "tool": "fastapi_security",
      "success": true,
      "issues": [
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 171,
          "column": 22,
          "rule": "nosql_injection",
          "message": "NoSQL injection vulnerability: User input passed to NoSQL query",
          "severity": "critical",
          "source": "fastapi_security",
          "owasp_mapping": [
            "A03:2021 - Injection"
          ],
          "cwe_id": "CWE-943",
          "remediation": "Sanitize and validate user inputs before database queries"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 177,
          "column": 0,
          "rule": "missing_auth",
          "message": "Endpoints missing authentication requirements: Endpoint root may lack authentication",
          "severity": "high",
          "source": "fastapi_security",
          "owasp_mapping": [
            "A07:2021 - Identification and Authentication Failures"
          ],
          "cwe_id": "CWE-306",
          "remediation": "Implement proper authentication for sensitive endpoints"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 239,
          "column": 0,
          "rule": "missing_auth",
          "message": "Endpoints missing authentication requirements: Endpoint reset_page may lack authentication",
          "severity": "high",
          "source": "fastapi_security",
          "owasp_mapping": [
            "A07:2021 - Identification and Authentication Failures"
          ],
          "cwe_id": "CWE-306",
          "remediation": "Implement proper authentication for sensitive endpoints"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 250,
          "column": 0,
          "rule": "missing_auth",
          "message": "Endpoints missing authentication requirements: Endpoint return_favicon may lack authentication",
          "severity": "high",
          "source": "fastapi_security",
          "owasp_mapping": [
            "A07:2021 - Identification and Authentication Failures"
          ],
          "cwe_id": "CWE-306",
          "remediation": "Implement proper authentication for sensitive endpoints"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 254,
          "column": 0,
          "rule": "missing_auth",
          "message": "Endpoints missing authentication requirements: Endpoint return_robots_txt may lack authentication",
          "severity": "high",
          "source": "fastapi_security",
          "owasp_mapping": [
            "A07:2021 - Identification and Authentication Failures"
          ],
          "cwe_id": "CWE-306",
          "remediation": "Implement proper authentication for sensitive endpoints"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 258,
          "column": 0,
          "rule": "missing_auth",
          "message": "Endpoints missing authentication requirements: Endpoint security_txt may lack authentication",
          "severity": "high",
          "source": "fastapi_security",
          "owasp_mapping": [
            "A07:2021 - Identification and Authentication Failures"
          ],
          "cwe_id": "CWE-306",
          "remediation": "Implement proper authentication for sensitive endpoints"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 262,
          "column": 0,
          "rule": "missing_auth",
          "message": "Endpoints missing authentication requirements: Endpoint return_docs may lack authentication",
          "severity": "high",
          "source": "fastapi_security",
          "owasp_mapping": [
            "A07:2021 - Identification and Authentication Failures"
          ],
          "cwe_id": "CWE-306",
          "remediation": "Implement proper authentication for sensitive endpoints"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 266,
          "column": 0,
          "rule": "missing_auth",
          "message": "Endpoints missing authentication requirements: Endpoint return_redoc may lack authentication",
          "severity": "high",
          "source": "fastapi_security",
          "owasp_mapping": [
            "A07:2021 - Identification and Authentication Failures"
          ],
          "cwe_id": "CWE-306",
          "remediation": "Implement proper authentication for sensitive endpoints"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 182,
          "column": 0,
          "rule": "sql_injection",
          "message": "SQL injection vulnerability in database queries: Pattern detected in line",
          "severity": "critical",
          "source": "fastapi_security",
          "owasp_mapping": [
            "A03:2021 - Injection"
          ],
          "cwe_id": "CWE-89",
          "remediation": "Use parameterized queries or ORM methods",
          "code_snippet": "resp = await run_sql_query(f'SELECT * FROM users WHERE username = \"{username}\";')"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 101,
          "column": 0,
          "rule": "weak_crypto",
          "message": "Weak cryptographic algorithms or practices: Pattern detected in line",
          "severity": "medium",
          "source": "fastapi_security",
          "owasp_mapping": [
            "A02:2021 - Cryptographic Failures"
          ],
          "cwe_id": "CWE-327",
          "remediation": "Use strong cryptographic algorithms and proper key management",
          "code_snippet": "for _ in range(random.randint(7, 84)):"
        }
      ],
      "errors": [],
      "execution_time": 0.010060383006930351,
      "metadata": {
        "files_scanned": 1,
        "fastapi_files": 1,
        "vulnerability_categories": 4
      }
    },
    {
      "tool": "ai_security",
      "success": true,
      "issues": [],
      "errors": [],
      "execution_time": 0.0025887530064210296,
      "metadata": {
        "files_scanned": 1,
        "ai_ml_files": 0,
        "frameworks_detected": [],
        "vulnerability_categories": 0
      }
    },
    {
      "tool": "ruff",
      "success": true,
      "issues": [
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 9,
          "column": 1,
          "rule": "I001",
          "message": "Import block is un-sorted or un-formatted",
          "severity": "info",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 9,
          "column": 30,
          "rule": "F401",
          "message": "`typing.Any` imported but unused",
          "severity": "error",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 12,
          "column": 1,
          "rule": "E401",
          "message": "Multiple imports on one line",
          "severity": "warning",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 21,
          "column": 34,
          "rule": "F401",
          "message": "`fastapi.openapi.docs.get_swagger_ui_oauth2_redirect_html` imported but unused",
          "severity": "error",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 101,
          "column": 20,
          "rule": "S311",
          "message": "Standard pseudo-random generators are not suitable for cryptographic purposes",
          "severity": "critical",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 102,
          "column": 17,
          "rule": "S608",
          "message": "Possible SQL injection vector through string-based query construction",
          "severity": "critical",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 113,
          "column": 19,
          "rule": "S324",
          "message": "Probable use of insecure hash functions in `hashlib`: `md5`",
          "severity": "critical",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 148,
          "column": 18,
          "rule": "E701",
          "message": "Multiple statements on one line (colon)",
          "severity": "warning",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 152,
          "column": 39,
          "rule": "E721",
          "message": "Use `is` and `is not` for type comparisons, or `isinstance()` for isinstance checks",
          "severity": "warning",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 172,
          "column": 26,
          "rule": "E701",
          "message": "Multiple statements on one line (colon)",
          "severity": "warning",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 172,
          "column": 43,
          "rule": "E702",
          "message": "Multiple statements on one line (semicolon)",
          "severity": "warning",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 173,
          "column": 27,
          "rule": "E701",
          "message": "Multiple statements on one line (colon)",
          "severity": "warning",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 182,
          "column": 32,
          "rule": "S608",
          "message": "Possible SQL injection vector through string-based query construction",
          "severity": "critical",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 187,
          "column": 21,
          "rule": "S324",
          "message": "Probable use of insecure hash functions in `hashlib`: `md5`",
          "severity": "critical",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 188,
          "column": 13,
          "rule": "S608",
          "message": "Possible SQL injection vector through string-based query construction",
          "severity": "critical",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 196,
          "column": 27,
          "rule": "W291",
          "message": "Trailing whitespace",
          "severity": "warning",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 228,
          "column": 33,
          "rule": "UP045",
          "message": "Use `X | None` for type annotations",
          "severity": "info",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 228,
          "column": 59,
          "rule": "UP045",
          "message": "Use `X | None` for type annotations",
          "severity": "info",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 231,
          "column": 29,
          "rule": "S608",
          "message": "Possible SQL injection vector through string-based query construction",
          "severity": "critical",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 235,
          "column": 29,
          "rule": "S608",
          "message": "Possible SQL injection vector through string-based query construction",
          "severity": "critical",
          "source": "ruff"
        },
        {
          "file": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py",
          "line": 274,
          "column": 27,
          "rule": "E702",
          "message": "Multiple statements on one line (semicolon)",
          "severity": "warning",
          "source": "ruff"
        }
      ],
      "errors": [],
      "execution_time": 0.017041699029505253,
      "metadata": {
        "returncode": 1
      }
    }
  ],
  "summary": {
    "tools_run": 5,
    "successful_tools": 4,
    "failed_tools": 1,
    "total_issues": 39,
    "issues_by_severity": {
      "low": 1,
      "medium": 6,
      "high": 9,
      "critical": 10,
      "info": 3,
      "error": 2,
      "warning": 8
    },
    "issues_by_tool": {
      "bandit": 8,
      "safety": 0,
      "fastapi_security": 10,
      "ai_security": 0,
      "ruff": 21
    },
    "execution_time": 1.5472651190357283
  },
  "total_issues": 39,
  "critical_issues": 10,
  "fix_suggestions": [
    "Run 'ruff --fix' to automatically fix many style issues"
  ]
}
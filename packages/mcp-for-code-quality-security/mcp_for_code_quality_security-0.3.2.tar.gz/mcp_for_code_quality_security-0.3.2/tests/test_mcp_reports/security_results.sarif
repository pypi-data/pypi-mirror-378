{
  "version": "2.1.0",
  "$schema": "https://json.schemastore.org/sarif-2.1.0.json",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "MCP Security Scanner",
          "organization": "MCP Security",
          "version": "2.0.0",
          "informationUri": "https://github.com/your-org/mcp-security-scanner",
          "shortDescription": {
            "text": "Comprehensive security scanner for Python applications"
          },
          "fullDescription": {
            "text": "MCP Security Scanner provides automated security analysis for Python applications with FastAPI and AI/LLM security focus."
          },
          "rules": [
            {
              "id": "fastapi_security_nosql_injection",
              "name": "nosql_injection",
              "shortDescription": {
                "text": "NoSQL injection vulnerability: User input passed to NoSQL query"
              },
              "fullDescription": {
                "text": "NoSQL injection vulnerability: User input passed to NoSQL query"
              },
              "messageStrings": {
                "default": {
                  "text": "NoSQL injection vulnerability: User input passed to NoSQL query"
                }
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "category": "fastapi_security",
                "severity": "critical",
                "confidence": 0.8,
                "tags": [
                  "security",
                  "fastapi_security",
                  "severity-critical",
                  "injection"
                ],
                "owaspMappings": [
                  "A03: Injection",
                  "API8: Injection"
                ],
                "cwe": "CWE-943"
              }
            },
            {
              "id": "fastapi_security_missing_auth",
              "name": "missing_auth",
              "shortDescription": {
                "text": "Endpoints missing authentication requirements: Endpoint root may lack authentication"
              },
              "fullDescription": {
                "text": "Endpoints missing authentication requirements: Endpoint root may lack authentication"
              },
              "messageStrings": {
                "default": {
                  "text": "Endpoints missing authentication requirements: Endpoint root may lack authentication"
                }
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "category": "fastapi_security",
                "severity": "high",
                "confidence": 0.8,
                "tags": [
                  "security",
                  "fastapi_security",
                  "severity-high",
                  "authentication"
                ],
                "owaspMappings": [
                  "A07: Identification and Authentication Failures",
                  "API2: Broken User Authentication",
                  "A07: Identification and Authentication Failures",
                  "API2: Broken User Authentication",
                  "A07: Identification and Authentication Failures",
                  "API2: Broken User Authentication",
                  "A07: Identification and Authentication Failures",
                  "API2: Broken User Authentication",
                  "A07: Identification and Authentication Failures",
                  "API2: Broken User Authentication",
                  "A07: Identification and Authentication Failures",
                  "API2: Broken User Authentication",
                  "A07: Identification and Authentication Failures",
                  "API2: Broken User Authentication"
                ],
                "cwe": "CWE-306"
              }
            },
            {
              "id": "fastapi_security_sql_injection",
              "name": "sql_injection",
              "shortDescription": {
                "text": "SQL injection vulnerability in database queries: Pattern detected in line"
              },
              "fullDescription": {
                "text": "SQL injection vulnerability in database queries: Pattern detected in line"
              },
              "messageStrings": {
                "default": {
                  "text": "SQL injection vulnerability in database queries: Pattern detected in line"
                }
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "category": "fastapi_security",
                "severity": "critical",
                "confidence": 0.8,
                "tags": [
                  "security",
                  "fastapi_security",
                  "severity-critical",
                  "injection"
                ],
                "owaspMappings": [
                  "A03: Injection",
                  "API8: Injection"
                ],
                "cwe": "CWE-89"
              }
            },
            {
              "id": "fastapi_security_weak_crypto",
              "name": "weak_crypto",
              "shortDescription": {
                "text": "Weak cryptographic algorithms or practices: Pattern detected in line"
              },
              "fullDescription": {
                "text": "Weak cryptographic algorithms or practices: Pattern detected in line"
              },
              "messageStrings": {
                "default": {
                  "text": "Weak cryptographic algorithms or practices: Pattern detected in line"
                }
              },
              "defaultConfiguration": {
                "level": "warning"
              },
              "properties": {
                "category": "fastapi_security",
                "severity": "medium",
                "confidence": 0.8,
                "tags": [
                  "security",
                  "fastapi_security",
                  "severity-medium"
                ],
                "owaspMappings": [
                  "A02: Cryptographic Failures",
                  "A02: Cryptographic Failures",
                  "A02: Cryptographic Failures"
                ],
                "cwe": "CWE-327"
              }
            },
            {
              "id": "ai_security_prompt_injection",
              "name": "prompt_injection",
              "shortDescription": {
                "text": "Prompt injection vulnerability allowing model behavior manipulation: Pattern detected"
              },
              "fullDescription": {
                "text": "Prompt injection vulnerability allowing model behavior manipulation: Pattern detected"
              },
              "messageStrings": {
                "default": {
                  "text": "Prompt injection vulnerability allowing model behavior manipulation: Pattern detected"
                }
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "category": "ai_security",
                "severity": "critical",
                "confidence": 0.8,
                "tags": [
                  "security",
                  "ai_security",
                  "severity-critical",
                  "injection"
                ],
                "owaspMappings": [
                  "LLM01: Prompt Injection",
                  "LLM01: Prompt Injection",
                  "LLM01: Prompt Injection",
                  "LLM01: Prompt Injection"
                ]
              }
            },
            {
              "id": "ai_security_unsafe_plugin_execution",
              "name": "unsafe_plugin_execution",
              "shortDescription": {
                "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
              },
              "fullDescription": {
                "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
              },
              "messageStrings": {
                "default": {
                  "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
                }
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "category": "ai_security",
                "severity": "critical",
                "confidence": 0.8,
                "tags": [
                  "security",
                  "ai_security",
                  "severity-critical"
                ],
                "owaspMappings": [
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design",
                  "LLM07: Insecure Plugin Design"
                ]
              }
            },
            {
              "id": "ai_security_training_data_poisoning",
              "name": "training_data_poisoning",
              "shortDescription": {
                "text": "Training data poisoning through unsanitized input: Pattern detected"
              },
              "fullDescription": {
                "text": "Training data poisoning through unsanitized input: Pattern detected"
              },
              "messageStrings": {
                "default": {
                  "text": "Training data poisoning through unsanitized input: Pattern detected"
                }
              },
              "defaultConfiguration": {
                "level": "error"
              },
              "properties": {
                "category": "ai_security",
                "severity": "high",
                "confidence": 0.8,
                "tags": [
                  "security",
                  "ai_security",
                  "severity-high",
                  "ai-security"
                ],
                "owaspMappings": [
                  "LLM03: Training Data Poisoning",
                  "LLM03: Training Data Poisoning",
                  "LLM03: Training Data Poisoning"
                ]
              }
            },
            {
              "id": "ai_security_insecure_model_storage",
              "name": "insecure_model_storage",
              "shortDescription": {
                "text": "Insecure storage of model files and weights: Model saved without encryption"
              },
              "fullDescription": {
                "text": "Insecure storage of model files and weights: Model saved without encryption"
              },
              "messageStrings": {
                "default": {
                  "text": "Insecure storage of model files and weights: Model saved without encryption"
                }
              },
              "defaultConfiguration": {
                "level": "warning"
              },
              "properties": {
                "category": "ai_security",
                "severity": "medium",
                "confidence": 0.8,
                "tags": [
                  "security",
                  "ai_security",
                  "severity-medium"
                ],
                "owaspMappings": [
                  "LLM06: Sensitive Information Disclosure",
                  "LLM06: Sensitive Information Disclosure",
                  "LLM06: Sensitive Information Disclosure",
                  "LLM06: Sensitive Information Disclosure",
                  "LLM06: Sensitive Information Disclosure",
                  "LLM06: Sensitive Information Disclosure",
                  "LLM06: Sensitive Information Disclosure"
                ]
              }
            }
          ],
          "notifications": [],
          "properties": {
            "scannerTools": [
              {
                "name": "fastapi_security",
                "version": "2.0.0",
                "informationUri": ""
              },
              {
                "name": "ai_security",
                "version": "2.0.0",
                "informationUri": ""
              }
            ],
            "supportedFrameworks": [
              "FastAPI",
              "AI/LLM",
              "General Python"
            ],
            "complianceFrameworks": [
              "OWASP Top 10",
              "OWASP API",
              "OWASP LLM"
            ]
          }
        }
      },
      "results": [
        {
          "ruleId": "fastapi_security_nosql_injection",
          "ruleIndex": 0,
          "message": {
            "text": "NoSQL injection vulnerability: User input passed to NoSQL query"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
                },
                "region": {
                  "startLine": 171,
                  "startColumn": 22
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "nosql_injection",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sanitize and validate user inputs before database queries"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_missing_auth",
          "ruleIndex": 1,
          "message": {
            "text": "Endpoints missing authentication requirements: Endpoint root may lack authentication"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
                },
                "region": {
                  "startLine": 177,
                  "startColumn": 0
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "missing_auth",
            "confidence": 0.8,
            "severity": "high"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement proper authentication for sensitive endpoints"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_missing_auth",
          "ruleIndex": 1,
          "message": {
            "text": "Endpoints missing authentication requirements: Endpoint reset_page may lack authentication"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
                },
                "region": {
                  "startLine": 239,
                  "startColumn": 0
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "missing_auth",
            "confidence": 0.8,
            "severity": "high"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement proper authentication for sensitive endpoints"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_missing_auth",
          "ruleIndex": 1,
          "message": {
            "text": "Endpoints missing authentication requirements: Endpoint return_favicon may lack authentication"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
                },
                "region": {
                  "startLine": 250,
                  "startColumn": 0
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "missing_auth",
            "confidence": 0.8,
            "severity": "high"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement proper authentication for sensitive endpoints"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_missing_auth",
          "ruleIndex": 1,
          "message": {
            "text": "Endpoints missing authentication requirements: Endpoint return_robots_txt may lack authentication"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
                },
                "region": {
                  "startLine": 254,
                  "startColumn": 0
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "missing_auth",
            "confidence": 0.8,
            "severity": "high"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement proper authentication for sensitive endpoints"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_missing_auth",
          "ruleIndex": 1,
          "message": {
            "text": "Endpoints missing authentication requirements: Endpoint security_txt may lack authentication"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
                },
                "region": {
                  "startLine": 258,
                  "startColumn": 0
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "missing_auth",
            "confidence": 0.8,
            "severity": "high"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement proper authentication for sensitive endpoints"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_missing_auth",
          "ruleIndex": 1,
          "message": {
            "text": "Endpoints missing authentication requirements: Endpoint return_docs may lack authentication"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
                },
                "region": {
                  "startLine": 262,
                  "startColumn": 0
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "missing_auth",
            "confidence": 0.8,
            "severity": "high"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement proper authentication for sensitive endpoints"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_missing_auth",
          "ruleIndex": 1,
          "message": {
            "text": "Endpoints missing authentication requirements: Endpoint return_redoc may lack authentication"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
                },
                "region": {
                  "startLine": 266,
                  "startColumn": 0
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "missing_auth",
            "confidence": 0.8,
            "severity": "high"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement proper authentication for sensitive endpoints"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_sql_injection",
          "ruleIndex": 2,
          "message": {
            "text": "SQL injection vulnerability in database queries: Pattern detected in line"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
                },
                "region": {
                  "startLine": 182,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "resp = await run_sql_query(f'SELECT * FROM users WHERE username = \"{username}\";')"
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "sql_injection",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Use parameterized queries or ORM methods"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_weak_crypto",
          "ruleIndex": 3,
          "message": {
            "text": "Weak cryptographic algorithms or practices: Pattern detected in line"
          },
          "level": "warning",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
                },
                "region": {
                  "startLine": 101,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "for _ in range(random.randint(7, 84)):"
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "weak_crypto",
            "confidence": 0.8,
            "severity": "medium"
          },
          "fixes": [
            {
              "description": {
                "text": "Use strong cryptographic algorithms and proper key management"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_weak_crypto",
          "ruleIndex": 3,
          "message": {
            "text": "Weak cryptographic algorithms or practices: Use of weak cryptographic algorithm"
          },
          "level": "warning",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/damn-vulnerable-MCP-server/challenges/medium/challenge7/server_sse.py"
                },
                "region": {
                  "startLine": 40,
                  "startColumn": 24
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "weak_crypto",
            "confidence": 0.8,
            "severity": "medium"
          },
          "fixes": [
            {
              "description": {
                "text": "Use strong cryptographic algorithms and proper key management"
              }
            }
          ]
        },
        {
          "ruleId": "fastapi_security_weak_crypto",
          "ruleIndex": 3,
          "message": {
            "text": "Weak cryptographic algorithms or practices: Pattern detected in line"
          },
          "level": "warning",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/damn-vulnerable-MCP-server/challenges/medium/challenge7/server_sse.py"
                },
                "region": {
                  "startLine": 40,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "token = hashlib.md5(token_data.encode()).hexdigest()"
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "fastapi_security",
            "category": "weak_crypto",
            "confidence": 0.8,
            "severity": "medium"
          },
          "fixes": [
            {
              "description": {
                "text": "Use strong cryptographic algorithms and proper key management"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_prompt_injection",
          "ruleIndex": 4,
          "message": {
            "text": "Prompt injection vulnerability allowing model behavior manipulation: Pattern detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/demo_claude_code_integration.py"
                },
                "region": {
                  "startLine": 35,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "print(f\"\\n\ud83d\udc64 User Request: '{user_request}'\")"
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "prompt_injection",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement input validation, prompt sanitization, and output filtering"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 5,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/damn-vulnerable-MCP-server/challenges/medium/challenge5/server.py"
                },
                "region": {
                  "startLine": 95,
                  "startColumn": 25
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 5,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/damn-vulnerable-MCP-server/challenges/medium/challenge5/server.py"
                },
                "region": {
                  "startLine": 104,
                  "startColumn": 21
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 5,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/damn-vulnerable-MCP-server/challenges/medium/challenge5/server.py"
                },
                "region": {
                  "startLine": 187,
                  "startColumn": 25
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 5,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/damn-vulnerable-MCP-server/challenges/medium/challenge5/server.py"
                },
                "region": {
                  "startLine": 196,
                  "startColumn": 21
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_prompt_injection",
          "ruleIndex": 5,
          "message": {
            "text": "Prompt injection vulnerability allowing model behavior manipulation: Pattern detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/src/mcp_code_scanner/scanners/ai_security_scanner.py"
                },
                "region": {
                  "startLine": 138,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "r'input.*\\+.*prompt',  # Direct input concatenation to prompts"
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "prompt_injection",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement input validation, prompt sanitization, and output filtering"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_prompt_injection",
          "ruleIndex": 5,
          "message": {
            "text": "Prompt injection vulnerability allowing model behavior manipulation: Pattern detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/src/mcp_code_scanner/scanners/ai_security_scanner.py"
                },
                "region": {
                  "startLine": 142,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "r'system.*user_input',  # User input in system prompts"
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "prompt_injection",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement input validation, prompt sanitization, and output filtering"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_training_data_poisoning",
          "ruleIndex": 6,
          "message": {
            "text": "Training data poisoning through unsanitized input: Pattern detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/src/mcp_code_scanner/scanners/ai_security_scanner.py"
                },
                "region": {
                  "startLine": 157,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "r'dataset.*user_data',  # User data in training datasets"
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "training_data_poisoning",
            "confidence": 0.8,
            "severity": "high"
          },
          "fixes": [
            {
              "description": {
                "text": "Validate and sanitize all training data, implement data provenance"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_training_data_poisoning",
          "ruleIndex": 6,
          "message": {
            "text": "Training data poisoning through unsanitized input: Pattern detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/src/mcp_code_scanner/scanners/ai_security_scanner.py"
                },
                "region": {
                  "startLine": 60,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "description=\"Training data poisoning through unsanitized input\","
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "training_data_poisoning",
            "confidence": 0.8,
            "severity": "high"
          },
          "fixes": [
            {
              "description": {
                "text": "Validate and sanitize all training data, implement data provenance"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_training_data_poisoning",
          "ruleIndex": 6,
          "message": {
            "text": "Training data poisoning through unsanitized input: Pattern detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/src/mcp_code_scanner/scanners/ai_security_scanner.py"
                },
                "region": {
                  "startLine": 158,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "r'train.*unsanitized',  # Explicit mention of unsanitized training"
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "training_data_poisoning",
            "confidence": 0.8,
            "severity": "high"
          },
          "fixes": [
            {
              "description": {
                "text": "Validate and sanitize all training data, implement data provenance"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Pattern detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/src/mcp_code_scanner/scanners/ai_security_scanner.py"
                },
                "region": {
                  "startLine": 173,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "r'subprocess.*user',  # Running subprocesses with user input"
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/typing_inspection/typing_objects.py"
                },
                "region": {
                  "startLine": 100,
                  "startColumn": 4
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/typing_inspection/typing_objects.py"
                },
                "region": {
                  "startLine": 132,
                  "startColumn": 4
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_prompt_injection",
          "ruleIndex": 6,
          "message": {
            "text": "Prompt injection vulnerability allowing model behavior manipulation: Pattern detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/httpx/_urlparse.py"
                },
                "region": {
                  "startLine": 248,
                  "startColumn": 0
                },
                "contextRegion": {
                  "snippet": {
                    "text": "kwargs[\"userinfo\"] = f\"{username}:{password}\" if password else username"
                  }
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "prompt_injection",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Implement input validation, prompt sanitization, and output filtering"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/attr/_make.py"
                },
                "region": {
                  "startLine": 222,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/attr/_make.py"
                },
                "region": {
                  "startLine": 223,
                  "startColumn": 4
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/psutil/__init__.py"
                },
                "region": {
                  "startLine": 1387,
                  "startColumn": 25
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/psutil/_psaix.py"
                },
                "region": {
                  "startLine": 149,
                  "startColumn": 8
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/psutil/_psaix.py"
                },
                "region": {
                  "startLine": 257,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/psutil/_psaix.py"
                },
                "region": {
                  "startLine": 530,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/psutil/_pssunos.py"
                },
                "region": {
                  "startLine": 147,
                  "startColumn": 8
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/psutil/_pssunos.py"
                },
                "region": {
                  "startLine": 639,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/cffi/api.py"
                },
                "region": {
                  "startLine": 777,
                  "startColumn": 8
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/cffi/recompiler.py"
                },
                "region": {
                  "startLine": 78,
                  "startColumn": 16
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/dill/_objects.py"
                },
                "region": {
                  "startLine": 238,
                  "startColumn": 16
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/dill/_objects.py"
                },
                "region": {
                  "startLine": 403,
                  "startColumn": 28
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 6,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/dill/_objects.py"
                },
                "region": {
                  "startLine": 408,
                  "startColumn": 33
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_insecure_model_storage",
          "ruleIndex": 7,
          "message": {
            "text": "Insecure storage of model files and weights: Model saved without encryption"
          },
          "level": "warning",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/jinja2/compiler.py"
                },
                "region": {
                  "startLine": 1992,
                  "startColumn": 20
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "insecure_model_storage",
            "confidence": 0.8,
            "severity": "medium"
          },
          "fixes": [
            {
              "description": {
                "text": "Encrypt model files, implement proper access controls"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 7,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/jinja2/environment.py"
                },
                "region": {
                  "startLine": 709,
                  "startColumn": 15
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 7,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/jinja2/environment.py"
                },
                "region": {
                  "startLine": 1228,
                  "startColumn": 8
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 7,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pycparser/ply/yacc.py"
                },
                "region": {
                  "startLine": 1562,
                  "startColumn": 24
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 7,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pycparser/ply/yacc.py"
                },
                "region": {
                  "startLine": 1982,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_insecure_model_storage",
          "ruleIndex": 7,
          "message": {
            "text": "Insecure storage of model files and weights: Model saved without encryption"
          },
          "level": "warning",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pycparser/ply/yacc.py"
                },
                "region": {
                  "startLine": 2854,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "insecure_model_storage",
            "confidence": 0.8,
            "severity": "medium"
          },
          "fixes": [
            {
              "description": {
                "text": "Encrypt model files, implement proper access controls"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_insecure_model_storage",
          "ruleIndex": 7,
          "message": {
            "text": "Insecure storage of model files and weights: Model saved without encryption"
          },
          "level": "warning",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pycparser/ply/yacc.py"
                },
                "region": {
                  "startLine": 2855,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "insecure_model_storage",
            "confidence": 0.8,
            "severity": "medium"
          },
          "fixes": [
            {
              "description": {
                "text": "Encrypt model files, implement proper access controls"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_insecure_model_storage",
          "ruleIndex": 7,
          "message": {
            "text": "Insecure storage of model files and weights: Model saved without encryption"
          },
          "level": "warning",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pycparser/ply/yacc.py"
                },
                "region": {
                  "startLine": 2856,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "insecure_model_storage",
            "confidence": 0.8,
            "severity": "medium"
          },
          "fixes": [
            {
              "description": {
                "text": "Encrypt model files, implement proper access controls"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_insecure_model_storage",
          "ruleIndex": 7,
          "message": {
            "text": "Insecure storage of model files and weights: Model saved without encryption"
          },
          "level": "warning",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pycparser/ply/yacc.py"
                },
                "region": {
                  "startLine": 2857,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "insecure_model_storage",
            "confidence": 0.8,
            "severity": "medium"
          },
          "fixes": [
            {
              "description": {
                "text": "Encrypt model files, implement proper access controls"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_insecure_model_storage",
          "ruleIndex": 7,
          "message": {
            "text": "Insecure storage of model files and weights: Model saved without encryption"
          },
          "level": "warning",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pycparser/ply/yacc.py"
                },
                "region": {
                  "startLine": 2858,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "insecure_model_storage",
            "confidence": 0.8,
            "severity": "medium"
          },
          "fixes": [
            {
              "description": {
                "text": "Encrypt model files, implement proper access controls"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_insecure_model_storage",
          "ruleIndex": 7,
          "message": {
            "text": "Insecure storage of model files and weights: Model saved without encryption"
          },
          "level": "warning",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pycparser/ply/yacc.py"
                },
                "region": {
                  "startLine": 2866,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "insecure_model_storage",
            "confidence": 0.8,
            "severity": "medium"
          },
          "fixes": [
            {
              "description": {
                "text": "Encrypt model files, implement proper access controls"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 7,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pycparser/ply/yacc.py"
                },
                "region": {
                  "startLine": 3254,
                  "startColumn": 16
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 7,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/setuptools/_vendor/typeguard/_decorators.py"
                },
                "region": {
                  "startLine": 79,
                  "startColumn": 18
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 7,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/setuptools/_vendor/typeguard/_union_transformer.py"
                },
                "region": {
                  "startLine": 55,
                  "startColumn": 11
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        },
        {
          "ruleId": "ai_security_unsafe_plugin_execution",
          "ruleIndex": 7,
          "message": {
            "text": "Unsafe execution of LLM plugins or tools: Unsafe code execution detected"
          },
          "level": "error",
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pygments/lexers/_scilab_builtins.py"
                },
                "region": {
                  "startLine": 3061,
                  "startColumn": 12
                }
              }
            }
          ],
          "properties": {
            "tool": "ai_security",
            "category": "unsafe_plugin_execution",
            "confidence": 0.8,
            "severity": "critical"
          },
          "fixes": [
            {
              "description": {
                "text": "Sandbox plugin execution, validate plugin inputs"
              }
            }
          ]
        }
      ],
      "artifacts": [
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/vfapi/main.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/damn-vulnerable-MCP-server/challenges/medium/challenge7/server_sse.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/demo_claude_code_integration.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/tests/vulnerable_apps/damn-vulnerable-MCP-server/challenges/medium/challenge5/server.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/src/mcp_code_scanner/scanners/ai_security_scanner.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/typing_inspection/typing_objects.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/httpx/_urlparse.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/attr/_make.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/psutil/__init__.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/psutil/_psaix.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/psutil/_pssunos.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/cffi/api.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/cffi/recompiler.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/dill/_objects.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/jinja2/compiler.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/jinja2/environment.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pycparser/ply/yacc.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/setuptools/_vendor/typeguard/_decorators.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/setuptools/_vendor/typeguard/_union_transformer.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        },
        {
          "location": {
            "uri": "/home/s/lgtk/R/mcp_agent/.venv/lib/python3.12/site-packages/pygments/lexers/_scilab_builtins.py"
          },
          "properties": {
            "mimeType": "text/x-python"
          }
        }
      ],
      "invocations": [
        {
          "executionSuccessful": true,
          "startTimeUtc": "2025-09-21T02:33:00.760742",
          "endTimeUtc": "2025-09-21T09:33:00.761983+00:00",
          "exitCode": 0,
          "workingDirectory": {
            "uri": "/home/s/lgtk/R/mcp_agent"
          },
          "commandLine": "mcp-scanner scan --config comprehensive",
          "properties": {
            "executionTime": 2.0,
            "totalFileScanned": 15
          }
        }
      ],
      "properties": {
        "projectName": "Security Scan",
        "scanTimestamp": "2025-09-21T02:33:00.760742",
        "totalIssues": 54,
        "toolsExecuted": 2,
        "complianceScore": 0.0,
        "frameworkScores": {
          "owasp_top10_2021": 0.0,
          "owasp_api_top10": 0.0,
          "owasp_llm_top10": 0.0,
          "owasp_mobile_top10": 100.0
        }
      }
    }
  ]
}
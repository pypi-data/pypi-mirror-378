# DataGuild Snowflake Connector Configuration
# This is a sample configuration file demonstrating all available options

# Required connection parameters
account_id: "your-account.snowflakecomputing.com"
username: "your-username"
password: "your-password"
warehouse: "your-warehouse"
database: "your-database"
schema: "your-schema"
role: "your-role"

# Optional connection parameters
host: "your-account.snowflakecomputing.com"  # Alternative to account_id
port: 443
protocol: "https"
region: "us-west-2"  # AWS region
cloud: "aws"  # aws, azure, gcp

# Extraction settings
include_usage_stats: true
include_table_lineage: true
include_column_lineage: true
include_tags: true
include_views: true
include_tables_bool: true
include_streams: true
include_procedures: true
include_functions: true
include_primary_keys: true
include_foreign_keys: true
include_technical_schema: true
include_view_definitions: true
warn_no_datasets: false
skip_empty_tables: true

# Performance settings
max_workers: 4
connection_timeout: 300
query_timeout: 600
lazy_schema_resolver: true
convert_urns_to_lowercase: true

# Database and schema filtering
database_pattern:
  allow: 
    - "PROD_DATABASE"
    - "STAGING_DATABASE"
  deny: 
    - "SNOWFLAKE.*"
    - "TEMP_*"
    - "TEST_*"
  ignoreCase: true

schema_pattern:
  allow: 
    - "PUBLIC"
    - "ANALYTICS"
    - "REPORTING"
  deny: 
    - "INFORMATION_SCHEMA"
    - "TEMP_*"
  ignoreCase: true

# Time window for usage and lineage extraction
start_time: "2020-01-01T00:00:00Z"
end_time: "2025-12-31T23:59:59Z"

# Stateful ingestion settings
stateful_usage:
  enabled: true
  usage_lookback_days: 7
  usage_aggregation_window_hours: 24
  include_query_logs: true
  include_operational_stats: true
  include_user_statistics: true
  top_n_queries: 1000
  user_email_pattern: ".*@.*"
  access_history_query_secs: 3600

stateful_lineage:
  enabled: true
  max_lookback_days: 365
  min_lookback_days: 1
  include_view_lineage: true
  include_column_lineage: true
  include_usage_statistics: true
  query_log_delay_seconds: 3600
  lineage_batch_size: 1000
  skip_redundant_runs: false

stateful_profiling:
  enabled: false
  profile_frequency_days: 7
  profile_on_schema_change: true
  min_quality_threshold: 0.7
  max_profiling_retries: 3
  profiling_timeout_seconds: 3600
  enable_sampling: true
  max_sample_size: 100000
  sample_percentage: 10.0

# Advanced settings
ignore_start_time_lineage: false
include_external_url: true
fetch_views_from_information_schema: true
use_queries_v2: true
include_queries: true
include_query_usage_statistics: true

# Tag extraction settings
extract_tags: "without_lineage"  # without_lineage, with_lineage, skip
extract_tags_as_structured_properties: false
structured_properties_template_cache_invalidation_interval: 60

# Logging settings
log_level: "INFO"  # DEBUG, INFO, WARNING, ERROR
log_file: "snowflake_extraction.log"

# Monitoring settings
enable_monitoring: true
metrics_port: 9090
health_check_interval: 30

# Security settings
insecure_mode: false
ocsp_fail_open: true
client_session_keep_alive: true
client_session_keep_alive_heartbeat_frequency: 3600

# Custom SQL queries (advanced users)
custom_queries:
  - name: "custom_table_query"
    sql: "SELECT * FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_TYPE = 'BASE TABLE'"
  - name: "custom_column_query"
    sql: "SELECT * FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA = 'PUBLIC'"

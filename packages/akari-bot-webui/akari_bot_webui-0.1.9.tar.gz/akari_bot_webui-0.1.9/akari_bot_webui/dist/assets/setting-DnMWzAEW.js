import{S as fe,ai as G,a0 as nt,a$ as Ve,a8 as Ce,m as S,Y as U,i as E,p as re,y as M,b0 as ye,am as R,B as ie,W as q,f as O,c as B,o as P,a as _,a1 as r,G as K,n as y,ad as te,b6 as oe,ah as z,bY as ee,bD as ke,F as rt,x as it,l as Le,bT as ut,j as ct,an as Be,aG as ae,D as Ie,h as F,v as D,e as p,a3 as dt,J as Me,a7 as Ae,ag as he,b7 as ht,bZ as ft,b1 as $e,al as mt,aw as pt,ao as gt,b_ as vt,ax as _t,ap as bt,b$ as wt,c0 as Ct,w as $,aA as Pe,z as se,a2 as Ee,b9 as yt,A as Se,aM as kt,I as $t,E as x,d as V,t as L,bK as Pt,H as Et,ar as Te,c1 as ce,aS as le,_ as Z,aU as X,L as H,u as ue,c2 as St,aV as Tt}from"./index-BKPS2Vtb.js";import{E as Fe}from"./index-BAyJ_jEh.js";import{g as Vt,d as Lt,b as Bt}from"./select-Da1dgR_l.js";import{E as It,a as Mt}from"./form-item-KAdlxA7o.js";import"./validator-B8-2NWUb.js";import"./_initCloneObject-4T97wCKJ.js";const At=fe({color:{type:G(Object),required:!0},vertical:Boolean,disabled:Boolean});let de=!1;function J(e,t){if(!nt)return;const a=function(s){var l;(l=t.drag)==null||l.call(t,s)},o=function(s){var l;document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",o),document.removeEventListener("touchmove",a),document.removeEventListener("touchend",o),document.onselectstart=null,document.ondragstart=null,de=!1,(l=t.end)==null||l.call(t,s)},n=function(s){var l;de||(s.preventDefault(),document.onselectstart=()=>!1,document.ondragstart=()=>!1,document.addEventListener("mousemove",a),document.addEventListener("mouseup",o),document.addEventListener("touchmove",a),document.addEventListener("touchend",o),de=!0,(l=t.start)==null||l.call(t,s))};e.addEventListener("mousedown",n),e.addEventListener("touchstart",n,{passive:!1})}const me=e=>{let t,a;return e.type==="touchend"?(a=e.changedTouches[0].clientY,t=e.changedTouches[0].clientX):e.type.startsWith("touch")?(a=e.touches[0].clientY,t=e.touches[0].clientX):(a=e.clientY,t=e.clientX),{clientX:t,clientY:a}},Ft=e=>{const t=ie(),{t:a}=Ve(),o=Ce(),n=Ce(),s=S(()=>e.color.get("alpha")),l=S(()=>a("el.colorpicker.alphaLabel"));function c(i){var g;if(e.disabled)return;i.target!==o.value&&d(i),(g=o.value)==null||g.focus()}function d(i){if(!n.value||!o.value||e.disabled)return;const u=t.vnode.el.getBoundingClientRect(),{clientX:m,clientY:v}=me(i);if(e.vertical){let k=v-u.top;k=Math.max(o.value.offsetHeight/2,k),k=Math.min(k,u.height-o.value.offsetHeight/2),e.color.set("alpha",Math.round((k-o.value.offsetHeight/2)/(u.height-o.value.offsetHeight)*100))}else{let k=m-u.left;k=Math.max(o.value.offsetWidth/2,k),k=Math.min(k,u.width-o.value.offsetWidth/2),e.color.set("alpha",Math.round((k-o.value.offsetWidth/2)/(u.width-o.value.offsetWidth)*100))}}function f(i){if(e.disabled)return;const{code:g,shiftKey:u}=i,m=u?10:1;switch(g){case R.left:case R.down:i.preventDefault(),i.stopPropagation(),w(-m);break;case R.right:case R.up:i.preventDefault(),i.stopPropagation(),w(m);break}}function w(i){let g=s.value+i;g=g<0?0:g>100?100:g,e.color.set("alpha",g)}return{thumb:o,bar:n,alpha:s,alphaLabel:l,handleDrag:d,handleClick:c,handleKeydown:f}},Ot=(e,{bar:t,thumb:a,handleDrag:o})=>{const n=ie(),s=U("color-alpha-slider"),l=E(0),c=E(0),d=E();function f(){if(!a.value||e.vertical)return 0;const C=n.vnode.el,b=e.color.get("alpha");return C?Math.round(b*(C.offsetWidth-a.value.offsetWidth/2)/100):0}function w(){if(!a.value)return 0;const C=n.vnode.el;if(!e.vertical)return 0;const b=e.color.get("alpha");return C?Math.round(b*(C.offsetHeight-a.value.offsetHeight/2)/100):0}function i(){if(e.color&&e.color.value){const{r:C,g:b,b:j}=e.color.toRgb();return`linear-gradient(to right, rgba(${C}, ${b}, ${j}, 0) 0%, rgba(${C}, ${b}, ${j}, 1) 100%)`}return""}function g(){l.value=f(),c.value=w(),d.value=i()}re(()=>{if(!t.value||!a.value)return;const C={drag:b=>{o(b)},end:b=>{o(b)}};J(t.value,C),J(a.value,C),g()}),M(()=>e.color.get("alpha"),()=>g()),M(()=>e.color.value,()=>g());const u=S(()=>[s.b(),s.is("vertical",e.vertical),s.is("disabled",e.disabled)]),m=S(()=>s.e("bar")),v=S(()=>s.e("thumb")),k=S(()=>({background:d.value})),A=S(()=>({left:ye(l.value),top:ye(c.value)}));return{rootKls:u,barKls:m,barStyle:k,thumbKls:v,thumbStyle:A,update:g}},Dt="ElColorAlphaSlider",Rt=O({name:Dt}),Kt=O({...Rt,props:At,setup(e,{expose:t}){const a=e,{alpha:o,alphaLabel:n,bar:s,thumb:l,handleDrag:c,handleClick:d,handleKeydown:f}=Ft(a),{rootKls:w,barKls:i,barStyle:g,thumbKls:u,thumbStyle:m,update:v}=Ot(a,{bar:s,thumb:l,handleDrag:c});return t({update:v,bar:s,thumb:l}),(k,A)=>(P(),B("div",{class:y(r(w))},[_("div",{ref_key:"bar",ref:s,class:y(r(i)),style:K(r(g)),onClick:r(d)},null,14,["onClick"]),_("div",{ref_key:"thumb",ref:l,class:y(r(u)),style:K(r(m)),"aria-label":r(n),"aria-valuenow":r(o),"aria-orientation":k.vertical?"vertical":"horizontal","aria-valuemin":"0","aria-valuemax":"100",role:"slider",tabindex:"0",onKeydown:r(f)},null,46,["aria-label","aria-valuenow","aria-orientation","onKeydown"])],2))}});var Ht=q(Kt,[["__file","alpha-slider.vue"]]);const Nt=O({name:"ElColorHueSlider",props:{color:{type:Object,required:!0},vertical:Boolean,disabled:Boolean},setup(e){const t=U("color-hue-slider"),a=ie(),o=E(),n=E(),s=E(0),l=E(0),c=S(()=>e.color.get("hue"));M(()=>c.value,()=>{g()});function d(u){if(e.disabled)return;u.target!==o.value&&f(u)}function f(u){if(!n.value||!o.value||e.disabled)return;const v=a.vnode.el.getBoundingClientRect(),{clientX:k,clientY:A}=me(u);let C;if(e.vertical){let b=A-v.top;b=Math.min(b,v.height-o.value.offsetHeight/2),b=Math.max(o.value.offsetHeight/2,b),C=Math.round((b-o.value.offsetHeight/2)/(v.height-o.value.offsetHeight)*360)}else{let b=k-v.left;b=Math.min(b,v.width-o.value.offsetWidth/2),b=Math.max(o.value.offsetWidth/2,b),C=Math.round((b-o.value.offsetWidth/2)/(v.width-o.value.offsetWidth)*360)}e.color.set("hue",C)}function w(){if(!o.value)return 0;const u=a.vnode.el;if(e.vertical)return 0;const m=e.color.get("hue");return u?Math.round(m*(u.offsetWidth-o.value.offsetWidth/2)/360):0}function i(){if(!o.value)return 0;const u=a.vnode.el;if(!e.vertical)return 0;const m=e.color.get("hue");return u?Math.round(m*(u.offsetHeight-o.value.offsetHeight/2)/360):0}function g(){s.value=w(),l.value=i()}return re(()=>{if(!n.value||!o.value||e.disabled)return;const u={drag:m=>{f(m)},end:m=>{f(m)}};J(n.value,u),J(o.value,u),g()}),{bar:n,thumb:o,thumbLeft:s,thumbTop:l,hueValue:c,handleClick:d,update:g,ns:t}}});function Wt(e,t,a,o,n,s){return P(),B("div",{class:y([e.ns.b(),e.ns.is("vertical",e.vertical)])},[_("div",{ref:"bar",class:y(e.ns.e("bar")),onClick:e.handleClick},null,10,["onClick"]),_("div",{ref:"thumb",class:y(e.ns.e("thumb")),style:K({left:e.thumbLeft+"px",top:e.thumbTop+"px"})},null,6)],2)}var zt=q(Nt,[["render",Wt],["__file","hue-slider.vue"]]);const Oe=fe({modelValue:{type:G(String),default:void 0},border:{type:Boolean,default:!0},showAlpha:Boolean,colorFormat:String,disabled:Boolean,predefine:{type:G(Array)}}),Ut={[z]:e=>te(e)||oe(e)},De=Symbol("colorCommonPickerKey"),Re=Symbol("colorPickerPanelContextKey");class ne{constructor(t={}){this._hue=0,this._saturation=100,this._value=100,this._alpha=100,this._tiny=new ee,this._isValid=!1,this.enableAlpha=!1,this.format="",this.value="";for(const a in t)ke(t,a)&&(this[a]=t[a]);t.value?this.fromString(t.value):this.doOnChange()}set(t,a){if(arguments.length===1&&typeof t=="object"){for(const o in t)ke(t,o)&&this.set(o,t[o]);return}this[`_${t}`]=a,this._isValid=!0,this.doOnChange()}get(t){return["hue","saturation","value","alpha"].includes(t)?Math.round(this[`_${t}`]):this[`_${t}`]}toRgb(){return this._isValid?this._tiny.toRgb():{r:255,g:255,b:255,a:0}}fromString(t){const a=new ee(t);if(this._isValid=a.isValid,a.isValid){const{h:o,s:n,v:s,a:l}=a.toHsv();this._hue=o,this._saturation=n*100,this._value=s*100,this._alpha=l*100}else this._hue=0,this._saturation=100,this._value=100,this._alpha=100;this.doOnChange()}compare(t){const a=new ee({h:t._hue,s:t._saturation/100,v:t._value/100,a:t._alpha/100});return this._tiny.equals(a)}doOnChange(){const{_hue:t,_saturation:a,_value:o,_alpha:n,format:s,enableAlpha:l}=this;let c=s||(l?"rgb":"hex");s==="hex"&&l&&(c="hex8"),this._tiny=new ee({h:t,s:a/100,v:o/100,a:n/100}),this.value=this._isValid?this._tiny.toString(c):""}}const qt=O({props:{colors:{type:Array,required:!0},color:{type:Object,required:!0},enableAlpha:{type:Boolean,required:!0},disabled:Boolean},setup(e){const t=U("color-predefine"),{currentColor:a}=Le(Re),o=E(s(e.colors,e.color));M(()=>a.value,l=>{const c=new ne({value:l});o.value.forEach(d=>{d.selected=c.compare(d)})}),ut(()=>{o.value=s(e.colors,e.color)});function n(l){e.disabled||e.color.fromString(e.colors[l])}function s(l,c){return l.map(d=>{const f=new ne({value:d});return f.selected=f.compare(c),f})}return{rgbaColors:o,handleSelect:n,ns:t}}});function jt(e,t,a,o,n,s){return P(),B("div",{class:y(e.ns.b())},[_("div",{class:y(e.ns.e("colors"))},[(P(!0),B(rt,null,it(e.rgbaColors,(l,c)=>(P(),B("div",{key:e.colors[c],class:y([e.ns.e("color-selector"),e.ns.is("alpha",l.get("alpha")<100),{selected:l.selected}]),onClick:d=>e.handleSelect(c)},[_("div",{style:K({backgroundColor:l.value})},null,4)],10,["onClick"]))),128))],2)],2)}var Yt=q(qt,[["render",jt],["__file","predefine.vue"]]);const Xt=O({name:"ElSlPanel",props:{color:{type:Object,required:!0},disabled:Boolean},setup(e){const t=U("color-svpanel"),a=ie(),o=E(0),n=E(0),s=E("hsl(0, 100%, 50%)"),l=S(()=>{const f=e.color.get("hue"),w=e.color.get("value");return{hue:f,value:w}});function c(){const f=e.color.get("saturation"),w=e.color.get("value"),i=a.vnode.el,{clientWidth:g,clientHeight:u}=i;n.value=f*g/100,o.value=(100-w)*u/100,s.value=`hsl(${e.color.get("hue")}, 100%, 50%)`}function d(f){if(e.disabled)return;const i=a.vnode.el.getBoundingClientRect(),{clientX:g,clientY:u}=me(f);let m=g-i.left,v=u-i.top;m=Math.max(0,m),m=Math.min(m,i.width),v=Math.max(0,v),v=Math.min(v,i.height),n.value=m,o.value=v,e.color.set({saturation:m/i.width*100,value:100-v/i.height*100})}return M(()=>l.value,()=>{c()}),re(()=>{J(a.vnode.el,{drag:f=>{d(f)},end:f=>{d(f)}}),c()}),{cursorTop:o,cursorLeft:n,background:s,colorValue:l,handleDrag:d,update:c,ns:t}}});function Gt(e,t,a,o,n,s){return P(),B("div",{class:y(e.ns.b()),style:K({backgroundColor:e.background})},[_("div",{class:y(e.ns.e("white"))},null,2),_("div",{class:y(e.ns.e("black"))},null,2),_("div",{class:y(e.ns.e("cursor")),style:K({top:e.cursorTop+"px",left:e.cursorLeft+"px"})},[_("div")],6)],6)}var xt=q(Xt,[["render",Gt],["__file","sv-panel.vue"]]);const Ke=(e,t)=>{const a=ct(new ne({enableAlpha:e.showAlpha,format:e.colorFormat||"",value:e.modelValue}));return M(()=>[e.colorFormat,e.showAlpha],()=>{a.enableAlpha=e.showAlpha,a.format=e.colorFormat||a.format,a.doOnChange(),t(z,a.value)}),{color:a}},Jt=O({name:"ElColorPickerPanel"}),Zt=O({...Jt,props:Oe,emits:Ut,setup(e,{expose:t,emit:a}){const o=e,n=U("color-picker-panel"),s=Be(),l=E(),c=E(),d=E(),f=E(),w=E(""),{color:i}=Le(De,()=>Ke(o,a),!0);function g(){i.fromString(w.value),i.value!==w.value&&(w.value=i.value)}return re(()=>{o.modelValue&&(w.value=i.value),ae(()=>{var u,m,v;(u=l.value)==null||u.update(),(m=c.value)==null||m.update(),(v=d.value)==null||v.update()})}),M(()=>o.modelValue,u=>{u&&u!==i.value&&i.fromString(u)}),M(()=>i.value,u=>{a(z,u),w.value=u}),Ie(Re,{currentColor:S(()=>i.value)}),t({color:i,inputRef:f}),(u,m)=>(P(),B("div",{class:y([r(n).b(),r(n).is("disabled",r(s)),r(n).is("border",u.border)])},[_("div",{class:y(r(n).e("wrapper"))},[p(zt,{ref_key:"hue",ref:l,class:"hue-slider",color:r(i),vertical:"",disabled:r(s)},null,8,["color","disabled"]),p(xt,{ref_key:"sv",ref:c,color:r(i),disabled:r(s)},null,8,["color","disabled"])],2),u.showAlpha?(P(),F(Ht,{key:0,ref_key:"alpha",ref:d,color:r(i),disabled:r(s)},null,8,["color","disabled"])):D("v-if",!0),u.predefine?(P(),F(Yt,{key:1,ref:"predefine","enable-alpha":u.showAlpha,color:r(i),colors:u.predefine,disabled:r(s)},null,8,["enable-alpha","color","colors","disabled"])):D("v-if",!0),_("div",{class:y(r(n).e("footer"))},[p(r(Me),{ref_key:"inputRef",ref:f,modelValue:w.value,"onUpdate:modelValue":v=>w.value=v,"validate-event":!1,size:"small",disabled:r(s),onChange:g},null,8,["modelValue","onUpdate:modelValue","disabled"]),dt(u.$slots,"footer")],2)],2))}});var Qt=q(Zt,[["__file","color-picker-panel.vue"]]);const eo=Ae(Qt),to=fe({persistent:{type:Boolean,default:!0},modelValue:{type:G(String),default:void 0},id:String,showAlpha:Boolean,colorFormat:String,disabled:Boolean,size:mt,popperClass:{type:String,default:""},tabindex:{type:[String,Number],default:0},teleported:$e.teleported,appendTo:$e.appendTo,predefine:{type:G(Array)},validateEvent:{type:Boolean,default:!0},...ft,...ht(["ariaLabel"])}),oo={[z]:e=>te(e)||oe(e),[he]:e=>te(e)||oe(e),activeChange:e=>te(e)||oe(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent},ao=O({name:"ElColorPicker"}),so=O({...ao,props:to,emits:oo,setup(e,{expose:t,emit:a}){const o=e,{t:n}=Ve(),s=U("color"),{formItem:l}=pt(),c=gt(),d=Be(),{valueOnClear:f,isEmptyValue:w}=vt(o,null),i=Ke(o,a),{inputId:g,isLabeledByFormItem:u}=_t(o,{formItemContext:l}),m=E(),v=E(),k=E(),A=E(!1),C=E(!1);let b=!0;const{isFocused:j,handleFocus:Ue,handleBlur:qe}=bt(v,{disabled:d,beforeBlur(h){var T;return(T=m.value)==null?void 0:T.isFocusInsideContent(h)},afterBlur(){Y(!1),N()}}),I=wt(()=>{var h,T;return(T=(h=k.value)==null?void 0:h.color)!=null?T:i.color}),je=S(()=>Ct(o,Object.keys(Oe))),Ye=S(()=>!o.modelValue&&!C.value?"transparent":Ze(I,o.showAlpha)),Xe=S(()=>!o.modelValue&&!C.value?"":I.value),Ge=S(()=>u.value?void 0:o.ariaLabel||n("el.colorpicker.defaultLabel")),xe=S(()=>u.value?l?.labelId:void 0),Je=S(()=>[s.b("picker"),s.is("disabled",d.value),s.bm("picker",c.value),s.is("focused",j.value)]);function Ze(h,T){const{r:W,g:be,b:we,a:lt}=h.toRgb();return T?`rgba(${W}, ${be}, ${we}, ${lt})`:`rgb(${W}, ${be}, ${we})`}function Y(h){A.value=h}const Q=Vt(Y,100,{leading:!0});function pe(){d.value||Y(!0)}function ge(){Q(!1),N()}function N(){ae(()=>{o.modelValue?I.fromString(o.modelValue):(I.value="",ae(()=>{C.value=!1}))})}function Qe(){d.value||(A.value&&N(),Q(!A.value))}function et(){const h=w(I.value)?f.value:I.value;a(z,h),a(he,h),o.validateEvent&&l?.validate("change").catch(T=>Te()),Q(!1),ae(()=>{const T=new ne({enableAlpha:o.showAlpha,format:o.colorFormat||"",value:o.modelValue});I.compare(T)||N()})}function tt(){Q(!1),a(z,f.value),a(he,f.value),o.modelValue!==f.value&&o.validateEvent&&l?.validate("change").catch(h=>Te()),N()}function ot(){A.value&&(ge(),j.value&&_e())}function ve(h){h.preventDefault(),h.stopPropagation(),Y(!1),N()}function at(h){var T,W;switch(h.code){case R.enter:case R.numpadEnter:case R.space:h.preventDefault(),h.stopPropagation(),pe(),(W=(T=k?.value)==null?void 0:T.inputRef)==null||W.focus();break;case R.esc:ve(h);break}}function _e(){v.value.focus()}function st(){v.value.blur()}return M(()=>Xe.value,h=>{b&&a("activeChange",h),b=!0}),M(()=>I.value,()=>{!o.modelValue&&!C.value&&(C.value=!0)}),M(()=>o.modelValue,h=>{h?h&&h!==I.value&&(b=!1,I.fromString(h)):C.value=!1}),Ie(De,i),t({color:I,show:pe,hide:ge,focus:_e,blur:st}),(h,T)=>(P(),F(r(Et),{ref_key:"popper",ref:m,visible:A.value,"show-arrow":!1,"fallback-placements":["bottom","top","right","left"],offset:0,"gpu-acceleration":!1,"popper-class":[r(s).be("picker","panel"),h.popperClass],"stop-popper-mouse-event":!1,pure:"",effect:"light",trigger:"click",teleported:h.teleported,transition:`${r(s).namespace.value}-zoom-in-top`,persistent:h.persistent,"append-to":h.appendTo,onHide:W=>Y(!1)},{content:$(()=>[se((P(),F(r(eo),Pe({ref_key:"pickerPanelRef",ref:k},r(je),{border:!1,onKeydown:$t(ve,["esc"])}),{footer:$(()=>[_("div",null,[p(r(x),{class:y(r(s).be("footer","link-btn")),text:"",size:"small",onClick:tt},{default:$(()=>[V(L(r(n)("el.colorpicker.clear")),1)]),_:1},8,["class"]),p(r(x),{plain:"",size:"small",class:y(r(s).be("footer","btn")),onClick:et},{default:$(()=>[V(L(r(n)("el.colorpicker.confirm")),1)]),_:1},8,["class"])])]),_:1},16,["onKeydown"])),[[r(Pt),ot,v.value]])]),default:$(()=>[_("div",Pe({id:r(g),ref_key:"triggerRef",ref:v},h.$attrs,{class:r(Je),role:"button","aria-label":r(Ge),"aria-labelledby":r(xe),"aria-description":r(n)("el.colorpicker.description",{color:h.modelValue||""}),"aria-disabled":r(d),tabindex:r(d)?void 0:h.tabindex,onKeydown:at,onFocus:r(Ue),onBlur:r(qe)}),[_("div",{class:y(r(s).be("picker","trigger")),onClick:Qe},[_("span",{class:y([r(s).be("picker","color"),r(s).is("alpha",h.showAlpha)])},[_("span",{class:y(r(s).be("picker","color-inner")),style:K({backgroundColor:r(Ye)})},[se(p(r(Ee),{class:y([r(s).be("picker","icon"),r(s).is("icon-arrow-down")])},{default:$(()=>[p(r(yt))]),_:1},8,["class"]),[[Se,h.modelValue||C.value]]),se(p(r(Ee),{class:y([r(s).be("picker","empty"),r(s).is("icon-close")])},{default:$(()=>[p(r(kt))]),_:1},8,["class"]),[[Se,!h.modelValue&&!C.value]])],6)],2)],2)],16,["id","aria-label","aria-labelledby","aria-description","aria-disabled","tabindex","onFocus","onBlur"])]),_:1},8,["visible","popper-class","teleported","transition","persistent","append-to","onHide"]))}});var lo=q(so,[["__file","color-picker.vue"]]);const no=Ae(lo),ro={install(e){ce._context=e._context,le._context=e._context,e.directive("loading",le),e.config.globalProperties.$loading=ce},directive:le,service:ce},io={name:"restartBotButton",data(){const{t:e}=ue();return{t:e,pollingTimeout:6e4,pollingInterval:2e3,hasShownTimeoutError:!1}},methods:{async handleRestart(){try{await Fe.confirm(this.t("confirm.message"),this.t("confirm.warning"),{confirmButtonText:this.t("button.confirm"),cancelButtonText:this.t("button.cancel"),type:"warning"}),await this.restartBot()}catch{return}},async restartBot(){try{if((await X.post("/api/restart",{})).status===202){ro.service({fullscreen:!0,text:this.t("setting.restart_bot.loading.text")});const t=Date.now(),a=async()=>{try{if((await X.get("/api")).status===200)window.location.href="/";else throw new Error("Not ready")}catch{Date.now()-t>=this.pollingTimeout&&!this.hasShownTimeoutError&&(this.hasShownTimeoutError=!0,H({message:this.t("setting.restart_bot.message.failed"),type:"error",duration:0})),setTimeout(a,this.pollingInterval)}};this.hasShownTimeoutError=!1,setTimeout(a,this.pollingInterval)}}catch(e){H.error(this.t("message.error.fetch")+e.message)}}}};function uo(e,t,a,o,n,s){const l=x;return P(),B("div",null,[_("h3",null,[t[0]||(t[0]=_("i",{class:"mdi mdi-restart"},null,-1)),V(" "+L(e.$t("setting.restart_bot.title")),1)]),p(l,{type:"danger",onClick:s.handleRestart},{default:$(()=>[V(L(e.$t("setting.restart_bot.button.restart")),1)]),_:1},8,["onClick"])])}const He=Z(io,[["render",uo]]),co={name:"ThemeSelector",data(){const{t:e}=ue();return{presets:{akari:"#edaab3",teahouse:"#0091ff"},customColor:"",showColorPicker:localStorage.getItem("isCustomTheme")==="true",t:e}},methods:{applyPreset(e){const t=this.presets[e];localStorage.setItem("isCustomTheme","false"),localStorage.setItem("themeColor",t),this.showColorPicker=!1,window.dispatchEvent(new Event("theme-change"))},applyCustomColor(e){e?(localStorage.setItem("isCustomTheme","true"),localStorage.setItem("themeColor",e)):(localStorage.removeItem("isCustomTheme","false"),localStorage.removeItem("themeColor","#edaab3")),window.dispatchEvent(new Event("theme-change"))},onCustomButtonClick(){this.applyCustomColor(this.customColor),this.showColorPicker=!0},customButtonStyle(){if(localStorage.getItem("isCustomTheme")==="true"){const t=localStorage.getItem("themeColor");this.customColor=t}return this.customColor?{backgroundColor:this.customColor,borderColor:this.customColor,color:"white"}:{}}}},ho={class:"preset-buttons"},fo={class:"custom-theme"};function mo(e,t,a,o,n,s){const l=x,c=no;return P(),B("div",null,[_("h3",null,[t[3]||(t[3]=_("i",{class:"mdi mdi-palette"},null,-1)),V(" "+L(e.$t("setting.theme_setting.title")),1)]),_("div",ho,[p(l,{onClick:t[0]||(t[0]=d=>s.applyPreset("akari")),class:"theme-button akari"},{default:$(()=>[V(L(e.$t("setting.theme_setting.button.pink")),1)]),_:1}),p(l,{onClick:t[1]||(t[1]=d=>s.applyPreset("teahouse")),class:"theme-button teahouse"},{default:$(()=>[V(L(e.$t("setting.theme_setting.button.blue")),1)]),_:1}),_("div",fo,[p(l,{onClick:s.onCustomButtonClick,class:"theme-button custom",style:K(s.customButtonStyle())},{default:$(()=>[V(L(e.$t("setting.theme_setting.button.custom")),1)]),_:1},8,["onClick","style"]),n.showColorPicker?(P(),F(c,{key:0,modelValue:n.customColor,"onUpdate:modelValue":t[2]||(t[2]=d=>n.customColor=d),onChange:s.applyCustomColor,clearable:!0},null,8,["modelValue","onChange"])):D("",!0)])])])}const Ne=Z(co,[["render",mo],["__scopeId","data-v-9d617304"]]),po={name:"LanguageSelector",data(){const{t:e}=ue();return{currentLang:localStorage.getItem("language")||"zh_cn",t:e}},inject:["elementLocale"],methods:{changeLanguage(e){this.currentLang=e,this.$i18n.locale=e,localStorage.setItem("language",e),this.elementLocale.lang=St[e]}}};function go(e,t,a,o,n,s){const l=Lt,c=Bt;return P(),B("div",null,[_("h3",null,[t[1]||(t[1]=_("i",{class:"mdi mdi-translate"},null,-1)),V(" "+L(e.$t("setting.select_language.title")),1)]),p(c,{modelValue:n.currentLang,"onUpdate:modelValue":t[0]||(t[0]=d=>n.currentLang=d),onChange:s.changeLanguage,class:"lang-select",style:{width:"100px","margin-right":"10px"}},{default:$(()=>[p(l,{label:"简体中文",value:"zh_cn"}),p(l,{label:"繁體中文",value:"zh_tw"}),p(l,{label:"English",value:"en_us"}),p(l,{label:"日本語",value:"ja_jp"})]),_:1},8,["modelValue","onChange"])])}const We=Z(po,[["render",go],["__scopeId","data-v-4187ee23"]]),vo={name:"ChangePasswordForm",data(){const{t:e}=ue();return{isLoading:!0,form:{old_password:"",new_password:"",confirm_password:""},noPassword:!1,rules:{old_password:[{required:!0,message:this.$t("setting.change_password.validate.old_password"),trigger:"blur"}],new_password:[{required:!0,message:this.$t("setting.change_password.validate.new_password"),trigger:"blur"}],confirm_password:[{required:!0,message:this.$t("setting.change_password.validate.confirm_password"),trigger:"blur"},{validator:(t,a,o)=>{a!==this.form.new_password?o(new Error(this.$t("setting.change_password.validate.inconsistent"))):o()},trigger:"blur"}]},t:e}},async mounted(){const{data:e}=await X.get("/api/have-password");this.noPassword=!e.data,this.isLoading=!1},methods:{async handleUpdatePassword(){try{try{await this.$refs.formRef.validate()}catch{return}const e={new_password:this.form.new_password};this.noPassword||(e.password=this.form.old_password),(await X.post("/api/change-password",e)).status===205&&location.reload()}catch(e){e.response?.status===401?H.error(this.$t("setting.change_password.message.failed")):e.response?.status===403&&Tt||H.error(this.$t("message.error.fetch")+e.message)}},async handleClearPassword(){try{await this.$refs.formRef.validateField("old_password"),Fe.confirm(this.$t("setting.change_password.confirm.message"),this.$t("confirm.warning"),{confirmButtonText:this.$t("button.confirm"),cancelButtonText:this.$t("button.cancel"),type:"warning"}).then(async()=>{await this.confirmClearPassword()}).catch(()=>{})}catch{return}},async confirmClearPassword(){try{const e={password:this.form.old_password};(await X.post("/api/clear-password",e)).status===205&&(H.success(this.$t("setting.change_password.message.success.clear")),localStorage.removeItem("noPasswordPromptDisabled"),location.reload())}catch(e){e.response?.status===401?H.error(this.$t("setting.change_password.message.failed")):H.error(this.$t("message.error.fetch")+e.message)}}}},_o={class:"password-buttons"};function bo(e,t,a,o,n,s){const l=Me,c=It,d=x,f=Mt,w=le;return se((P(),B("div",null,[_("h3",null,[t[4]||(t[4]=_("i",{class:"mdi mdi-lock"},null,-1)),V(" "+L(e.$t("setting.change_password.title")),1)]),p(f,{model:n.form,rules:n.rules,ref:"formRef","label-width":"auto"},{default:$(()=>[n.noPassword?D("",!0):(P(),F(c,{key:0,label:e.$t("setting.change_password.input.old_password"),prop:"old_password"},{default:$(()=>[p(l,{modelValue:n.form.old_password,"onUpdate:modelValue":t[0]||(t[0]=i=>n.form.old_password=i),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])),n.noPassword?D("",!0):(P(),F(c,{key:1,label:e.$t("setting.change_password.input.new_password"),prop:"new_password"},{default:$(()=>[p(l,{modelValue:n.form.new_password,"onUpdate:modelValue":t[1]||(t[1]=i=>n.form.new_password=i),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])),n.noPassword?(P(),F(c,{key:2,label:e.$t("setting.change_password.input.set_password"),prop:"new_password"},{default:$(()=>[p(l,{modelValue:n.form.new_password,"onUpdate:modelValue":t[2]||(t[2]=i=>n.form.new_password=i),type:"password"},null,8,["modelValue"])]),_:1},8,["label"])):D("",!0),p(c,{label:e.$t("setting.change_password.input.confirm_password"),prop:"confirm_password"},{default:$(()=>[p(l,{modelValue:n.form.confirm_password,"onUpdate:modelValue":t[3]||(t[3]=i=>n.form.confirm_password=i),type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),n.noPassword?(P(),F(c,{key:3},{default:$(()=>[p(d,{type:"primary",onClick:s.handleUpdatePassword},{default:$(()=>[V(L(e.$t("setting.change_password.button.set_password")),1)]),_:1},8,["onClick"])]),_:1})):D("",!0),n.noPassword?D("",!0):(P(),F(c,{key:4},{default:$(()=>[_("div",_o,[p(d,{type:"primary",onClick:s.handleUpdatePassword},{default:$(()=>[V(L(e.$t("setting.change_password.button.update_password")),1)]),_:1},8,["onClick"]),p(d,{type:"danger",onClick:s.handleClearPassword},{default:$(()=>[V(L(e.$t("setting.change_password.button.clear_password")),1)]),_:1},8,["onClick"])])]),_:1}))]),_:1},8,["model","rules"])])),[[w,n.isLoading]])}const ze=Z(vo,[["render",bo],["__scopeId","data-v-1bea7b30"]]),wo={name:"SettingPage",components:{ChangePassword:ze,SelectLanguage:We,RestartBot:He,ThemeSetting:Ne}};function Co(e,t,a,o,n,s){const l=ze,c=We,d=Ne,f=He;return P(),B("div",null,[p(l),p(c),p(d),p(f)])}const To=Z(wo,[["render",Co]]);export{To as default};

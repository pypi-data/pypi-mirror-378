"use strict";(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[5313],{77694:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var n=a(74389),i=a(31529),o=a(93345),r=a(60162),s=a.n(r),d=a(61386),l=a(57486),g=a(67034),u=a(67073),h=a(56574),y=a(59576),c=a(12343),f=a(64794),m=a(17523),w=a(73510),C=a(834),S=a(68391);const p=(0,i.debounce)((({visibleRange:e,chunkSizes:t,data:a,widgetName:n,onQueryRangesChanged:i})=>{if(!t)return;const o={};let r=!1;(0,w.W)(t).forEach((([i,s])=>{if(void 0===s)throw new Error(`Undefined chunkSize for the axis "${i}" in the lazy loading configuration of "${n}". This is not supported.\nEncountered widgetPlugin.lazyLoading.chunkSizes = ${JSON.stringify(t,void 0,2)}`);const d=m.axisIds[i],l=a.axes.find((e=>e.id===d)),g=l?.range,u=e[i].from,h=e[i].to;if(!g||g.entireAxis)o[d]={from:0,to:s-1};else if(u>=g.from&&h<=g.to)o[d]={from:g.from,to:g.to};else{const e=u+Math.floor((h-u)/2),t=Math.max(0,Math.min(g.axisLength-s,e-Math.ceil(s/2))),a=Math.min(t+s,g.axisLength);o[d]={from:t,to:a},r=r||t!==g.from||a!==g.to}})),r&&i(o)}),300),b=e=>{const{data:t,widgetState:a,onQueryRangesChanged:i}=e,r=a.switchedTo??a.widgetKey,s=(0,c.useWidgetPlugin)(r),d=s?.lazyLoading?.chunkSizes,l=(0,C.useWidgetName)(a),g=(0,o.useCallback)((e=>p({visibleRange:e,chunkSizes:d,data:t,widgetName:l,onQueryRangesChanged:i})),[d,t,l,i]);return(0,n.Y)(S.p,{...e,onVisibleRangeChanged:g})};var x=a(99871),R=a(53802);const W=e=>e,z=(0,o.memo)((0,C.withLoadingOverlay)((e=>{(0,x.useCallOnLoadedAfterFirstProperRender)(e);const{queryResult:t,onSelectionChange:a,widgetState:i,onChange:r,onElementsActioned:s}=e,{widgetKey:l}=e.widgetState,m=(0,c.useWidgetPlugin)(l),w=(0,C.useWidgetName)(i);(0,o.useMemo)((()=>{(0,u.K)(w,i.style?.measures)}),[i.style?.measures,w]);const[S]=(0,h.W0)([m?.cell]),[p]=(0,y.n6)([m?.cellStyle]),z=(0,o.useCallback)((p?.withCellStyle??W)(S?.Cell??f.Y),[S,p]);z.displayName="WithCellStyle";const k=(0,C.useFilters)({widgetState:i}),M=(0,o.useMemo)((()=>[...k.user,...k.dashboard,...k.page,...k.widget].some((({filter:e})=>(0,g.t)(e)))),[k]),Q=(0,o.useMemo)((()=>!(0,d.isCellSetEmpty)(t.data)),[t.data]);if((0,C.isMappingEmpty)(i.mapping)&&!M)return(0,n.Y)(R.M,{size:e.widgetState.style?.size,style:e.style,reason:"noQuery"});if(!t.isLoading&&t.error){if((0,d.isErrorInQueryResultOfType)(t.error,"QueryTimeoutException"))throw new d.QueryTimeoutError(t.error);throw new d.QueryError(t.error)}return t.data&&Q?(0,n.Y)(b,{Cell:z,containerStyle:e.style,data:t.data,isRowHeaderTree:e.isRowHeaderTree,onChange:r,onSelectionChange:a,widgetState:e.widgetState,onQueryRangesChanged:e.onQueryRangesChanged,onRowsActioned:s}):(0,n.Y)(R.M,{size:e.widgetState.style?.size,style:e.style,...0===t.data?.cells.length?{reason:"noData",widgetState:i,onStateChange:r}:{reason:"noQuery"}})})),((e,t)=>{if((0,C.isWidgetInDashboard)(t)!==(0,C.isWidgetInDashboard)(e))return!1;if((0,C.isWidgetInDashboard)(t)&&(0,C.isWidgetInDashboard)(e)){const{dashboardState:a,...n}=(0,i.omit)(e,"onDashboardChange"),{dashboardState:o,...r}=(0,i.omit)(t,"onDashboardChange"),d=(0,l.W)(a,e.pageKey),g=(0,l.W)(o,t.pageKey);return s()(n,r)&&a.filters===o.filters&&d?.filters===g?.filters&&a.queryContext===o.queryContext&&d?.queryContext===g?.queryContext}return s()(e,t)}))}}]);
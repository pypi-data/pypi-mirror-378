[project]
name = "spasm-by-sporniket"
version = "1.1.0"
description = "Sporniket's toolbox for assembly language"
authors = [
    { name = "Sporniket", email = "sporniket.studio@gmail.com" },
]
dependencies = []
requires-python = ">= 3.9"
readme = "README.md"
keywords = [
    "assembler",
    "pretty printer",
]

[project.license]
text = "GPL-3.0-or-later"

[project.urls]
homepage = "https://github.com/sporniket/spasm"
repository = "https://github.com/sporniket/spasm"
bug-tracker = "https://github.com/sporniket/spasm/issues"

[project.scripts]
spasm_pp = "spasm.pp.__main__:main"

[build-system]
requires = [
    "pdm-backend",
]
build-backend = "pdm.backend"

[tool.pdm]
distribution = true

[tool.pdm.scripts]
_clean_tons_of_files = "python3 reclean.py"
_organize_imports = "python3 -m removestar -i ."
_reformat = "python3 -m black ."
_lint_errors = "python3 -m flake8 src --count --select=E9,F63,F7,F82 --show-source --statistics"
_lint_warnings = "python3 -m flake8 src --count --ignore=E266 --exit-zero --max-complexity=10 --max-line-length=127 --statistics"
_build_only = "python3 -m pdm build"
_install = "python3 install.py"
_coverage_pytest = "python3 -m coverage run --source=src --branch -m pytest"
_coverage_report = "python3 -m coverage report -m"
_coverage_html = "python3 -m coverage html"
_pytest = "python3 -m pytest -vv"

[tool.pdm.scripts.clean]
composite = [
    "_clean_tons_of_files",
]

[tool.pdm.scripts.reformat]
composite = [
    "_organize_imports",
    "_reformat",
]

[tool.pdm.scripts.lint_report]
composite = [
    "_lint_errors",
    "_lint_warnings",
]

[tool.pdm.scripts.lint_ci]
composite = [
    "reformat",
    "_lint_errors",
]

[tool.pdm.scripts.lint]
composite = [
    "reformat",
    "lint_report",
]

[tool.pdm.scripts.make]
composite = [
    "_build_only",
]

[tool.pdm.scripts.make_install]
composite = [
    "_build_only",
    "_install",
]

[tool.pdm.scripts._ci_only]
composite = [
    "_coverage_pytest",
    "_coverage_report",
    "_coverage_html",
]

[tool.pdm.scripts.ci]
composite = [
    "clean",
    "lint_ci",
    "_ci_only",
]

[tool.pdm.scripts.test]
composite = [
    "clean",
    "reformat",
    "_pytest",
]

[tool.pdm.dev-dependencies]
lint = [
    "black>=24.4.2",
    "flake8>=7.1.0",
    "removestar>=1.5",
]
ci = [
    "pytest>=8.2.2",
    "coverage>=7.6.0",
]
scripting = [
    "rich>=13.7.1",
]
build = [
    "pdm>=2.17.1",
    "pip>=24.1.2",
    "twine>=5.1.1",
]

[tool.pytest.ini_options]
pythonpath = [
    "src",
]

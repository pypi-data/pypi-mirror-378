Metadata-Version: 2.4
Name: oven-mlir
Version: 0.1.1
Summary: Python-to-PTX GPU Kernel Compiler with MLIR optimization
Author-email: Sinjin Jeong <sjjeong94@gmail.com>
Maintainer-email: Oven MLIR Team <oven-mlir@example.com>
License-Expression: MIT
Project-URL: Homepage, https://github.com/sjjeong94/oven
Project-URL: Documentation, https://github.com/sjjeong94/oven#readme
Project-URL: Repository, https://github.com/sjjeong94/oven.git
Project-URL: Bug Tracker, https://github.com/sjjeong94/oven/issues
Project-URL: Source Code, https://github.com/sjjeong94/oven
Project-URL: Download, https://pypi.org/project/oven-mlir/
Keywords: mlir,gpu,cuda,compiler,optimization,kernel,ptx,python,llvm,nvptx
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Science/Research
Classifier: Operating System :: POSIX :: Linux
Classifier: Operating System :: Microsoft :: Windows
Classifier: Operating System :: MacOS
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: C++
Classifier: Topic :: Scientific/Engineering
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Classifier: Topic :: Software Development :: Compilers
Classifier: Topic :: Software Development :: Code Generators
Classifier: Topic :: System :: Hardware
Classifier: Topic :: System :: Hardware :: Symmetric Multi-processing
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy>=1.20.0
Requires-Dist: oven-compiler>=0.1.1
Provides-Extra: python-compilation
Provides-Extra: dev
Requires-Dist: pytest>=6.0; extra == "dev"
Requires-Dist: pytest-cov; extra == "dev"
Requires-Dist: black>=22.0; extra == "dev"
Requires-Dist: isort>=5.10; extra == "dev"
Requires-Dist: flake8>=4.0; extra == "dev"
Requires-Dist: mypy>=0.950; extra == "dev"
Requires-Dist: pre-commit>=2.15; extra == "dev"
Provides-Extra: docs
Requires-Dist: sphinx>=4.0; extra == "docs"
Requires-Dist: sphinx-rtd-theme>=1.0; extra == "docs"
Requires-Dist: myst-parser>=0.17; extra == "docs"
Provides-Extra: test
Requires-Dist: pytest>=6.0; extra == "test"
Requires-Dist: pytest-cov>=3.0; extra == "test"
Requires-Dist: pytest-xdist>=2.0; extra == "test"
Provides-Extra: build
Requires-Dist: build>=0.8; extra == "build"
Requires-Dist: twine>=4.0; extra == "build"
Requires-Dist: wheel>=0.37; extra == "build"
Dynamic: license-file

# oven-mlir

**Python-to-PTX GPU Kernel Compiler**

`oven-mlir` is a comprehensive compilation pipeline that transforms Python source code into optimized PTX assembly for NVIDIA GPUs. It combines the power of MLIR (Multi-Level Intermediate Representation) with an intuitive Python interface.

## Features

- üêç **Python ‚Üí PTX Direct Compilation**: Compile Python functions directly to PTX assembly
- üîß **MLIR Optimization Pipeline**: Advanced optimization passes for GPU kernels  
- üöÄ **Command Line Interface**: Easy-to-use CLI for batch compilation
- üìÅ **Intermediate File Support**: Save MLIR and LLVM IR for debugging
- üéØ **GPU-Optimized Output**: Generate efficient PTX code for CUDA kernels

## Installation

```bash
pip install oven-mlir
```

### Dependencies

For Python-to-PTX compilation, you'll also need:

```bash
pip install oven-compiler
```

## Quick Start

### Python API

```python
import oven_mlir

# Compile Python function to PTX
python_code = """
def add_vectors(a, b):
    return a + b
"""

ptx_code = oven_mlir.compile_python_string_to_ptx(python_code)
print(ptx_code)
```

### Command Line Interface

```bash
# Compile Python file to PTX
oven-mlir --python my_kernel.py -o kernel.ptx

# Compile Python string to PTX
oven-mlir --python-string "def square(x): return x*x" -o square.ptx

# Save intermediate files for debugging
oven-mlir --python kernel.py --intermediate --intermediate-dir ./debug --verbose

# Compile MLIR to PTX (traditional usage)
oven-mlir input.mlir --format ptx -o output.ptx
```

## Compilation Pipeline

```
Python Source ‚Üí MLIR ‚Üí LLVM IR ‚Üí PTX Assembly
```

1. **Python ‚Üí MLIR**: Uses `oven-compiler` to convert Python AST to MLIR
2. **MLIR Optimization**: Applies GPU-specific optimization passes
3. **LLVM Translation**: Converts optimized MLIR to LLVM IR
4. **PTX Generation**: Produces NVIDIA PTX assembly code

## Examples

### Basic Usage

```python
import oven_mlir

# Simple arithmetic function
def multiply(x, y):
    return x * y

# Compile to PTX
compiler = oven_mlir.PythonToPTXCompiler()
ptx = compiler.compile_python_to_ptx("def multiply(x, y): return x * y")

# Generated PTX will contain optimized GPU kernel
```

### Advanced Usage with Intermediate Files

```python
import oven_mlir

python_code = """
def vector_add(a, b, c):
    c = a + b
    return c
"""

compiler = oven_mlir.PythonToPTXCompiler()
result = compiler.compile_with_intermediate_files(
    python_code, 
    output_dir="./debug"
)

print(f"MLIR: {result['mlir_code']}")
print(f"PTX: {result['ptx_code']}")
```

## API Reference

### Core Classes

- `PythonToPTXCompiler`: Main compiler class for Python ‚Üí PTX compilation
- `OvenOptimizer`: MLIR optimization and compilation utilities
- `OvenCompiler`: Low-level MLIR compilation interface

### Functions

- `compile_python_string_to_ptx(code)`: Compile Python string to PTX
- `compile_python_file_to_ptx(file)`: Compile Python file to PTX  
- `optimize_string(mlir)`: Optimize MLIR code
- `to_ptx(mlir)`: Convert MLIR to PTX assembly

## Requirements

- Python 3.8+
- NVIDIA GPU (for PTX execution)
- CUDA Toolkit (recommended)

## Contributing

We welcome contributions! Please see our [GitHub repository](https://github.com/sjjeong94/oven) for more information.

## License

MIT License - see LICENSE file for details.

## Related Projects

- [oven-compiler](https://pypi.org/project/oven-compiler/): Python-to-MLIR frontend compiler
- [MLIR](https://mlir.llvm.org/): Multi-Level Intermediate Representation framework

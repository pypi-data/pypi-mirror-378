"""Configuration file for TAuto Pentest - AI Powered Auto-PenTester
==================================================================

Copyright (c) 2025/1404 D3F417 - Iran
All rights reserved.

This software is proprietary and confidential.
Unauthorized copying, distribution, modification, or use is strictly prohibited.
For licensing inquiries, contact the author.

Contains all settings, templates, and configuration parameters.

Author: D3F417
Version: 2.0
License: Proprietary - All Rights Reserved
"""

APP_NAME = "TAuto Pentest"
APP_VERSION = "2.0"
APP_AUTHOR = "D3F417"
APP_ORGANIZATION = "D3F417"
APP_WEBSITE = "tcommunity.pro"

POLLINATIONS_API_URL = "https://text.pollinations.ai/"
API_TIMEOUT = 30
MAX_RETRIES = 3

NMAP_TIMEOUT = 300
METASPLOIT_TIMEOUT = 120
COMMAND_TIMEOUT = 300

REPORTS_DIR = "reports"
TEMP_DIR = "/tmp"

SCAN_MODES = {
    "quick": {
        "name": "Quick Scan",
        "description": "Fast Nmap-only scanning for quick reconnaissance",
        "timeout": 180,
        "tools": ["nmap"]
    },
    "advanced": {
        "name": "Advanced Scan", 
        "description": "Comprehensive scanning with multiple tools",
        "timeout": 600,
        "tools": ["nmap", "nikto", "whatweb", "gobuster"]
    }
}

NMAP_AGGRESSIVE_FLAGS = "-A -T4"
NMAP_QUICK_FLAGS = "-sS -sV -T4 --top-ports 1000"
NMAP_STEALTH_FLAGS = "-sS -sV -T2 -f"

NIKTO_FLAGS = "-h {target} -Format txt -output {output_file}"
WHATWEB_FLAGS = "-v -a 3 {target}"
GOBUSTER_FLAGS = "dir -u {target} -w /usr/share/wordlists/dirb/common.txt -t 50"

TOOL_CHECK_COMMANDS = {
    "nmap": "nmap --version",
    "nikto": "nikto -Version",
    "whatweb": "whatweb --version", 
    "gobuster": "gobuster version"
}

COLORS = {
    "blue": "BLUE",
    "green": "GREEN", 
    "yellow": "YELLOW",
    "red": "RED",
    "white": "WHITE",
    "cyan": "CYAN",
    "magenta": "MAGENTA",
    "bright_blue": "LIGHTBLUE_EX",
    "bright_green": "LIGHTGREEN_EX",
    "bright_yellow": "LIGHTYELLOW_EX",
    "bright_red": "LIGHTRED_EX",
    "bright_cyan": "LIGHTCYAN_EX",
    "bright_magenta": "LIGHTMAGENTA_EX",
    "orange": "YELLOW",
    "purple": "MAGENTA",
    "gray": "WHITE"
}

SERVICE_EXPLOITS = {
    "vsftpd 2.3.4": "exploit/unix/ftp/vsftpd_234_backdoor",
    "ssh": "auxiliary/scanner/ssh/ssh_login",
    "telnet": "exploit/linux/telnet/telnet_encrypt_keyid",
    "smtp": "auxiliary/scanner/smtp/smtp_enum",
    "http": "auxiliary/scanner/http/dir_scanner",
    "https": "auxiliary/scanner/http/dir_scanner",
    "ftp": "auxiliary/scanner/ftp/anonymous",
    "mysql": "auxiliary/scanner/mysql/mysql_login",
    "postgresql": "auxiliary/scanner/postgres/postgres_login",
    "smb": "auxiliary/scanner/smb/smb_version",
    "netbios": "auxiliary/scanner/netbios/nbname",
    "snmp": "auxiliary/scanner/snmp/snmp_enum",
    "rdp": "auxiliary/scanner/rdp/rdp_scanner",
    "vnc": "auxiliary/scanner/vnc/vnc_none_auth",
    "apache": "auxiliary/scanner/http/apache_userdir_enum",
    "nginx": "auxiliary/scanner/http/nginx_source_disclosure",
    "iis": "auxiliary/scanner/http/ms15_034_http_sys_memory_dump",
    "tomcat": "auxiliary/scanner/http/tomcat_mgr_login",
    "jenkins": "auxiliary/scanner/http/jenkins_enum",
    "wordpress": "auxiliary/scanner/http/wordpress_scanner",
    "drupal": "auxiliary/scanner/http/drupal_views_user_enum",
    "joomla": "auxiliary/scanner/http/joomla_version",
    "phpmyadmin": "auxiliary/scanner/http/phpmyadmin_login",
    "webdav": "auxiliary/scanner/http/webdav_scanner",
    "oracle": "auxiliary/scanner/oracle/oracle_login",
    "mssql": "auxiliary/scanner/mssql/mssql_login",
    "mongodb": "auxiliary/scanner/mongodb/mongodb_login",
    "redis": "auxiliary/scanner/redis/redis_server",
    "elasticsearch": "auxiliary/scanner/elasticsearch/indices_enum",
    "ldap": "auxiliary/scanner/ldap/ldap_login",
    "kerberos": "auxiliary/scanner/kerberos/kerberos_login",
    "nfs": "auxiliary/scanner/nfs/nfsmount",
    "rpcbind": "auxiliary/scanner/portmap/portmap_amp",
    "upnp": "auxiliary/scanner/upnp/upnp_msearch",
    "sip": "auxiliary/scanner/sip/options",
    "rtsp": "auxiliary/scanner/rtsp/rtsp_version",
    "ipp": "auxiliary/scanner/ipp/ipp_printer_list"
}

PORT_SERVICE_MAP = {
    "21": "ftp",
    "22": "ssh", 
    "23": "telnet",
    "25": "smtp",
    "53": "dns",
    "80": "http",
    "110": "pop3",
    "135": "rpc",
    "139": "netbios",
    "143": "imap",
    "443": "https",
    "445": "smb",
    "993": "imaps",
    "995": "pop3s",
    "1433": "mssql",
    "1521": "oracle",
    "3306": "mysql",
    "3389": "rdp",
    "5432": "postgresql",
    "5900": "vnc",
    "6379": "redis",
    "8080": "http-alt",
    "8443": "https-alt",
    "9200": "elasticsearch",
    "27017": "mongodb"
}

AI_PROMPT_TEMPLATE = """You are an expert cybersecurity analyst. Analyze the following penetration testing scan results from multiple tools (Nmap, Nikto, WhatWeb, Gobuster, etc.) and provide a comprehensive security assessment.

Scan Results:
{nmap_output}

Please provide a detailed analysis including:
Рђб **Network Services Analysis**: Open ports, running services, and versions
Рђб **Web Application Security**: Vulnerabilities found by Nikto, technologies detected by WhatWeb, directories/files found by Gobuster
Рђб **Identified Vulnerabilities**: Specific security issues, misconfigurations, and potential attack vectors
Рђб **CVE References**: Relevant CVE numbers for identified vulnerabilities
Рђб **Metasploit Modules**: Exact module paths for exploitation (format: exploit/category/module_name)
Рђб **Risk Assessment**: Critical, High, Medium, Low risk categorization
Рђб **Remediation Recommendations**: Specific steps to fix identified issues

Format your response in clear bullet points and sections for easy reading."""

MSF_RESOURCE_TEMPLATE = """
use {module}
set RHOST {target_ip}
set RHOSTS {target_ip}
check
run
exit
"""

BANNER = r"""
РЋћРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋЌ
РЋЉ                                                                             
РЋЉ  РађРађРађРађРађРађРађРађРађРађРађРађРађРађРбаРаєРађРађРађРађРађРаёРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађ               
РЋЉРађРађРађРађРађРађРађРађРађРађРађРбђРа┤РаІРађРађРађРађРађРађРбаРАЄРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађ                
РЋЉРађРађРађРађРађРађРађРађРбаРаљРаЅРађРађРађРађРађРађРађРађРађРб░РАЄРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађ                
РЋЉРађРађРађРађРађРађРађРб░РаЂРађРађРађРађРађРађРађРађРађРађРађРбИРаЄРађРађРађРађРађРађРађРађРађРАєРађРађРађРађРађРађРађРађРађРађРађ                
РЋЉРађРађРађРађРађРађРБќРАЄРађРађРађРађРађРађРађРађРађРађРађРађРАЈРађРађРађРађРађРађРађРађРађРађРАЄРађРађРађРађРађРађРађРађРађРађРађ                
РЋЉРађРађРађРађРађРађРаўРАЄРађРађРађРађРађРађРађРађРађРађРађРбаРаЄРађРађРађРађРађРА╝РаЄРађРађРађРаўРАєРађРађРаљРађРађРађРбђРађРађРађ                
РЋЉРађРађРађРађРађРађРађРаѕРаЊРабРб╝РађРађРађРађРађРађРађРађРБЙРађРађРађРађРБаРајРађРађРађРађРађРађРаИРАёРађРађРађРађРађРаѕРБЄРађРађ                
РЋЉРађРађРађРађРађРађРађРађРађРађРбИРађРађРађРађРађРађРађРбаРаЄРађРађРађРА░РаЃРађРађРађРађРађРађРбђРА╝РАЄРађРађРађРађРађРађРбИРађРађ                
РЋЉРађРађРађРађРађРађРађРађРађРађРАЄРађРађРађРађРађРађРађРБИРађРађРађРА╝РаЂРађРађРађРађРађРађРбаРаъРађРб╣РАёРађРађРађРађРађРаўРАЄРађ                
РЋЉРађРађРађРађРађРађРађРађРађРБЙРађРађРађРађРађРађРађРбђРАЄРађРађРБ░РаЂРађРађРађРађРађРађРБ░РаІРађРађРаўРБДРађРађРађРађРађРађРб╣Рађ                
РЋЉРађРађРађРађРађРађРађРађРБ╝РаІРађРађРађРађРађРађРађРАЪРађРађРађРБ┐РађРађРађРађРађРађРА┤РаЃРађРађРађРађРБ┐РађРађРађРађРађРађРбИРАЄ                
РЋЉРађРађРађРађРађРађРађРб░РаІРађРађРађРађРађРађРбђРАЙРађРађРађРађРаЏРађРађРађРађРађРбИРАЂРађРађРађРађРађРБ┐РађРађРађРађРађРађРбИРАЄ                
РЋЉРађРађРађРађРађРађРбаРАЈРађРађРађРађРађРађРбђРАъРаЂРађРА┐РБ»РАиРА┤РбдРБцРАаРБХРАХРађРбиРађРађРађРађРб░РАЄРађРађРађРађРађРађРАЙРађ                
РЋЉРађРађРађРађРађРађРАъРађРађРађРађРађРађРађРБ╝РБЦРБцРБцРБцРБцРБцРБцРБцРБђРБђРБђРБђРађРаѕРбДРађРађРађРбИРАЄРађРађРађРађРађРбђРАЄРађ                
РЋЉРађРађРађРађРађРбИРаЂРађРађРађРађРађРађРА╝РаЂРађРађРађРађРаЅРаЎРа╗Рб┐РБ┐РБ┐РБ┐РБ┐РБ┐РБ┐РаЏРбдРАђРађРбИРАЄРађРађРађРађРађРбИРАЄРађ                
РЋЉРађРађРађРађРбаРАЈРађРађРађРађРађРађРА╝РаЂРађРађРађРађРађРађРађРађРађРаЎРб┐РБ┐РА┐РА┐Ра┐РБиРађРаіРб│РАЅРАЄРађРађРађРађРађРАЙРАЄРађ                
РЋЉРађРађРађРађРАъРађРађРађРађРађРађРА╝РаЂРађРађРађРађРађРађРађРађРађРађРађРађРађРб┐РБ┐РБ┐РАЈРАЈРађРаЂРађРа│РАёРађРађРађРађРађРбИРаЂ               
РЋЉРађРађРађРБ░РаЃРађРађРађРађРађРАЙРаЂРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРа╗РБйРБ┐РаЂРађРађРађРаѕРб│РађРађРађРађРађРбИРађ                
РЋЉРађРађРбаРАЈРађРађРађРађРађРА╝РаЂРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРа▒РБ┐РађРађРађРађРађРађРАЄРађРаѕРаЂРађРађРАЄ                
РЋЉРађРађРАЙРађРађРађРађРађРАЙРаЂРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРађРа╗РАёРађРађРађРађРађРбИРађРађРађРађРађРАЄ                
РЋЉ                                                                              
РЋЉ                  ­Ъџђ AI-Powered Automated Penetration Testing ­Ъџђ              
РЋЉ                                Version 2.0                                  
РЋЉ                                                                              
РЋЉ   ­ЪЉЦ Developed by: Tehran Community Team                                     
РЋЉ   ­Ъњ╗ Development Team: Tehran Community                                      
РЋЉ   ­Ъїљ Website: tcommunity.pro                                                 
РЋЉ   Рџа№ИЈ  For Authorized Security Testing Only                                    
РЋџРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋљРЋЮ
"""

REPORT_HEADER = """
{'='*80}
TAuto Pentest - AI POWERED AUTO-PENETRATION TEST REPORT
Developed by Tehran Community Team (tcommunity.pro)
Website: tcommunity.pro
{'='*80}

Target: {target}
Date: {timestamp}
Tool: TAuto Pentest v2.0

{'='*80}
EXECUTIVE SUMMARY
{'='*80}

This report contains the results of an automated penetration test conducted
against {target} using AI-powered vulnerability analysis and automated
exploitation techniques.
"""

class Config:
    """Configuration class that provides access to all settings."""
    
    POLLINATIONS_API_URL = POLLINATIONS_API_URL
    API_TIMEOUT = API_TIMEOUT
    MAX_RETRIES = MAX_RETRIES
    
    NMAP_TIMEOUT = NMAP_TIMEOUT
    METASPLOIT_TIMEOUT = METASPLOIT_TIMEOUT
    COMMAND_TIMEOUT = COMMAND_TIMEOUT
    
    REPORTS_DIR = REPORTS_DIR
    TEMP_DIR = TEMP_DIR
    
    SCAN_MODES = SCAN_MODES
    
    NMAP_AGGRESSIVE_FLAGS = NMAP_AGGRESSIVE_FLAGS
    NMAP_QUICK_FLAGS = NMAP_QUICK_FLAGS
    NMAP_STEALTH_FLAGS = NMAP_STEALTH_FLAGS
    
    NIKTO_FLAGS = NIKTO_FLAGS
    WHATWEB_FLAGS = WHATWEB_FLAGS
    GOBUSTER_FLAGS = GOBUSTER_FLAGS
    TOOL_CHECK_COMMANDS = TOOL_CHECK_COMMANDS
    
    COLORS = COLORS
    
    SERVICE_EXPLOITS = SERVICE_EXPLOITS
    PORT_SERVICE_MAP = PORT_SERVICE_MAP
    
    AI_PROMPT_TEMPLATE = AI_PROMPT_TEMPLATE
    MSF_RESOURCE_TEMPLATE = MSF_RESOURCE_TEMPLATE
    BANNER = BANNER
    REPORT_HEADER = REPORT_HEADER
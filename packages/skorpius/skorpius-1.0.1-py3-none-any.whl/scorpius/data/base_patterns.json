{
  "version": "1.0.0",
  "description": "Base vulnerability patterns for Scorpius Scanner",
  "patterns": [
    {
      "id": "reentrancy_001",
      "name": "reentrancy",
      "severity": "High",
      "description": "Reentrancy vulnerability in external calls",
      "confidence": 0.85,
      "detection_rules": [
        {
          "type": "regex",
          "pattern": "\\.call\\{value:\\s*\\w+\\}",
          "description": "External call with value transfer"
        }
      ]
    },
    {
      "id": "access_control_001", 
      "name": "access_control",
      "severity": "High",
      "description": "Missing access control in privileged functions",
      "confidence": 0.80,
      "detection_rules": [
        {
          "type": "regex",
          "pattern": "function\\s+\\w+.*external.*\\{[^}]*(?!onlyOwner|require\\s*\\(\\s*msg\\.sender)",
          "description": "External function without access control"
        }
      ]
    },
    {
      "id": "oracle_manipulation_001",
      "name": "oracle_manipulation", 
      "severity": "Critical",
      "description": "Oracle price manipulation vulnerability",
      "confidence": 0.90,
      "detection_rules": [
        {
          "type": "regex",
          "pattern": "\\.getPrice\\s*\\(\\)",
          "description": "Price oracle usage without validation"
        }
      ]
    }
  ]
}